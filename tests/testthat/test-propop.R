# Runs tests for projections with 2 nationalities
# Tests with only 1 nationality are part of test-single-nationality

options(cli.default_handler = function(...) { })

# Run simple test on ci
test_that("Simple propop test for ci", {
  expect_snapshot(dput(
    propop(
      parameters = fso_parameters,
      year_first = 2019,
      year_last = 2022,
      population = fso_population,
      subregional = FALSE,
      binational = TRUE
    )
    ))
}
)

# Prepare snapshot 1 region ----

test_that("tests propop: 1 region vs. 5 regions", {

  skip_on_ci()

  ## FSO parameters ----
  # fso_parameters |>
  #   dplyr::filter(year < 2021) |>
  #   constructive::construct()
  parameters_short_1r <- tibble::tibble(
    nat = rep(rep(c("ch", "int"), 2), each = 202L),
    sex = rep(rep(c("m", "f"), 4), each = 101L),
    age = rep(seq(0, 100, by = 1), 8),
    year = rep(c("2019", "2020"), each = 404L),
    scen = rep("reference", 808L),
    spatial_unit = rep("Aargau", 808L),
    birthrate = rep(
      c(
        0, 0.00041, 0.000808, 0.001581, 0.003418, 0.006455, 0.010405, 0.016157,
        0.02364, 0.032479, 0.042954, 0.055049, 0.068632, 0.083007, 0.09798, 0.111332,
        0.121122, 0.125879, 0.122941, 0.112803, 0.097161, 0.078333, 0.05944, 0.042398,
        0.028719, 0.018692, 0.011733, 0.006989, 0.00429, 0.00227, 0.001286, 0.000606,
        0.000277, 0.000262, 0, 0.001381, 0.005993, 0.017009, 0.032641, 0.048974,
        0.065594, 0.081725, 0.094398, 0.106007, 0.114386, 0.122848, 0.130621,
        0.134582, 0.136562, 0.134367, 0.129289, 0.120395, 0.109997, 0.096929,
        0.083624, 0.06944, 0.055859, 0.043528, 0.032069, 0.022818, 0.015167, 0.009358,
        0.005302, 0.002804, 0.001454, 0.000698, 0, 0.000402, 0.001594, 0.003124,
        0.005644, 0.009778, 0.014979, 0.022016, 0.030871, 0.041047, 0.053292,
        0.066976, 0.082033, 0.097347, 0.111297, 0.121859, 0.127219, 0.124628,
        0.114793, 0.099225, 0.080272, 0.060831, 0.04378, 0.029622, 0.019051, 0.011915,
        0.007267, 0.004389, 0.002279, 0.001281, 0.000636, 3e-04, 0.000274, 0,
        0.001327, 0.005602, 0.014993, 0.030641, 0.047519, 0.063492, 0.078652,
        0.093285, 0.104471, 0.114964, 0.123887, 0.130657, 0.136027, 0.137455,
        0.134702, 0.130354, 0.122096, 0.111176, 0.098619, 0.085166, 0.071162,
        0.057419, 0.044622, 0.033077, 0.023306, 0.015352, 0.009823, 0.005317,
        0.002639, 0.001394, 0.000722, 0
      ),
      rep(
        c(118L, 1L, 169L, 1L, 172L, 1L, 169L, 1L, 53L),
        c(1L, 33L, 1L, 31L, 1L, 32L, 1L, 31L, 1L)
      )
    ),
    int_mothers = rep(c(0.23487796250442164, 0.23488290807409998), each = 404L),
    mor = c(
      0.004386, 0.000791, 0.000383, 0.000386, 0, 0, 0, 0, 0, 0, 0, 0.000388,
      0.000412, 0.000395, 0.000392, 0.000388, 0.000386, 0.000391, 0.00079, 0.00071,
      0.000726, 0.000702, 0.000683, 0.000661, 0.000348, 0.000342, 0.000328,
      0.000321, 0.000327, 0.000327, 0.000327, 0.000336, 0.00034, 0.000328, 0.000341,
      0.000641, 0.000661, 0.000653, 0.000655, 0.000655, 0.000675, 0.001045,
      0.001028, 0.001083, 0.001406, 0.001297, 0.001632, 0.001545, 0.001739, 0.00194,
      0.002162, 0.002244, 0.002442, 0.002661, 0.002849, 0.003036, 0.003402,
      0.003659, 0.003999, 0.004515, 0.004835, 0.005534, 0.006061, 0.006621,
      0.007257, 0.00799, 0.008904, 0.009823, 0.010539, 0.011816, 0.012866, 0.014162,
      0.015699, 0.017346, 0.019547, 0.021726, 0.02424, 0.027456, 0.031118, 0.035202,
      0.039863, 0.046055, 0.052408, 0.059247, 0.067295, 0.076852, 0.086808,
      0.096618, 0.107955, 0.119529, 0.129763, 0.139877, 0.150427, 0.166302,
      0.188235, 0.217391, 0.252632, 0.292308, 0.3125, 0.352941, 0.481481, 0.003348,
      0.000417, 0.000401, 0.000393, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.000404, 0.000395, 0.00038, 0.00038, 0.000359, 0.000351, 0.000348, 0.000342,
      0.000349, 0.00032, 0.000333, 0.000327, 0.000337, 0.000331, 0.000332, 0.000669,
      0.000679, 0.000669, 0.000656, 0.000626, 0.000625, 0.000662, 0.000668,
      0.000692, 0.00067, 0.000635, 0.00066, 0.000972, 0.000964, 0.000908, 0.001106,
      0.001311, 0.001291, 0.001455, 0.001689, 0.001871, 0.001863, 0.002055, 0.00232,
      0.002663, 0.002931, 0.003245, 0.003389, 0.003651, 0.004173, 0.004683,
      0.005088, 0.005315, 0.006073, 0.006359, 0.007207, 0.007778, 0.008338,
      0.009125, 0.010379, 0.011395, 0.012876, 0.014275, 0.016217, 0.018063,
      0.020766, 0.023334, 0.027092, 0.030437, 0.035367, 0.04072, 0.046557, 0.054235,
      0.063033, 0.073143, 0.084885, 0.098085, 0.112815, 0.12947, 0.147011, 0.167587,
      0.193103, 0.222571, 0.260504, 0.304094, 0.347826, 0.391892, 0.555556,
      0.003623, 0.000971, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.001172,
      0.001214, 0.001293, 0.001206, 0.001205, 0.001079, 0.001062, 0, 0, 0, 0, 0, 0,
      0.000593, 0.00058, 0.000573, 0.000549, 0.000551, 0.000522, 0.000507, 0.000512,
      0.000484, 0.000488, 0.000503, 0.000536, 0.001063, 0.001079, 0.001105, 0.00116,
      0.001214, 0.001239, 0.001191, 0.001889, 0.001958, 0.001905, 0.001991,
      0.001902, 0.002607, 0.002541, 0.0026, 0.002893, 0.003257, 0.003403, 0.004342,
      0.00409, 0.004372, 0.004935, 0.00651, 0.007123, 0.008217, 0.007851, 0.010173,
      0.010953, 0.012295, 0.01451, 0.01444, 0.018205, 0.018893, 0.020374, 0.024465,
      0.027439, 0.03012, 0.033395, 0.036923, 0.040892, 0.045833, 0.055402, 0.058047,
      0.069686, 0.077922, 0.092715, 0.098361, 0.116279, 0.136364, 0.153846,
      0.173913, 0.173913, 0.2, 0.222222, 0.333333, 0.333333, 0.5, 0, 0, 0.5,
      0.004766, 0.001051, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0.001037, 0, 0, 0.000782, 0.000714, 0.000693, 0.000672, 0.000646,
      0.000613, 0.000599, 0.000573, 0.000563, 0.000581, 0.000574, 0.000576,
      0.000573, 0.000617, 0.000617, 0.000659, 0.000668, 0.000662, 0.000701,
      0.000727, 0.000697, 0.000746, 0.000798, 0.000772, 0.000815, 0.001636,
      0.001684, 0.001789, 0.00178, 0.00194, 0.002177, 0.002322, 0.003354, 0.002606,
      0.002926, 0.003295, 0.003425, 0.005362, 0.005731, 0.00452, 0.007126, 0.007653,
      0.007792, 0.008011, 0.007663, 0.01005, 0.00974, 0.01227, 0.014493, 0.017467,
      0.018868, 0.020492, 0.023762, 0.028398, 0.03423, 0.038043, 0.050725, 0.057762,
      0.068627, 0.082474, 0.089552, 0.107692, 0.12766, 0.142857, 0.133333, 0.150943,
      0.157895, 0.2, 0.181818, 0.25, 0.333333, 0.2, 0.5, 0.5, 0.004356, 0.000789,
      0.000389, 0.000377, 0, 0, 0, 0, 0, 0, 0, 0.000392, 0.000383, 0.000406,
      0.000389, 0.000386, 0.000382, 0.00038, 0.000772, 0.00078, 0.000702, 0.000719,
      0.000696, 0.000679, 0.000659, 0.000348, 0.000343, 0.000329, 0.000322,
      0.000327, 0.000326, 0.000325, 0.000333, 0.000336, 0.000324, 0.000672,
      0.000631, 0.00065, 0.000642, 0.000644, 0.000968, 0.000997, 0.001028, 0.001013,
      0.001422, 0.001388, 0.001604, 0.001616, 0.001839, 0.002015, 0.00193, 0.002153,
      0.002238, 0.002437, 0.002656, 0.003083, 0.00327, 0.003647, 0.00391, 0.004259,
      0.004792, 0.00539, 0.005832, 0.006368, 0.00723, 0.007597, 0.008678, 0.009308,
      0.010573, 0.011348, 0.012647, 0.013746, 0.015078, 0.017053, 0.018769, 0.02112,
      0.023451, 0.026574, 0.030141, 0.034258, 0.039136, 0.044317, 0.050355,
      0.057724, 0.065618, 0.075, 0.084253, 0.095, 0.105615, 0.116242, 0.127985,
      0.136954, 0.148148, 0.165657, 0.184211, 0.210145, 0.244444, 0.28169, 0.326087,
      0.363636, 0.48, 0.003316, 0.000414, 0.00041, 0.000395, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0.000402, 0.000398, 0.00039, 0.000376, 0.000376, 0.000357,
      0.000349, 0.000347, 0.000342, 0.000348, 0.00032, 0.000332, 0.000651, 0.000334,
      0.000657, 0.000657, 0.000661, 0.000669, 0.000659, 0.000647, 0.000617,
      0.000616, 0.000651, 0.000657, 0.000681, 0.00066, 0.00094, 0.000976, 0.00096,
      0.000953, 0.001199, 0.001371, 0.001303, 0.001541, 0.00169, 0.001683, 0.001866,
      0.002093, 0.00228, 0.00255, 0.002904, 0.003176, 0.003497, 0.003655, 0.004181,
      0.004446, 0.004979, 0.005402, 0.005938, 0.006408, 0.006998, 0.007577,
      0.008479, 0.009066, 0.010216, 0.011171, 0.012565, 0.014118, 0.015953,
      0.018001, 0.020508, 0.023064, 0.026497, 0.029981, 0.034748, 0.039658,
      0.046097, 0.053571, 0.062257, 0.071965, 0.082957, 0.096454, 0.110709,
      0.127082, 0.144068, 0.164461, 0.190265, 0.219373, 0.254032, 0.295455,
      0.344538, 0.4, 0.529412, 0.003566, 0.000907, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0.001151, 0.001186, 0.001229, 0.001295, 0.001195, 0.001164, 0.001027,
      0.000987, 0, 0, 0, 0, 0, 0, 0.000561, 0.000551, 0.000546, 0.000528, 0.000531,
      0.000508, 0.000497, 0.000503, 0.00048, 0.000486, 0.001, 0.001066, 0.001061,
      0.001077, 0.001104, 0.001157, 0.001208, 0.001235, 0.001786, 0.001886,
      0.001951, 0.001901, 0.001984, 0.002537, 0.002603, 0.002549, 0.003262,
      0.003639, 0.003289, 0.00432, 0.00444, 0.005214, 0.00559, 0.006329, 0.00672,
      0.007452, 0.008613, 0.01005, 0.010363, 0.011148, 0.012552, 0.014815, 0.017199,
      0.018592, 0.022069, 0.024348, 0.025197, 0.028346, 0.031201, 0.034749,
      0.041801, 0.043137, 0.053333, 0.058997, 0.067606, 0.075472, 0.085308,
      0.103704, 0.109091, 0.131579, 0.131579, 0.151515, 0.157895, 0.157895, 0.25,
      0.285714, 0, 0.5, 0, 0, 0.333333, 0.004714, 0.000961, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000941, 0, 0, 0.00073,
      0.000673, 0.000657, 0.000641, 0.000621, 0.000595, 0.000585, 0.000563,
      0.000556, 0.000574, 0.000568, 0.000572, 0.00057, 0.000613, 0.000614, 0.000655,
      0.000664, 0.00066, 0.000697, 0.000722, 0.000696, 0.000743, 0.000793, 0.00154,
      0.001621, 0.001633, 0.001681, 0.001788, 0.001787, 0.001955, 0.002198,
      0.002347, 0.003405, 0.003955, 0.004441, 0.004996, 0.005236, 0.00551, 0.005837,
      0.006849, 0.007212, 0.007712, 0.007864, 0.008097, 0.010336, 0.010169,
      0.013115, 0.012448, 0.014733, 0.017778, 0.023077, 0.025157, 0.028513,
      0.033543, 0.040609, 0.045198, 0.053435, 0.061538, 0.073684, 0.089888,
      0.098361, 0.12069, 0.121951, 0.133333, 0.153846, 0.130435, 0.1875, 0.25,
      0.222222, 0.222222, 0, 0.25, 0.5
    ),
    emi_int = c(
      0.002417, 0.005986, 0.005407, 0.005062, 0.004175, 0.004059, 0.003834,
      0.003114, 0.002681, 0.002278, 0.00199, 0.00156, 0.001244, 0.001193, 0.00079,
      0.000782, 0.000778, 0.000789, 0.001193, 0.001786, 0.002556, 0.003172,
      0.003429, 0.003974, 0.004538, 0.005137, 0.005242, 0.00544, 0.005559, 0.005556,
      0.005561, 0.0054, 0.005132, 0.005279, 0.004818, 0.00484, 0.004332, 0.004281,
      0.004292, 0.003966, 0.003747, 0.003512, 0.003452, 0.00364, 0.003541, 0.003262,
      0.003283, 0.003107, 0.002911, 0.002782, 0.002711, 0.002749, 0.002449,
      0.002425, 0.002617, 0.002807, 0.00292, 0.003174, 0.003252, 0.003457, 0.003494,
      0.0036, 0.003584, 0.003744, 0.003778, 0.004914, 0.003814, 0.002948, 0.002812,
      0.002434, 0.002145, 0.002125, 0.001826, 0.001846, 0.001564, 0.00164, 0.001276,
      0.000947, 0.001055, 0.000652, 0.000688, 0.000678, 0.000771, 0.000847, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.003384, 0.003786, 0.003641,
      0.003566, 0.003604, 0.003329, 0.00334, 0.003236, 0.003353, 0.002756, 0.002926,
      0.002432, 0.002162, 0.002121, 0.002179, 0.001678, 0.001678, 0.001656,
      0.002037, 0.003183, 0.003053, 0.003053, 0.003241, 0.004228, 0.004875,
      0.005812, 0.006296, 0.006716, 0.007005, 0.006872, 0.006417, 0.005988,
      0.005667, 0.004715, 0.004447, 0.00371, 0.003305, 0.00284, 0.002521, 0.002674,
      0.002358, 0.002444, 0.002365, 0.002239, 0.002327, 0.002285, 0.002265,
      0.002435, 0.002222, 0.002368, 0.002332, 0.002188, 0.002178, 0.00211, 0.0021,
      0.002059, 0.002092, 0.00194, 0.001957, 0.00175, 0.001827, 0.001827, 0.001827,
      0.001929, 0.002544, 0.002066, 0.002126, 0.001515, 0.001311, 0.001297,
      0.001335, 0.001015, 0.001039, 0.001036, 0.001073, 0.001098, 0.001132,
      0.001261, 0.000923, 0.001038, 0.000532, 0.000554, 0.00059, 0.00059, 0.000656,
      0.00067, 0.000742, 0.000762, 0.000867, 0.000935, 0.001095, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0.004513, 0.037073, 0.032101, 0.02812, 0.025169, 0.022052,
      0.018217, 0.016304, 0.014395, 0.01232, 0.009395, 0.008841, 0.007495, 0.006593,
      0.005214, 0.00454, 0.006993, 0.013269, 0.020592, 0.026506, 0.030414, 0.034103,
      0.039474, 0.040775, 0.041331, 0.041978, 0.041897, 0.041014, 0.040028,
      0.038532, 0.036949, 0.035882, 0.03427, 0.033746, 0.032378, 0.031795, 0.031508,
      0.030642, 0.029887, 0.029783, 0.029602, 0.028769, 0.028108, 0.028208,
      0.027891, 0.026204, 0.025466, 0.02503, 0.024606, 0.023545, 0.022265, 0.021956,
      0.020939, 0.019595, 0.01906, 0.018205, 0.0188, 0.020325, 0.024535, 0.027562,
      0.029412, 0.028169, 0.031746, 0.032175, 0.036517, 0.05939, 0.034951, 0.020243,
      0.015284, 0.012245, 0.012048, 0.009592, 0.007792, 0.008086, 0.010169,
      0.009146, 0.009119, 0.009009, 0.007407, 0.006135, 0.007407, 0.008264,
      0.005525, 0.005263, 0.006944, 0.008621, 0.013158, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0.012322, 0.043113, 0.034304, 0.02729, 0.02229, 0.019211,
      0.016649, 0.015091, 0.01427, 0.012948, 0.012821, 0.012155, 0.011312, 0.010297,
      0.01105, 0.010381, 0.010296, 0.010959, 0.01194, 0.014184, 0.016641, 0.017808,
      0.020752, 0.022754, 0.02623, 0.029851, 0.030387, 0.030057, 0.029477, 0.029286,
      0.029696, 0.028402, 0.028002, 0.026699, 0.025434, 0.023823, 0.022209,
      0.020196, 0.019075, 0.017222, 0.016079, 0.014833, 0.013898, 0.012735,
      0.011952, 0.011955, 0.010949, 0.011173, 0.010463, 0.010408, 0.010062,
      0.010621, 0.010656, 0.01097, 0.012545, 0.015125, 0.017425, 0.019544, 0.020809,
      0.021111, 0.020752, 0.018923, 0.018062, 0.015385, 0.038801, 0.024621,
      0.018018, 0.011848, 0.010204, 0.01039, 0.010667, 0.010204, 0.010033, 0.00974,
      0.012245, 0.007246, 0.008734, 0.007547, 0.008197, 0.007905, 0.008097,
      0.009756, 0.01087, 0.014493, 0.014388, 0.009804, 0.010309, 0.014925, 0.015385,
      0.021277, 0.028571, 0.033333, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.001999, 0.005976,
      0.005488, 0.004941, 0.004599, 0.00412, 0.003652, 0.003038, 0.002699, 0.00228,
      0.001884, 0.001577, 0.001157, 0.000819, 0.000785, 0.000778, 0.000769,
      0.000766, 0.001166, 0.001962, 0.002472, 0.003251, 0.003842, 0.004084,
      0.004616, 0.005216, 0.005479, 0.005588, 0.005782, 0.005566, 0.005554,
      0.005543, 0.005353, 0.005076, 0.004892, 0.004744, 0.004453, 0.004261,
      0.004207, 0.003896, 0.003901, 0.003686, 0.003801, 0.003403, 0.003584,
      0.003145, 0.003227, 0.002924, 0.003079, 0.00289, 0.003042, 0.002969, 0.002493,
      0.002442, 0.00242, 0.002614, 0.002806, 0.002922, 0.003179, 0.003259, 0.003465,
      0.003507, 0.003336, 0.003601, 0.003475, 0.004673, 0.00341, 0.00321, 0.002645,
      0.002129, 0.002109, 0.00181, 0.001795, 0.001854, 0.001502, 0.001594, 0.001257,
      0.001307, 0.000973, 0.000544, 0.000675, 0.000715, 0.00071, 0.000813, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00252, 0.003759, 0.003724,
      0.00358, 0.003512, 0.003553, 0.003287, 0.003302, 0.003203, 0.002905, 0.002729,
      0.002482, 0.002407, 0.002133, 0.002089, 0.001709, 0.001639, 0.001639,
      0.002431, 0.002807, 0.002749, 0.003023, 0.0034, 0.00429, 0.005252, 0.005901,
      0.006496, 0.006974, 0.007047, 0.006656, 0.006527, 0.006042, 0.005611,
      0.005286, 0.004659, 0.003709, 0.003322, 0.002934, 0.002489, 0.002484,
      0.002298, 0.002318, 0.002402, 0.002329, 0.002208, 0.002294, 0.002255,
      0.002237, 0.002109, 0.002203, 0.002093, 0.002061, 0.002179, 0.002169,
      0.002104, 0.002096, 0.002055, 0.001857, 0.001939, 0.001957, 0.00175, 0.001829,
      0.001831, 0.001832, 0.002489, 0.001989, 0.002079, 0.001527, 0.001218,
      0.001319, 0.000979, 0.001008, 0.001022, 0.001048, 0.001047, 0.001087,
      0.001114, 0.001149, 0.000855, 0.000942, 0.000531, 0.000546, 0.00057, 0.000611,
      0.000615, 0.000687, 0.000708, 0.000791, 0.000822, 0.000946, 0.001035,
      0.001235, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.001784, 0.035519, 0.032882, 0.027885,
      0.024497, 0.02201, 0.018027, 0.015166, 0.01435, 0.012322, 0.010091, 0.008222,
      0.007805, 0.006383, 0.005495, 0.005247, 0.008018, 0.012972, 0.019584,
      0.024707, 0.028986, 0.033453, 0.038136, 0.040206, 0.04147, 0.041096, 0.041246,
      0.039942, 0.039095, 0.037687, 0.036311, 0.034989, 0.034059, 0.032813,
      0.032415, 0.031379, 0.031109, 0.030426, 0.029865, 0.029684, 0.028571,
      0.028862, 0.028147, 0.027493, 0.026519, 0.026667, 0.025439, 0.025371,
      0.024434, 0.023929, 0.022179, 0.021587, 0.020557, 0.019683, 0.018905,
      0.018471, 0.018893, 0.020319, 0.023732, 0.025751, 0.029024, 0.02588, 0.027685,
      0.028822, 0.034483, 0.056769, 0.035654, 0.02, 0.014463, 0.011111, 0.0125,
      0.009852, 0.009804, 0.007958, 0.008264, 0.006944, 0.006289, 0.006289,
      0.006231, 0.007692, 0.00641, 0.007782, 0.008811, 0.005882, 0.005618, 0.007519,
      0.009434, 0.014706, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.011236, 0.040346,
      0.032597, 0.026915, 0.021401, 0.019153, 0.016032, 0.014418, 0.012974,
      0.013001, 0.011858, 0.011616, 0.010917, 0.010056, 0.010262, 0.010022,
      0.010576, 0.011827, 0.012535, 0.015038, 0.016997, 0.017467, 0.019206,
      0.023669, 0.02589, 0.028628, 0.028763, 0.029486, 0.029434, 0.028374, 0.028995,
      0.028197, 0.027813, 0.026554, 0.024837, 0.023282, 0.021277, 0.020196,
      0.018265, 0.017212, 0.015429, 0.01476, 0.013538, 0.013141, 0.012, 0.011243,
      0.011181, 0.010862, 0.010453, 0.010424, 0.009547, 0.010031, 0.009756,
      0.011447, 0.012626, 0.014311, 0.016949, 0.019474, 0.021882, 0.021028,
      0.020316, 0.018373, 0.017699, 0.016584, 0.037866, 0.023679, 0.015504,
      0.013667, 0.01199, 0.010283, 0.010471, 0.010782, 0.010309, 0.010169, 0.009836,
      0.008299, 0.011029, 0.008889, 0.007692, 0.008368, 0.00813, 0.008368, 0.010152,
      0.011299, 0.007634, 0.007692, 0.010526, 0.011236, 0.016393, 0.017241, 0.02439,
      0.033333, 0.038462, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    emi_nat = c(
      0.008461, 0.02913, 0.023561, 0.019081, 0.015939, 0.013284, 0.011503, 0.010121,
      0.008809, 0.007973, 0.007166, 0.00702, 0.006636, 0.006364, 0.006322, 0.006252,
      0.006223, 0.006706, 0.007555, 0.009646, 0.013509, 0.018682, 0.026063,
      0.034106, 0.041885, 0.048973, 0.054063, 0.05696, 0.057554, 0.056536, 0.053647,
      0.050287, 0.045843, 0.04157, 0.037509, 0.033559, 0.02999, 0.027, 0.024431,
      0.022141, 0.020095, 0.018616, 0.017259, 0.016017, 0.015227, 0.014677,
      0.013789, 0.013358, 0.012809, 0.012517, 0.012198, 0.011747, 0.011263,
      0.011154, 0.010707, 0.010292, 0.009978, 0.009521, 0.009255, 0.008774, 0.0086,
      0.008031, 0.00772, 0.007488, 0.006975, 0.010442, 0.007947, 0.006223, 0.005624,
      0.005216, 0.005005, 0.004958, 0.004383, 0.00443, 0.003911, 0.00369, 0.003828,
      0.003316, 0.003166, 0.003262, 0.003439, 0.003388, 0.003084, 0.00254, 0.002693,
      0.002778, 0.002286, 0.002415, 0.002841, 0.003367, 0.002062, 0.002457,
      0.003413, 0.004367, 0, 0, 0, 0, 0, 0, 0, 0.010575, 0.027766, 0.023867,
      0.020998, 0.018022, 0.015814, 0.013361, 0.011731, 0.010059, 0.008661,
      0.007107, 0.00608, 0.005188, 0.004667, 0.003922, 0.004195, 0.004614, 0.007039,
      0.011002, 0.017907, 0.026718, 0.037405, 0.048614, 0.059197, 0.067549,
      0.073162, 0.075551, 0.074832, 0.071714, 0.066427, 0.060115, 0.05356, 0.047,
      0.040754, 0.035238, 0.030354, 0.026438, 0.023036, 0.02017, 0.018048, 0.016504,
      0.015014, 0.013851, 0.013116, 0.012301, 0.011749, 0.011323, 0.010959,
      0.010553, 0.01026, 0.010106, 0.009725, 0.009436, 0.009142, 0.008868, 0.008694,
      0.008368, 0.008244, 0.007828, 0.007748, 0.007568, 0.007309, 0.007046,
      0.006891, 0.009893, 0.010626, 0.008202, 0.006667, 0.005902, 0.005514,
      0.005007, 0.004736, 0.004501, 0.004491, 0.004293, 0.004028, 0.003774,
      0.003783, 0.003693, 0.003114, 0.00319, 0.00277, 0.00295, 0.002952, 0.002625,
      0.002679, 0.002226, 0.002287, 0.001733, 0.001869, 0.002191, 0.001235,
      0.001618, 0.001842, 0.002299, 0, 0, 0, 0, 0, 0, 0.009025, 0.027317, 0.025292,
      0.021968, 0.019361, 0.016299, 0.014382, 0.012681, 0.010557, 0.00924, 0.008351,
      0.006876, 0.006424, 0.005495, 0.005214, 0.005675, 0.005828, 0.007238,
      0.010296, 0.015663, 0.024331, 0.033003, 0.041667, 0.04893, 0.054435, 0.058769,
      0.06087, 0.061894, 0.061798, 0.06055, 0.058999, 0.057647, 0.055618, 0.053431,
      0.050955, 0.049231, 0.047004, 0.044747, 0.042626, 0.040888, 0.038751,
      0.037294, 0.035676, 0.033739, 0.031958, 0.030469, 0.029193, 0.02801, 0.026498,
      0.025507, 0.024173, 0.022621, 0.021574, 0.018289, 0.017154, 0.016255,
      0.015184, 0.013821, 0.013536, 0.012059, 0.011156, 0.010834, 0.009768,
      0.009009, 0.008427, 0.006421, 0.005825, 0.006073, 0.004367, 0.004082,
      0.004819, 0.002398, 0.002597, 0.002695, 0.00339, 0.003049, 0.00304, 0.003003,
      0.003704, 0.003067, 0.003704, 0.004132, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0.009479, 0.02103, 0.019751, 0.018519, 0.017224, 0.016178,
      0.015609, 0.014085, 0.013172, 0.012948, 0.011752, 0.01105, 0.010181, 0.010297,
      0.00884, 0.009227, 0.009009, 0.010959, 0.016418, 0.025532, 0.037821, 0.047945,
      0.054475, 0.058683, 0.060109, 0.059701, 0.058011, 0.05524, 0.052321, 0.05,
      0.046961, 0.043593, 0.04107, 0.038228, 0.035838, 0.033466, 0.030976, 0.028852,
      0.027168, 0.025258, 0.0235, 0.021632, 0.019854, 0.018767, 0.017264, 0.016174,
      0.015328, 0.01676, 0.017937, 0.018415, 0.017802, 0.017157, 0.016393, 0.01519,
      0.014337, 0.013345, 0.012585, 0.011944, 0.011561, 0.011111, 0.010376,
      0.010189, 0.00821, 0.008547, 0.007055, 0.00947, 0.006757, 0.007109, 0.005102,
      0.005195, 0.005333, 0.005102, 0.003344, 0.003247, 0.004082, 0.003623,
      0.004367, 0.003774, 0.004098, 0.003953, 0.004049, 0.004878, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.008397, 0.029084, 0.02352, 0.019384,
      0.016098, 0.013483, 0.011322, 0.009875, 0.008867, 0.007979, 0.007159,
      0.006703, 0.006559, 0.006552, 0.006279, 0.006223, 0.006538, 0.006897, 0.00777,
      0.009808, 0.013418, 0.018786, 0.025847, 0.034037, 0.041873, 0.049026, 0.05411,
      0.05687, 0.057501, 0.05632, 0.053904, 0.050212, 0.045835, 0.041624, 0.037508,
      0.033548, 0.029898, 0.026876, 0.024272, 0.022078, 0.020156, 0.018432,
      0.017277, 0.016332, 0.015412, 0.014675, 0.013875, 0.01332, 0.012931, 0.012428,
      0.012168, 0.011606, 0.011466, 0.010989, 0.010649, 0.010456, 0.010056,
      0.009739, 0.009293, 0.008774, 0.008529, 0.008093, 0.007784, 0.007479, 0.00695,
      0.010222, 0.00775, 0.0061, 0.00562, 0.005323, 0.004921, 0.004705, 0.004668,
      0.004449, 0.004131, 0.003986, 0.00377, 0.003486, 0.003405, 0.003264, 0.003376,
      0.002861, 0.002839, 0.003252, 0.002698, 0.002885, 0.003009, 0.0025, 0.002674,
      0.003185, 0.001912, 0.002364, 0.002849, 0.004032, 0, 0, 0, 0, 0, 0, 0, 0.0105,
      0.027569, 0.023997, 0.020684, 0.017948, 0.015792, 0.013558, 0.011556,
      0.010008, 0.008714, 0.007407, 0.006206, 0.005215, 0.004693, 0.004177,
      0.003845, 0.004918, 0.006964, 0.01094, 0.017642, 0.026709, 0.037415, 0.048734,
      0.059349, 0.067577, 0.073238, 0.075556, 0.074965, 0.071749, 0.066556,
      0.060379, 0.053374, 0.046865, 0.040634, 0.035275, 0.030344, 0.026246,
      0.022824, 0.020224, 0.018012, 0.016415, 0.014901, 0.01407, 0.012974, 0.012303,
      0.011796, 0.011276, 0.010866, 0.010545, 0.010465, 0.00994, 0.009791, 0.009441,
      0.009159, 0.008883, 0.008619, 0.008449, 0.008126, 0.007998, 0.007583,
      0.007502, 0.007316, 0.007061, 0.007066, 0.009956, 0.010799, 0.008316,
      0.006414, 0.005786, 0.005275, 0.005222, 0.00504, 0.00477, 0.004541, 0.00419,
      0.003984, 0.003712, 0.003831, 0.00342, 0.003297, 0.003183, 0.003273, 0.002851,
      0.002442, 0.00246, 0.002062, 0.002123, 0.002373, 0.001643, 0.001892, 0.00207,
      0.001235, 0.001414, 0.00189, 0.002212, 0, 0, 0, 0, 0, 0, 0.008921, 0.027322,
      0.025145, 0.022115, 0.019248, 0.017225, 0.014231, 0.012322, 0.010762,
      0.009479, 0.008073, 0.007194, 0.006829, 0.006383, 0.005495, 0.005247,
      0.005727, 0.007075, 0.009792, 0.015605, 0.024155, 0.032258, 0.041314,
      0.048454, 0.054665, 0.058447, 0.060606, 0.061728, 0.061728, 0.060429,
      0.059366, 0.057562, 0.055276, 0.053254, 0.051324, 0.048868, 0.046663,
      0.044625, 0.042871, 0.040876, 0.039098, 0.036879, 0.035582, 0.033962,
      0.032044, 0.030725, 0.029073, 0.027847, 0.026818, 0.025189, 0.024136,
      0.022857, 0.021883, 0.018413, 0.016949, 0.015924, 0.014984, 0.013788,
      0.013093, 0.012017, 0.011434, 0.010352, 0.009967, 0.008772, 0.007958,
      0.007278, 0.006791, 0.006, 0.004132, 0.004444, 0.004167, 0.002463, 0.002451,
      0.002653, 0.002755, 0.003472, 0.003145, 0.003145, 0.003115, 0.003846,
      0.003205, 0.003891, 0.004405, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0.009363, 0.020173, 0.018927, 0.018634, 0.01751, 0.016129, 0.01503,
      0.014418, 0.013972, 0.013001, 0.011858, 0.011616, 0.010917, 0.010056,
      0.009122, 0.008909, 0.008226, 0.010512, 0.016713, 0.025564, 0.036827,
      0.048035, 0.055058, 0.059172, 0.06041, 0.05923, 0.057526, 0.055602, 0.05283,
      0.049827, 0.046527, 0.043934, 0.041087, 0.038021, 0.035482, 0.033504,
      0.030795, 0.028852, 0.026826, 0.025244, 0.023429, 0.021525, 0.020308,
      0.019054, 0.017333, 0.015873, 0.015374, 0.016655, 0.018118, 0.018615,
      0.018298, 0.016975, 0.01626, 0.015536, 0.01431, 0.013417, 0.012489, 0.011685,
      0.010941, 0.010514, 0.010158, 0.009186, 0.00885, 0.008292, 0.008606, 0.009107,
      0.007752, 0.006834, 0.007194, 0.005141, 0.005236, 0.005391, 0.005155, 0.00339,
      0.003279, 0.004149, 0.003676, 0.004444, 0.003846, 0.004184, 0.004065,
      0.004184, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    imm_int_n = c(
      2, 15, 15, 14, 13, 11, 10, 9, 8, 7, 6, 5, 4, 4, 3, 4, 4, 5, 6, 8, 9, 10, 12,
      13, 14, 15, 15, 15, 15, 15, 16, 15, 14, 14, 13, 13, 12, 12, 11, 11, 10, 10,
      10, 11, 12, 13, 13, 12, 12, 11, 10, 10, 10, 9, 9, 9, 8, 8, 8, 7, 7, 7, 7, 6,
      6, 5, 5, 5, 5, 5, 4, 4, 4, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1,
      1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 13, 13, 12, 11, 10, 9, 9, 8, 7, 6, 5, 5,
      4, 4, 4, 5, 6, 6, 8, 11, 13, 14, 16, 16, 17, 17, 16, 15, 13, 13, 11, 10, 8, 8,
      7, 7, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 8, 8, 8, 8, 7, 7, 7, 7, 7, 7, 6,
      6, 6, 6, 5, 5, 5, 5, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 1, 1, 1, 1,
      1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 23, 54, 51, 48, 47, 45, 44, 43, 42,
      42, 41, 40, 40, 38, 37, 34, 33, 32, 35, 45, 61, 84, 106, 128, 145, 158, 166,
      169, 169, 166, 161, 155, 148, 140, 132, 124, 117, 110, 103, 97, 91, 86, 81,
      76, 72, 68, 64, 60, 57, 54, 51, 49, 45, 42, 37, 33, 29, 25, 21, 18, 15, 13,
      11, 9, 8, 7, 6, 5, 4, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 46, 42, 40, 39, 39, 38, 38, 38, 39,
      39, 39, 40, 39, 37, 36, 35, 36, 36, 46, 64, 87, 109, 128, 140, 145, 148, 145,
      141, 135, 128, 121, 113, 106, 99, 92, 85, 80, 74, 69, 64, 59, 56, 52, 49, 46,
      44, 42, 40, 38, 36, 35, 33, 30, 27, 25, 21, 19, 16, 14, 12, 10, 9, 8, 7, 6, 5,
      4, 4, 4, 3, 3, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
      0, 0, 0, 0, 0, 0, 0, 0, 2, 15, 15, 14, 13, 11, 10, 9, 8, 7, 6, 5, 4, 4, 3, 4,
      4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 15, 15, 15, 15, 16, 15, 14, 14, 13, 13, 12,
      12, 11, 11, 10, 10, 10, 11, 12, 13, 13, 12, 12, 11, 10, 10, 10, 9, 9, 9, 8, 8,
      8, 7, 7, 7, 7, 6, 6, 5, 5, 5, 5, 5, 4, 4, 4, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 2,
      1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 13, 13, 12, 11, 10, 9,
      9, 8, 7, 6, 5, 5, 4, 4, 4, 5, 6, 6, 8, 11, 13, 14, 16, 16, 17, 17, 16, 15, 13,
      13, 11, 10, 8, 8, 7, 7, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 8, 8, 8, 8, 7,
      7, 7, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 2, 2, 2,
      2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 23, 54, 51, 49,
      47, 45, 44, 43, 42, 42, 41, 40, 40, 39, 37, 35, 33, 32, 35, 45, 61, 84, 107,
      129, 146, 159, 167, 170, 170, 167, 162, 156, 148, 141, 133, 125, 118, 110,
      104, 97, 92, 86, 81, 77, 73, 69, 64, 61, 58, 55, 52, 49, 46, 42, 38, 33, 29,
      25, 21, 18, 15, 13, 11, 9, 8, 7, 6, 5, 4, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18, 46, 43, 41,
      39, 39, 39, 38, 39, 39, 39, 40, 40, 39, 38, 36, 36, 36, 36, 46, 65, 88, 110,
      128, 140, 147, 149, 145, 141, 135, 128, 121, 114, 106, 99, 93, 86, 80, 74, 69,
      64, 60, 56, 53, 49, 47, 44, 42, 40, 38, 37, 35, 33, 30, 28, 25, 22, 19, 16,
      14, 12, 10, 9, 8, 7, 6, 5, 5, 4, 4, 3, 3, 3, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1,
      1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    imm_nat_n = c(
      38, 107, 87, 72, 58, 46, 37, 32, 25, 22, 20, 18, 17, 16, 17, 17, 18, 21, 25,
      32, 43, 60, 81, 104, 120, 136, 147, 159, 163, 163, 159, 157, 145, 138, 126,
      120, 109, 101, 92, 84, 76, 69, 64, 59, 55, 54, 52, 51, 51, 51, 50, 50, 49, 49,
      48, 47, 44, 41, 39, 37, 35, 34, 33, 32, 34, 37, 27, 23, 20, 18, 16, 15, 14,
      13, 11, 10, 9, 8, 6, 5, 5, 4, 4, 3, 3, 2, 2, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 52, 88, 82, 72, 61, 51, 43, 36, 31, 27, 24, 22, 21, 20, 19, 21, 21,
      25, 31, 45, 67, 98, 131, 163, 181, 195, 206, 213, 207, 197, 180, 167, 147,
      135, 119, 105, 92, 86, 77, 72, 65, 59, 55, 53, 49, 48, 47, 45, 46, 45, 46, 46,
      45, 45, 43, 43, 42, 39, 37, 35, 33, 31, 29, 29, 36, 33, 30, 26, 22, 21, 19,
      18, 17, 15, 14, 13, 13, 12, 10, 9, 8, 8, 7, 6, 6, 5, 4, 4, 3, 3, 2, 2, 2, 1,
      1, 0, 0, 0, 0, 0, 0, 12, 35, 36, 32, 28, 24, 20, 18, 15, 14, 12, 11, 9, 7, 6,
      6, 5, 7, 9, 16, 23, 33, 44, 53, 64, 74, 86, 96, 103, 111, 112, 116, 115, 115,
      116, 111, 106, 103, 97, 94, 84, 80, 75, 70, 65, 62, 56, 55, 52, 49, 47, 44,
      42, 40, 36, 35, 30, 24, 21, 19, 16, 14, 12, 10, 9, 9, 6, 5, 4, 3, 3, 2, 2, 2,
      2, 2, 2, 2, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 9, 31, 30, 27, 23, 21, 19, 17, 16, 15, 14, 13, 12, 11, 11, 10, 10, 11, 14,
      17, 25, 35, 43, 52, 59, 64, 70, 77, 81, 83, 84, 83, 78, 75, 73, 69, 63, 60,
      56, 52, 46, 43, 40, 37, 34, 33, 31, 29, 29, 28, 26, 25, 23, 21, 20, 20, 17,
      14, 13, 11, 10, 8, 7, 6, 6, 5, 4, 3, 3, 3, 3, 3, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 37, 107, 88, 71, 58,
      47, 39, 32, 26, 22, 20, 18, 18, 17, 17, 18, 18, 20, 25, 31, 44, 59, 80, 102,
      122, 133, 145, 152, 161, 165, 163, 156, 150, 138, 129, 118, 111, 102, 94, 85,
      78, 71, 64, 60, 55, 52, 51, 49, 49, 49, 49, 49, 48, 47, 48, 47, 45, 43, 40,
      38, 37, 36, 35, 33, 35, 39, 28, 23, 21, 18, 17, 15, 14, 13, 12, 11, 10, 8, 7,
      6, 5, 4, 4, 3, 3, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 58, 88, 82,
      71, 61, 52, 44, 36, 31, 27, 25, 22, 21, 20, 20, 20, 22, 25, 31, 42, 66, 97,
      129, 157, 183, 195, 201, 205, 208, 196, 185, 168, 153, 133, 122, 106, 95, 84,
      80, 70, 66, 60, 55, 51, 49, 46, 46, 44, 44, 45, 44, 45, 45, 43, 43, 42, 42,
      41, 38, 36, 34, 31, 29, 30, 37, 35, 31, 26, 23, 20, 19, 17, 16, 16, 14, 14,
      13, 12, 11, 10, 9, 8, 7, 6, 6, 5, 4, 4, 3, 3, 3, 2, 2, 1, 1, 0, 0, 0, 0, 0, 0,
      13, 39, 33, 32, 29, 25, 21, 18, 16, 14, 12, 11, 9, 8, 6, 5, 6, 7, 10, 15, 23,
      33, 44, 56, 64, 75, 84, 94, 103, 109, 114, 116, 118, 116, 114, 114, 108, 102,
      100, 93, 90, 81, 77, 72, 67, 63, 59, 54, 53, 49, 47, 45, 43, 38, 38, 34, 32,
      26, 22, 20, 18, 15, 12, 10, 9, 9, 6, 5, 4, 3, 3, 3, 2, 2, 2, 2, 2, 2, 2, 1, 1,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 34, 29, 27, 25,
      21, 19, 17, 16, 15, 15, 14, 13, 12, 11, 10, 10, 11, 15, 17, 25, 35, 44, 52,
      58, 63, 67, 73, 80, 83, 84, 83, 81, 76, 72, 69, 65, 59, 56, 53, 49, 44, 41,
      39, 36, 33, 31, 30, 29, 29, 27, 25, 24, 22, 21, 20, 19, 15, 14, 12, 11, 9, 8,
      6, 6, 5, 4, 3, 3, 3, 3, 3, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    acq = rep(
      c(
        0, 0.023466, 0.012683, 0.015564, 0.015817, 0.016457, 0.017258, 0.016304,
        0.017274, 0.01848, 0.021921, 0.027505, 0.03212, 0.037363, 0.040667, 0.044268,
        0.041958, 0.039807, 0.034749, 0.03253, 0.027981, 0.022002, 0.01864, 0.013252,
        0.011089, 0.007463, 0.007905, 0.007457, 0.008427, 0.008563, 0.010131,
        0.011765, 0.012921, 0.014623, 0.015924, 0.016923, 0.017562, 0.017996,
        0.018128, 0.018173, 0.018299, 0.018114, 0.016757, 0.016593, 0.01627, 0.015235,
        0.014907, 0.014303, 0.01388, 0.013734, 0.012087, 0.011976, 0.011421, 0.011104,
        0.010165, 0.009103, 0.0094, 0.008943, 0.00846, 0.008613, 0.007099, 0.007584,
        0.007326, 0.006435, 0.007022, 0.006421, 0.003883, 0.004049, 0.004367,
        0.004082, 0.004819, 0.004796, 0.002597, 0.002695, 0.00339, 0.003049, 0.00304,
        0.003003, 0.003704, 0.003067, 0.003704, 0.004132, 0, 0.014218, 0.015773,
        0.016632, 0.017544, 0.018237, 0.016178, 0.016649, 0.018109, 0.018661, 0.01992,
        0.020299, 0.022099, 0.024887, 0.033181, 0.040884, 0.051903, 0.059202,
        0.058904, 0.053731, 0.048227, 0.040847, 0.031507, 0.02594, 0.023952, 0.022951,
        0.021322, 0.019337, 0.017872, 0.016212, 0.016429, 0.015884, 0.017173,
        0.018046, 0.018204, 0.019653, 0.02042, 0.019871, 0.020196, 0.020809, 0.021814,
        0.022263, 0.021632, 0.02184, 0.022118, 0.021248, 0.020394, 0.019708, 0.018855,
        0.018685, 0.016813, 0.016254, 0.015523, 0.014754, 0.012658, 0.011649,
        0.012456, 0.010649, 0.009772, 0.009249, 0.007778, 0.006485, 0.007278,
        0.006568, 0.003419, 0.003527, 0.003788, 0.002252, 0.00237, 0.002551, 0.002597,
        0.002667, 0.002551, 0.003344, 0, 0.020517, 0.014572, 0.014507, 0.015385,
        0.016623, 0.016268, 0.017078, 0.016114, 0.016143, 0.018009, 0.0222, 0.027749,
        0.032195, 0.03617, 0.040659, 0.041973, 0.041237, 0.037736, 0.034272, 0.029909,
        0.027778, 0.021505, 0.016949, 0.012371, 0.010368, 0.009132, 0.007576,
        0.007988, 0.00823, 0.009747, 0.009798, 0.011287, 0.012842, 0.014524, 0.015667,
        0.016461, 0.01706, 0.017241, 0.018304, 0.018005, 0.017544, 0.017638, 0.018056,
        0.016173, 0.016575, 0.015652, 0.014537, 0.014233, 0.013111, 0.013224,
        0.011742, 0.011429, 0.011273, 0.010794, 0.01043, 0.009554, 0.008469, 0.008708,
        0.008183, 0.007725, 0.007916, 0.007246, 0.006645, 0.006266, 0.006631,
        0.005822, 0.006791, 0.004, 0.004132, 0.004444, 0.004167, 0.004926, 0.002451,
        0.002653, 0.002755, 0.003472, 0.003145, 0.003115, 0.003846, 0.003205,
        0.003891, 0.004405, 0, 0.014981, 0.01633, 0.015773, 0.017598, 0.016537,
        0.016129, 0.016032, 0.017508, 0.018962, 0.018418, 0.019763, 0.021119,
        0.024017, 0.031285, 0.039909, 0.050111, 0.056404, 0.059133, 0.052925, 0.04812,
        0.03966, 0.030568, 0.025608, 0.023669, 0.022654, 0.020731, 0.019175, 0.017692,
        0.015849, 0.016609, 0.016183, 0.016393, 0.017067, 0.018105, 0.018924,
        0.019307, 0.020157, 0.019619, 0.020548, 0.021228, 0.021143, 0.021525,
        0.020923, 0.021025, 0.020667, 0.020503, 0.019567, 0.018827, 0.017422,
        0.016381, 0.015911, 0.01466, 0.013821, 0.012265, 0.011785, 0.011628, 0.009813,
        0.009737, 0.008753, 0.008178, 0.006772, 0.006562, 0.0059, 0.006633, 0.003442,
        0.003643, 0.001938, 0.002278, 0.002398, 0.002571, 0.002618, 0.002695,
        0.002577, 0
      ),
      rep(
        c(202L, 1L, 2L, 1L, 19L, 1L, 230L, 1L, 2L, 1L, 18L, 1L, 28L),
        c(1L, 5L, 1L, 75L, 1L, 73L, 1L, 76L, 1L, 5L, 1L, 73L, 1L)
      )
    ),
    emi_nat_n = c(
      21, 73, 61, 49, 42, 36, 30, 26, 23, 21, 18, 18, 16, 16, 16, 16, 16, 17, 19,
      27, 37, 53, 76, 103, 120, 143, 165, 178, 176, 173, 164, 149, 134, 126, 109,
      104, 90, 82, 74, 67, 59, 53, 50, 44, 43, 45, 42, 43, 44, 45, 45, 47, 46, 46,
      45, 44, 41, 39, 37, 33, 32, 29, 28, 26, 24, 34, 25, 19, 16, 15, 14, 14, 12,
      12, 10, 9, 9, 7, 6, 5, 5, 5, 4, 3, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 0, 0, 0, 0,
      0, 0, 0, 25, 66, 59, 53, 45, 38, 32, 29, 24, 22, 17, 15, 12, 11, 9, 10, 11,
      17, 27, 45, 70, 98, 135, 168, 194, 214, 216, 234, 215, 203, 178, 161, 141,
      121, 103, 90, 80, 73, 64, 54, 49, 43, 41, 41, 37, 36, 35, 36, 38, 39, 39, 40,
      39, 39, 38, 38, 36, 34, 32, 31, 29, 28, 27, 25, 35, 36, 27, 22, 18, 17, 15,
      14, 13, 13, 12, 11, 10, 9, 8, 6, 6, 5, 5, 5, 4, 4, 3, 3, 2, 2, 2, 1, 1, 1, 1,
      0, 0, 0, 0, 0, 0, 10, 28, 26, 25, 20, 17, 15, 14, 11, 9, 8, 7, 6, 5, 5, 5, 5,
      6, 8, 13, 20, 30, 38, 48, 54, 63, 77, 83, 88, 99, 99, 98, 99, 95, 96, 96, 91,
      92, 87, 81, 72, 70, 66, 61, 55, 50, 47, 47, 42, 39, 38, 34, 34, 28, 27, 25,
      21, 17, 16, 14, 11, 10, 8, 7, 6, 4, 3, 3, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 20, 19, 19,
      17, 16, 15, 14, 12, 13, 11, 10, 9, 9, 8, 8, 7, 8, 11, 18, 25, 35, 42, 49, 55,
      56, 63, 68, 71, 70, 68, 66, 66, 63, 62, 59, 53, 50, 47, 44, 38, 35, 30, 28,
      26, 23, 21, 24, 24, 23, 23, 21, 20, 18, 16, 15, 13, 11, 10, 10, 8, 7, 5, 5, 4,
      5, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21, 73, 60, 51, 42, 36, 31, 26, 23, 21, 19, 17,
      17, 16, 16, 16, 17, 18, 20, 25, 38, 52, 74, 100, 127, 141, 158, 173, 179, 172,
      165, 154, 137, 123, 115, 99, 94, 82, 75, 68, 62, 55, 50, 48, 43, 42, 43, 41,
      42, 43, 44, 43, 46, 45, 44, 44, 43, 40, 38, 35, 32, 30, 28, 27, 24, 35, 25,
      19, 17, 15, 14, 13, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 4, 4, 3, 3, 3, 2, 2, 2,
      1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 25, 66, 58, 52, 46, 40, 33, 28, 25, 21, 19,
      15, 13, 11, 10, 9, 12, 17, 27, 44, 68, 99, 129, 166, 193, 211, 221, 215, 224,
      200, 185, 159, 142, 123, 106, 90, 79, 70, 65, 58, 50, 45, 41, 39, 39, 36, 35,
      34, 35, 38, 38, 38, 39, 38, 38, 37, 37, 35, 33, 31, 30, 28, 27, 27, 36, 38,
      28, 21, 19, 16, 16, 15, 14, 13, 12, 11, 10, 10, 8, 7, 6, 6, 5, 4, 4, 3, 3, 3,
      2, 2, 2, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 10, 30, 26, 23, 22, 18, 15, 13, 12, 10,
      8, 7, 7, 6, 5, 5, 5, 6, 8, 12, 20, 27, 39, 47, 58, 64, 72, 85, 90, 93, 103,
      102, 99, 99, 95, 95, 93, 88, 89, 84, 78, 69, 67, 63, 58, 53, 48, 45, 45, 40,
      37, 36, 33, 29, 26, 25, 23, 19, 16, 14, 13, 10, 9, 7, 6, 5, 4, 3, 2, 2, 2, 1,
      1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 10, 21, 18, 18, 18, 16, 15, 14, 14, 12, 12, 11, 10, 9, 8, 8, 7, 8,
      12, 17, 26, 33, 43, 50, 56, 60, 60, 66, 70, 72, 69, 67, 65, 63, 60, 59, 55,
      50, 47, 44, 41, 35, 33, 29, 26, 24, 22, 23, 26, 25, 23, 22, 20, 19, 17, 15,
      14, 12, 10, 9, 9, 7, 6, 5, 5, 5, 4, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    mig_nat_n = c(
      17, 34, 26, 23, 16, 10, 7, 6, 2, 1, 2, 0, 1, 0, 1, 1, 2, 4, 6, 5, 6, 7, 5, 1,
      0, -7, -18, -19, -13, -10, -5, 8, 11, 12, 17, 16, 19, 19, 18, 17, 17, 16, 14,
      15, 12, 9, 10, 8, 7, 6, 5, 3, 3, 3, 3, 3, 3, 2, 2, 4, 3, 5, 5, 6, 10, 3, 2, 4,
      4, 3, 2, 1, 2, 1, 1, 1, 0, 1, 0, 0, 0, -1, 0, 0, 0, -1, 0, -1, -1, -1, 0, 0,
      -1, -1, 0, 0, 0, 0, 0, 0, 0, 27, 22, 23, 19, 16, 13, 11, 7, 7, 5, 7, 7, 9, 9,
      10, 11, 10, 8, 4, 0, -3, 0, -4, -5, -13, -19, -10, -21, -8, -6, 2, 6, 6, 14,
      16, 15, 12, 13, 13, 18, 16, 16, 14, 12, 12, 12, 12, 9, 8, 6, 7, 6, 6, 6, 5, 5,
      6, 5, 5, 4, 4, 3, 2, 4, 1, -3, 3, 4, 4, 4, 4, 4, 4, 2, 2, 2, 3, 3, 2, 3, 2, 3,
      2, 1, 2, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 2, 7, 10, 7, 8, 7, 5,
      4, 4, 5, 4, 4, 3, 2, 1, 1, 0, 1, 1, 3, 3, 3, 6, 5, 10, 11, 9, 13, 15, 12, 13,
      18, 16, 20, 20, 15, 15, 11, 10, 13, 12, 10, 9, 9, 10, 12, 9, 8, 10, 10, 9, 10,
      8, 12, 9, 10, 9, 7, 5, 5, 5, 4, 4, 3, 3, 5, 3, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1,
      11, 11, 8, 6, 5, 4, 3, 4, 2, 3, 3, 3, 2, 3, 2, 3, 3, 3, -1, 0, 0, 1, 3, 4, 8,
      7, 9, 10, 13, 16, 17, 12, 12, 11, 10, 10, 10, 9, 8, 8, 8, 10, 9, 8, 10, 10, 5,
      5, 5, 3, 4, 3, 3, 4, 5, 4, 3, 3, 1, 2, 1, 2, 1, 2, 0, 1, 0, 1, 1, 1, 1, 1, 1,
      0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 16, 34, 28, 20, 16, 11, 8, 6, 3, 1, 1, 1, 1, 1, 1, 2, 1, 2, 5, 6, 6, 7, 6,
      2, -5, -8, -13, -21, -18, -7, -2, 2, 13, 15, 14, 19, 17, 20, 19, 17, 16, 16,
      14, 12, 12, 10, 8, 8, 7, 6, 5, 6, 2, 2, 4, 3, 2, 3, 2, 3, 5, 6, 7, 6, 11, 4,
      3, 4, 4, 3, 3, 2, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, -1, 0, -1, -1, -1, -1, -1,
      0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 33, 22, 24, 19, 15, 12, 11, 8, 6, 6, 6, 7,
      8, 9, 10, 11, 10, 8, 4, -2, -2, -2, 0, -9, -10, -16, -20, -10, -16, -4, 0, 9,
      11, 10, 16, 16, 16, 14, 15, 12, 16, 15, 14, 12, 10, 10, 11, 10, 9, 7, 6, 7, 6,
      5, 5, 5, 5, 6, 5, 5, 4, 3, 2, 3, 1, -3, 3, 5, 4, 4, 3, 2, 2, 3, 2, 3, 3, 2, 3,
      3, 3, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 3, 9, 7, 9,
      7, 7, 6, 5, 4, 4, 4, 4, 2, 2, 1, 0, 1, 1, 2, 3, 3, 6, 5, 9, 6, 11, 12, 9, 13,
      16, 11, 14, 19, 17, 19, 19, 15, 14, 11, 9, 12, 12, 10, 9, 9, 10, 11, 9, 8, 9,
      10, 9, 10, 9, 12, 9, 9, 7, 6, 6, 5, 5, 3, 3, 3, 4, 2, 2, 2, 1, 1, 2, 1, 1, 1,
      1, 1, 1, 1, 0, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, -1, 13, 11, 9, 7, 5, 4, 3, 2, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 0, -1, 2, 1, 2,
      2, 3, 7, 7, 10, 11, 15, 16, 16, 13, 12, 10, 10, 9, 9, 9, 8, 9, 8, 10, 10, 9,
      9, 7, 3, 4, 4, 3, 4, 3, 4, 5, 5, 3, 4, 3, 2, 2, 2, 1, 1, 0, 0, 0, 0, 1, 1, 1,
      0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0
    ),
  )

  ## FSO population ----
  # fso_population |>
  #   constructive::construct()
  population_short_1r <- tibble::tibble(
    year = rep("2018", 404L),
    spatial_unit = rep("Aargau", 404L),
    nat = rep(c("ch", "int"), each = 202L),
    sex = rep(rep(c("m", "f"), 2), each = 101L),
    age = rep(seq(0, 100, by = 1), 4),
    n = c(
      2506, 2589, 2568, 2635, 2710, 2608, 2569, 2611, 2634, 2512, 2564, 2411, 2514,
      2531, 2559, 2571, 2535, 2515, 2799, 2739, 2837, 2916, 3020, 2865, 2920, 3052,
      3125, 3058, 3060, 3057, 2963, 2923, 3031, 2906, 3099, 3001, 3037, 3029, 3026,
      2936, 2847, 2897, 2747, 2824, 3066, 3046, 3219, 3435, 3595, 3689, 4001, 4084,
      4124, 4203, 4275, 4109, 4096, 3998, 3761, 3721, 3611, 3627, 3472, 3441, 3256,
      3146, 3053, 2845, 2876, 2797, 2824, 2738, 2709, 2557, 2439, 2351, 2111, 1895,
      1533, 1454, 1476, 1297, 1181, 1114, 1080, 875, 828, 704, 594, 485, 407, 293,
      229, 170, 115, 95, 65, 32, 17, 18, 9, 2377, 2472, 2524, 2497, 2403, 2395,
      2472, 2386, 2540, 2392, 2467, 2313, 2357, 2295, 2384, 2384, 2415, 2454, 2513,
      2620, 2620, 2777, 2838, 2872, 2925, 2859, 3127, 2998, 3056, 2961, 3006, 3000,
      2969, 2923, 2965, 3026, 3169, 3173, 2992, 2969, 2864, 2960, 3126, 3008, 3064,
      3091, 3285, 3601, 3801, 3859, 4113, 4133, 4266, 4285, 4371, 4302, 4124, 4088,
      4001, 3832, 3831, 3832, 3628, 3538, 3388, 3292, 3300, 3050, 3083, 2996, 2956,
      2888, 2895, 2795, 2731, 2650, 2379, 2166, 1927, 1881, 1805, 1695, 1694, 1524,
      1493, 1348, 1312, 1154, 1070, 913, 810, 618, 543, 435, 319, 238, 171, 115, 74,
      36, 54, 1025, 1028, 1138, 1033, 1043, 1043, 1104, 1042, 974, 958, 1018, 934,
      910, 959, 881, 858, 829, 777, 830, 822, 909, 912, 981, 992, 1072, 1265, 1341,
      1424, 1635, 1678, 1700, 1780, 1778, 1884, 1950, 1936, 2056, 2041, 1981, 1858,
      1877, 1850, 1808, 1721, 1641, 1610, 1678, 1585, 1529, 1572, 1503, 1576, 1531,
      1574, 1538, 1383, 1230, 1182, 1161, 986, 923, 819, 777, 712, 623, 515, 494,
      458, 490, 415, 417, 385, 371, 295, 328, 329, 333, 270, 326, 270, 242, 181,
      190, 144, 116, 76, 61, 43, 44, 39, 23, 23, 10, 9, 3, 3, 2, 1, 1, 3, 1, 951,
      962, 1026, 987, 989, 961, 994, 911, 1004, 936, 905, 884, 874, 905, 867, 777,
      730, 670, 705, 661, 730, 771, 835, 915, 938, 1086, 1231, 1357, 1400, 1448,
      1514, 1607, 1648, 1730, 1763, 1711, 1733, 1730, 1742, 1617, 1618, 1511, 1492,
      1506, 1422, 1370, 1432, 1338, 1249, 1292, 1224, 1220, 1185, 1116, 1124, 1033,
      921, 865, 900, 771, 687, 609, 585, 567, 528, 444, 422, 392, 385, 375, 392,
      299, 308, 245, 276, 229, 265, 244, 253, 247, 205, 184, 138, 139, 102, 97, 67,
      65, 47, 35, 30, 26, 19, 10, 11, 12, 3, 5, 2, 0, 2
    ),
  )

  ## Run propop with 1 region ----
  output_propop_1r <- propop(
    parameters = parameters_short_1r,
    year_first = 2019,
    year_last = 2020,
    age_groups = 101,
    fert_first = 16,
    fert_last = 50,
    share_born_female = 100 / 205,
    population = population_short_1r,
    binational = TRUE,
    subregional = FALSE
  )

  # Run snapshot 1 region ----
  expect_snapshot(constructive::construct(output_propop_1r))


  # Prepare snapshot for subregions -----

  ## FSO parameters with fictitious subregions ----
  # fso_parameters |>
  #   dplyr::filter(year < 2021) |>
  #   # Create fictitious intra-cantonal migration parameter
  #   dplyr::rowwise() |>
  #   dplyr::mutate(
  #     mig_sub_1 = {set.seed(1); round(rnorm(1, mean = 0, sd = 0.2), digits = 4)},
  #     mig_sub_2 = {set.seed(2);round(rnorm(1, mean = 0, sd = 0.2), digits = 4)},
  #     mig_sub_3 = {set.seed(3);round(rnorm(1, mean = 0, sd = 0.2), digits = 4)},
  #     mig_sub_4 = {set.seed(4);round(rnorm(1, mean = 0, sd = 0.2), digits = 4)},
  #     mig_sub_5 = 0 - sum(mig_sub_1, mig_sub_2,mig_sub_3,mig_sub_4)
  #     # check = sum(mig_sub_1, mig_sub_2,mig_sub_3,mig_sub_4,mig_sub_5)
  #   ) |>
  #   tidyr::pivot_longer(mig_sub_1:mig_sub_5,
  #                names_to = "subregion",
  #                values_to = "mig_sub") |>
  #   dplyr::mutate(spatial_unit = as.character(stringr::str_extract(subregion, "(?<=mig_sub_).*"))) |>
  #   # divide the size of parameters with numbers by the number of regions (=5),
  #   # otherwise the multiplication of lines inflates the size of the population
  #   dplyr::mutate_at(dplyr::vars(imm_int_n, imm_nat_n, emi_nat_n, mig_nat_n), ~ ./5) |>
  #   dplyr::select(-subregion) |>
  # constructive::construct()

  parameters_short_5r <- tibble::tibble(
    nat = rep(rep(c("ch", "int"), 2), each = 1010L),
    sex = rep(rep(c("m", "f"), 4), each = 505L),
    age = rep(rep(seq(0, 100, by = 1), 8), each = 5L),
    year = rep(c("2019", "2020"), each = 2020L),
    scen = rep("reference", 4040L),
    spatial_unit = rep(c("1", "2", "3", "4", "5"), 808),
    birthrate = rep(
      c(
        0, 0.00041, 0.000808, 0.001581, 0.003418, 0.006455, 0.010405, 0.016157,
        0.02364, 0.032479, 0.042954, 0.055049, 0.068632, 0.083007, 0.09798, 0.111332,
        0.121122, 0.125879, 0.122941, 0.112803, 0.097161, 0.078333, 0.05944, 0.042398,
        0.028719, 0.018692, 0.011733, 0.006989, 0.00429, 0.00227, 0.001286, 0.000606,
        0.000277, 0.000262, 0, 0.001381, 0.005993, 0.017009, 0.032641, 0.048974,
        0.065594, 0.081725, 0.094398, 0.106007, 0.114386, 0.122848, 0.130621,
        0.134582, 0.136562, 0.134367, 0.129289, 0.120395, 0.109997, 0.096929,
        0.083624, 0.06944, 0.055859, 0.043528, 0.032069, 0.022818, 0.015167, 0.009358,
        0.005302, 0.002804, 0.001454, 0.000698, 0, 0.000402, 0.001594, 0.003124,
        0.005644, 0.009778, 0.014979, 0.022016, 0.030871, 0.041047, 0.053292,
        0.066976, 0.082033, 0.097347, 0.111297, 0.121859, 0.127219, 0.124628,
        0.114793, 0.099225, 0.080272, 0.060831, 0.04378, 0.029622, 0.019051, 0.011915,
        0.007267, 0.004389, 0.002279, 0.001281, 0.000636, 3e-04, 0.000274, 0,
        0.001327, 0.005602, 0.014993, 0.030641, 0.047519, 0.063492, 0.078652,
        0.093285, 0.104471, 0.114964, 0.123887, 0.130657, 0.136027, 0.137455,
        0.134702, 0.130354, 0.122096, 0.111176, 0.098619, 0.085166, 0.071162,
        0.057419, 0.044622, 0.033077, 0.023306, 0.015352, 0.009823, 0.005317,
        0.002639, 0.001394, 0.000722, 0
      ),
      rep(
        c(590L, 5L, 845L, 5L, 860L, 5L, 845L, 5L, 265L),
        c(1L, 33L, 1L, 31L, 1L, 32L, 1L, 31L, 1L)
      )
    ),
    int_mothers = rep(c(0.23487796250442164, 0.23488290807409998), each = 2020L),
    mor = rep(
      c(
        0.004386, 0.000791, 0.000383, 0.000386, 0, 0.000388, 0.000412, 0.000395,
        0.000392, 0.000388, 0.000386, 0.000391, 0.00079, 0.00071, 0.000726, 0.000702,
        0.000683, 0.000661, 0.000348, 0.000342, 0.000328, 0.000321, 0.000327,
        0.000336, 0.00034, 0.000328, 0.000341, 0.000641, 0.000661, 0.000653, 0.000655,
        0.000675, 0.001045, 0.001028, 0.001083, 0.001406, 0.001297, 0.001632,
        0.001545, 0.001739, 0.00194, 0.002162, 0.002244, 0.002442, 0.002661, 0.002849,
        0.003036, 0.003402, 0.003659, 0.003999, 0.004515, 0.004835, 0.005534,
        0.006061, 0.006621, 0.007257, 0.00799, 0.008904, 0.009823, 0.010539, 0.011816,
        0.012866, 0.014162, 0.015699, 0.017346, 0.019547, 0.021726, 0.02424, 0.027456,
        0.031118, 0.035202, 0.039863, 0.046055, 0.052408, 0.059247, 0.067295,
        0.076852, 0.086808, 0.096618, 0.107955, 0.119529, 0.129763, 0.139877,
        0.150427, 0.166302, 0.188235, 0.217391, 0.252632, 0.292308, 0.3125, 0.352941,
        0.481481, 0.003348, 0.000417, 0.000401, 0.000393, 0, 0.000404, 0.000395,
        0.00038, 0.000359, 0.000351, 0.000348, 0.000342, 0.000349, 0.00032, 0.000333,
        0.000327, 0.000337, 0.000331, 0.000332, 0.000669, 0.000679, 0.000669,
        0.000656, 0.000626, 0.000625, 0.000662, 0.000668, 0.000692, 0.00067, 0.000635,
        0.00066, 0.000972, 0.000964, 0.000908, 0.001106, 0.001311, 0.001291, 0.001455,
        0.001689, 0.001871, 0.001863, 0.002055, 0.00232, 0.002663, 0.002931, 0.003245,
        0.003389, 0.003651, 0.004173, 0.004683, 0.005088, 0.005315, 0.006073,
        0.006359, 0.007207, 0.007778, 0.008338, 0.009125, 0.010379, 0.011395,
        0.012876, 0.014275, 0.016217, 0.018063, 0.020766, 0.023334, 0.027092,
        0.030437, 0.035367, 0.04072, 0.046557, 0.054235, 0.063033, 0.073143, 0.084885,
        0.098085, 0.112815, 0.12947, 0.147011, 0.167587, 0.193103, 0.222571, 0.260504,
        0.304094, 0.347826, 0.391892, 0.555556, 0.003623, 0.000971, 0, 0.001172,
        0.001214, 0.001293, 0.001206, 0.001205, 0.001079, 0.001062, 0, 0.000593,
        0.00058, 0.000573, 0.000549, 0.000551, 0.000522, 0.000507, 0.000512, 0.000484,
        0.000488, 0.000503, 0.000536, 0.001063, 0.001079, 0.001105, 0.00116, 0.001214,
        0.001239, 0.001191, 0.001889, 0.001958, 0.001905, 0.001991, 0.001902,
        0.002607, 0.002541, 0.0026, 0.002893, 0.003257, 0.003403, 0.004342, 0.00409,
        0.004372, 0.004935, 0.00651, 0.007123, 0.008217, 0.007851, 0.010173, 0.010953,
        0.012295, 0.01451, 0.01444, 0.018205, 0.018893, 0.020374, 0.024465, 0.027439,
        0.03012, 0.033395, 0.036923, 0.040892, 0.045833, 0.055402, 0.058047, 0.069686,
        0.077922, 0.092715, 0.098361, 0.116279, 0.136364, 0.153846, 0.173913, 0.2,
        0.222222, 0.333333, 0.5, 0, 0.5, 0.004766, 0.001051, 0, 0.001037, 0, 0.000782,
        0.000714, 0.000693, 0.000672, 0.000646, 0.000613, 0.000599, 0.000573,
        0.000563, 0.000581, 0.000574, 0.000576, 0.000573, 0.000617, 0.000659,
        0.000668, 0.000662, 0.000701, 0.000727, 0.000697, 0.000746, 0.000798,
        0.000772, 0.000815, 0.001636, 0.001684, 0.001789, 0.00178, 0.00194, 0.002177,
        0.002322, 0.003354, 0.002606, 0.002926, 0.003295, 0.003425, 0.005362,
        0.005731, 0.00452, 0.007126, 0.007653, 0.007792, 0.008011, 0.007663, 0.01005,
        0.00974, 0.01227, 0.014493, 0.017467, 0.018868, 0.020492, 0.023762, 0.028398,
        0.03423, 0.038043, 0.050725, 0.057762, 0.068627, 0.082474, 0.089552, 0.107692,
        0.12766, 0.142857, 0.133333, 0.150943, 0.157895, 0.2, 0.181818, 0.25,
        0.333333, 0.2, 0.5, 0.004356, 0.000789, 0.000389, 0.000377, 0, 0.000392,
        0.000383, 0.000406, 0.000389, 0.000386, 0.000382, 0.00038, 0.000772, 0.00078,
        0.000702, 0.000719, 0.000696, 0.000679, 0.000659, 0.000348, 0.000343,
        0.000329, 0.000322, 0.000327, 0.000326, 0.000325, 0.000333, 0.000336,
        0.000324, 0.000672, 0.000631, 0.00065, 0.000642, 0.000644, 0.000968, 0.000997,
        0.001028, 0.001013, 0.001422, 0.001388, 0.001604, 0.001616, 0.001839,
        0.002015, 0.00193, 0.002153, 0.002238, 0.002437, 0.002656, 0.003083, 0.00327,
        0.003647, 0.00391, 0.004259, 0.004792, 0.00539, 0.005832, 0.006368, 0.00723,
        0.007597, 0.008678, 0.009308, 0.010573, 0.011348, 0.012647, 0.013746,
        0.015078, 0.017053, 0.018769, 0.02112, 0.023451, 0.026574, 0.030141, 0.034258,
        0.039136, 0.044317, 0.050355, 0.057724, 0.065618, 0.075, 0.084253, 0.095,
        0.105615, 0.116242, 0.127985, 0.136954, 0.148148, 0.165657, 0.184211,
        0.210145, 0.244444, 0.28169, 0.326087, 0.363636, 0.48, 0.003316, 0.000414,
        0.00041, 0.000395, 0, 0.000402, 0.000398, 0.00039, 0.000376, 0.000357,
        0.000349, 0.000347, 0.000342, 0.000348, 0.00032, 0.000332, 0.000651, 0.000334,
        0.000657, 0.000661, 0.000669, 0.000659, 0.000647, 0.000617, 0.000616,
        0.000651, 0.000657, 0.000681, 0.00066, 0.00094, 0.000976, 0.00096, 0.000953,
        0.001199, 0.001371, 0.001303, 0.001541, 0.00169, 0.001683, 0.001866, 0.002093,
        0.00228, 0.00255, 0.002904, 0.003176, 0.003497, 0.003655, 0.004181, 0.004446,
        0.004979, 0.005402, 0.005938, 0.006408, 0.006998, 0.007577, 0.008479,
        0.009066, 0.010216, 0.011171, 0.012565, 0.014118, 0.015953, 0.018001,
        0.020508, 0.023064, 0.026497, 0.029981, 0.034748, 0.039658, 0.046097,
        0.053571, 0.062257, 0.071965, 0.082957, 0.096454, 0.110709, 0.127082,
        0.144068, 0.164461, 0.190265, 0.219373, 0.254032, 0.295455, 0.344538, 0.4,
        0.529412, 0.003566, 0.000907, 0, 0.001151, 0.001186, 0.001229, 0.001295,
        0.001195, 0.001164, 0.001027, 0.000987, 0, 0.000561, 0.000551, 0.000546,
        0.000528, 0.000531, 0.000508, 0.000497, 0.000503, 0.00048, 0.000486, 0.001,
        0.001066, 0.001061, 0.001077, 0.001104, 0.001157, 0.001208, 0.001235,
        0.001786, 0.001886, 0.001951, 0.001901, 0.001984, 0.002537, 0.002603,
        0.002549, 0.003262, 0.003639, 0.003289, 0.00432, 0.00444, 0.005214, 0.00559,
        0.006329, 0.00672, 0.007452, 0.008613, 0.01005, 0.010363, 0.011148, 0.012552,
        0.014815, 0.017199, 0.018592, 0.022069, 0.024348, 0.025197, 0.028346,
        0.031201, 0.034749, 0.041801, 0.043137, 0.053333, 0.058997, 0.067606,
        0.075472, 0.085308, 0.103704, 0.109091, 0.131579, 0.151515, 0.157895, 0.25,
        0.285714, 0, 0.5, 0, 0.333333, 0.004714, 0.000961, 0, 0.000941, 0, 0.00073,
        0.000673, 0.000657, 0.000641, 0.000621, 0.000595, 0.000585, 0.000563,
        0.000556, 0.000574, 0.000568, 0.000572, 0.00057, 0.000613, 0.000614, 0.000655,
        0.000664, 0.00066, 0.000697, 0.000722, 0.000696, 0.000743, 0.000793, 0.00154,
        0.001621, 0.001633, 0.001681, 0.001788, 0.001787, 0.001955, 0.002198,
        0.002347, 0.003405, 0.003955, 0.004441, 0.004996, 0.005236, 0.00551, 0.005837,
        0.006849, 0.007212, 0.007712, 0.007864, 0.008097, 0.010336, 0.010169,
        0.013115, 0.012448, 0.014733, 0.017778, 0.023077, 0.025157, 0.028513,
        0.033543, 0.040609, 0.045198, 0.053435, 0.061538, 0.073684, 0.089888,
        0.098361, 0.12069, 0.121951, 0.133333, 0.153846, 0.130435, 0.1875, 0.25,
        0.222222, 0, 0.25, 0.5
      ),
      rep(
        c(
          5L, 35L, 5L, 15L, 5L, 10L, 5L, 70L, 5L, 10L, 5L, 70L, 5L, 30L, 5L, 10L, 5L,
          10L, 5L, 10L, 5L, 110L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 35L, 5L, 70L, 5L, 10L,
          5L, 10L, 5L, 70L, 5L, 30L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 115L, 5L, 10L, 5L,
          10L, 5L
        ),
        c(
          4L, 1L, 17L, 1L, 7L, 1L, 65L, 1L, 2L, 1L, 81L, 1L, 7L, 1L, 62L, 1L, 2L, 1L,
          1L, 1L, 3L, 1L, 1L, 1L, 13L, 1L, 57L, 1L, 4L, 1L, 94L, 1L, 3L, 1L, 9L, 1L,
          69L, 1L, 8L, 1L, 59L, 1L, 1L, 1L, 4L, 1L, 3L, 1L, 1L, 1L, 68L, 1L, 3L
        )
      )
    ),
    emi_int = rep(
      c(
        0.002417, 0.005986, 0.005407, 0.005062, 0.004175, 0.004059, 0.003834,
        0.003114, 0.002681, 0.002278, 0.00199, 0.00156, 0.001244, 0.001193, 0.00079,
        0.000782, 0.000778, 0.000789, 0.001193, 0.001786, 0.002556, 0.003172,
        0.003429, 0.003974, 0.004538, 0.005137, 0.005242, 0.00544, 0.005559, 0.005556,
        0.005561, 0.0054, 0.005132, 0.005279, 0.004818, 0.00484, 0.004332, 0.004281,
        0.004292, 0.003966, 0.003747, 0.003512, 0.003452, 0.00364, 0.003541, 0.003262,
        0.003283, 0.003107, 0.002911, 0.002782, 0.002711, 0.002749, 0.002449,
        0.002425, 0.002617, 0.002807, 0.00292, 0.003174, 0.003252, 0.003457, 0.003494,
        0.0036, 0.003584, 0.003744, 0.003778, 0.004914, 0.003814, 0.002948, 0.002812,
        0.002434, 0.002145, 0.002125, 0.001826, 0.001846, 0.001564, 0.00164, 0.001276,
        0.000947, 0.001055, 0.000652, 0.000688, 0.000678, 0.000771, 0.000847, 0,
        0.003384, 0.003786, 0.003641, 0.003566, 0.003604, 0.003329, 0.00334, 0.003236,
        0.003353, 0.002756, 0.002926, 0.002432, 0.002162, 0.002121, 0.002179,
        0.001678, 0.001656, 0.002037, 0.003183, 0.003053, 0.003241, 0.004228,
        0.004875, 0.005812, 0.006296, 0.006716, 0.007005, 0.006872, 0.006417,
        0.005988, 0.005667, 0.004715, 0.004447, 0.00371, 0.003305, 0.00284, 0.002521,
        0.002674, 0.002358, 0.002444, 0.002365, 0.002239, 0.002327, 0.002285,
        0.002265, 0.002435, 0.002222, 0.002368, 0.002332, 0.002188, 0.002178, 0.00211,
        0.0021, 0.002059, 0.002092, 0.00194, 0.001957, 0.00175, 0.001827, 0.001929,
        0.002544, 0.002066, 0.002126, 0.001515, 0.001311, 0.001297, 0.001335,
        0.001015, 0.001039, 0.001036, 0.001073, 0.001098, 0.001132, 0.001261,
        0.000923, 0.001038, 0.000532, 0.000554, 0.00059, 0.000656, 0.00067, 0.000742,
        0.000762, 0.000867, 0.000935, 0.001095, 0, 0.004513, 0.037073, 0.032101,
        0.02812, 0.025169, 0.022052, 0.018217, 0.016304, 0.014395, 0.01232, 0.009395,
        0.008841, 0.007495, 0.006593, 0.005214, 0.00454, 0.006993, 0.013269, 0.020592,
        0.026506, 0.030414, 0.034103, 0.039474, 0.040775, 0.041331, 0.041978,
        0.041897, 0.041014, 0.040028, 0.038532, 0.036949, 0.035882, 0.03427, 0.033746,
        0.032378, 0.031795, 0.031508, 0.030642, 0.029887, 0.029783, 0.029602,
        0.028769, 0.028108, 0.028208, 0.027891, 0.026204, 0.025466, 0.02503, 0.024606,
        0.023545, 0.022265, 0.021956, 0.020939, 0.019595, 0.01906, 0.018205, 0.0188,
        0.020325, 0.024535, 0.027562, 0.029412, 0.028169, 0.031746, 0.032175,
        0.036517, 0.05939, 0.034951, 0.020243, 0.015284, 0.012245, 0.012048, 0.009592,
        0.007792, 0.008086, 0.010169, 0.009146, 0.009119, 0.009009, 0.007407,
        0.006135, 0.007407, 0.008264, 0.005525, 0.005263, 0.006944, 0.008621,
        0.013158, 0, 0.012322, 0.043113, 0.034304, 0.02729, 0.02229, 0.019211,
        0.016649, 0.015091, 0.01427, 0.012948, 0.012821, 0.012155, 0.011312, 0.010297,
        0.01105, 0.010381, 0.010296, 0.010959, 0.01194, 0.014184, 0.016641, 0.017808,
        0.020752, 0.022754, 0.02623, 0.029851, 0.030387, 0.030057, 0.029477, 0.029286,
        0.029696, 0.028402, 0.028002, 0.026699, 0.025434, 0.023823, 0.022209,
        0.020196, 0.019075, 0.017222, 0.016079, 0.014833, 0.013898, 0.012735,
        0.011952, 0.011955, 0.010949, 0.011173, 0.010463, 0.010408, 0.010062,
        0.010621, 0.010656, 0.01097, 0.012545, 0.015125, 0.017425, 0.019544, 0.020809,
        0.021111, 0.020752, 0.018923, 0.018062, 0.015385, 0.038801, 0.024621,
        0.018018, 0.011848, 0.010204, 0.01039, 0.010667, 0.010204, 0.010033, 0.00974,
        0.012245, 0.007246, 0.008734, 0.007547, 0.008197, 0.007905, 0.008097,
        0.009756, 0.01087, 0.014493, 0.014388, 0.009804, 0.010309, 0.014925, 0.015385,
        0.021277, 0.028571, 0.033333, 0, 0.001999, 0.005976, 0.005488, 0.004941,
        0.004599, 0.00412, 0.003652, 0.003038, 0.002699, 0.00228, 0.001884, 0.001577,
        0.001157, 0.000819, 0.000785, 0.000778, 0.000769, 0.000766, 0.001166,
        0.001962, 0.002472, 0.003251, 0.003842, 0.004084, 0.004616, 0.005216,
        0.005479, 0.005588, 0.005782, 0.005566, 0.005554, 0.005543, 0.005353,
        0.005076, 0.004892, 0.004744, 0.004453, 0.004261, 0.004207, 0.003896,
        0.003901, 0.003686, 0.003801, 0.003403, 0.003584, 0.003145, 0.003227,
        0.002924, 0.003079, 0.00289, 0.003042, 0.002969, 0.002493, 0.002442, 0.00242,
        0.002614, 0.002806, 0.002922, 0.003179, 0.003259, 0.003465, 0.003507,
        0.003336, 0.003601, 0.003475, 0.004673, 0.00341, 0.00321, 0.002645, 0.002129,
        0.002109, 0.00181, 0.001795, 0.001854, 0.001502, 0.001594, 0.001257, 0.001307,
        0.000973, 0.000544, 0.000675, 0.000715, 0.00071, 0.000813, 0, 0.00252,
        0.003759, 0.003724, 0.00358, 0.003512, 0.003553, 0.003287, 0.003302, 0.003203,
        0.002905, 0.002729, 0.002482, 0.002407, 0.002133, 0.002089, 0.001709,
        0.001639, 0.002431, 0.002807, 0.002749, 0.003023, 0.0034, 0.00429, 0.005252,
        0.005901, 0.006496, 0.006974, 0.007047, 0.006656, 0.006527, 0.006042,
        0.005611, 0.005286, 0.004659, 0.003709, 0.003322, 0.002934, 0.002489,
        0.002484, 0.002298, 0.002318, 0.002402, 0.002329, 0.002208, 0.002294,
        0.002255, 0.002237, 0.002109, 0.002203, 0.002093, 0.002061, 0.002179,
        0.002169, 0.002104, 0.002096, 0.002055, 0.001857, 0.001939, 0.001957, 0.00175,
        0.001829, 0.001831, 0.001832, 0.002489, 0.001989, 0.002079, 0.001527,
        0.001218, 0.001319, 0.000979, 0.001008, 0.001022, 0.001048, 0.001047,
        0.001087, 0.001114, 0.001149, 0.000855, 0.000942, 0.000531, 0.000546, 0.00057,
        0.000611, 0.000615, 0.000687, 0.000708, 0.000791, 0.000822, 0.000946,
        0.001035, 0.001235, 0, 0.001784, 0.035519, 0.032882, 0.027885, 0.024497,
        0.02201, 0.018027, 0.015166, 0.01435, 0.012322, 0.010091, 0.008222, 0.007805,
        0.006383, 0.005495, 0.005247, 0.008018, 0.012972, 0.019584, 0.024707,
        0.028986, 0.033453, 0.038136, 0.040206, 0.04147, 0.041096, 0.041246, 0.039942,
        0.039095, 0.037687, 0.036311, 0.034989, 0.034059, 0.032813, 0.032415,
        0.031379, 0.031109, 0.030426, 0.029865, 0.029684, 0.028571, 0.028862,
        0.028147, 0.027493, 0.026519, 0.026667, 0.025439, 0.025371, 0.024434,
        0.023929, 0.022179, 0.021587, 0.020557, 0.019683, 0.018905, 0.018471,
        0.018893, 0.020319, 0.023732, 0.025751, 0.029024, 0.02588, 0.027685, 0.028822,
        0.034483, 0.056769, 0.035654, 0.02, 0.014463, 0.011111, 0.0125, 0.009852,
        0.009804, 0.007958, 0.008264, 0.006944, 0.006289, 0.006231, 0.007692, 0.00641,
        0.007782, 0.008811, 0.005882, 0.005618, 0.007519, 0.009434, 0.014706, 0,
        0.011236, 0.040346, 0.032597, 0.026915, 0.021401, 0.019153, 0.016032,
        0.014418, 0.012974, 0.013001, 0.011858, 0.011616, 0.010917, 0.010056,
        0.010262, 0.010022, 0.010576, 0.011827, 0.012535, 0.015038, 0.016997,
        0.017467, 0.019206, 0.023669, 0.02589, 0.028628, 0.028763, 0.029486, 0.029434,
        0.028374, 0.028995, 0.028197, 0.027813, 0.026554, 0.024837, 0.023282,
        0.021277, 0.020196, 0.018265, 0.017212, 0.015429, 0.01476, 0.013538, 0.013141,
        0.012, 0.011243, 0.011181, 0.010862, 0.010453, 0.010424, 0.009547, 0.010031,
        0.009756, 0.011447, 0.012626, 0.014311, 0.016949, 0.019474, 0.021882,
        0.021028, 0.020316, 0.018373, 0.017699, 0.016584, 0.037866, 0.023679,
        0.015504, 0.013667, 0.01199, 0.010283, 0.010471, 0.010782, 0.010309, 0.010169,
        0.009836, 0.008299, 0.011029, 0.008889, 0.007692, 0.008368, 0.00813, 0.008368,
        0.010152, 0.011299, 0.007634, 0.007692, 0.010526, 0.011236, 0.016393,
        0.017241, 0.02439, 0.033333, 0.038462, 0
      ),
      rep(
        c(
          5L, 85L, 5L, 10L, 5L, 10L, 5L, 15L, 5L, 10L, 5L, 50L, 5L, 70L, 5L, 45L, 5L,
          85L, 5L, 10L, 5L, 45L, 5L, 10L, 5L, 65L, 5L, 40L
        ),
        c(
          84L, 1L, 15L, 1L, 3L, 1L, 38L, 1L, 19L, 1L, 7L, 1L, 87L, 1L, 92L, 1L, 84L, 1L,
          16L, 1L, 74L, 1L, 76L, 1L, 10L, 1L, 93L, 1L
        )
      )
    ),
    emi_nat = rep(
      c(
        0.008461, 0.02913, 0.023561, 0.019081, 0.015939, 0.013284, 0.011503, 0.010121,
        0.008809, 0.007973, 0.007166, 0.00702, 0.006636, 0.006364, 0.006322, 0.006252,
        0.006223, 0.006706, 0.007555, 0.009646, 0.013509, 0.018682, 0.026063,
        0.034106, 0.041885, 0.048973, 0.054063, 0.05696, 0.057554, 0.056536, 0.053647,
        0.050287, 0.045843, 0.04157, 0.037509, 0.033559, 0.02999, 0.027, 0.024431,
        0.022141, 0.020095, 0.018616, 0.017259, 0.016017, 0.015227, 0.014677,
        0.013789, 0.013358, 0.012809, 0.012517, 0.012198, 0.011747, 0.011263,
        0.011154, 0.010707, 0.010292, 0.009978, 0.009521, 0.009255, 0.008774, 0.0086,
        0.008031, 0.00772, 0.007488, 0.006975, 0.010442, 0.007947, 0.006223, 0.005624,
        0.005216, 0.005005, 0.004958, 0.004383, 0.00443, 0.003911, 0.00369, 0.003828,
        0.003316, 0.003166, 0.003262, 0.003439, 0.003388, 0.003084, 0.00254, 0.002693,
        0.002778, 0.002286, 0.002415, 0.002841, 0.003367, 0.002062, 0.002457,
        0.003413, 0.004367, 0, 0.010575, 0.027766, 0.023867, 0.020998, 0.018022,
        0.015814, 0.013361, 0.011731, 0.010059, 0.008661, 0.007107, 0.00608, 0.005188,
        0.004667, 0.003922, 0.004195, 0.004614, 0.007039, 0.011002, 0.017907,
        0.026718, 0.037405, 0.048614, 0.059197, 0.067549, 0.073162, 0.075551,
        0.074832, 0.071714, 0.066427, 0.060115, 0.05356, 0.047, 0.040754, 0.035238,
        0.030354, 0.026438, 0.023036, 0.02017, 0.018048, 0.016504, 0.015014, 0.013851,
        0.013116, 0.012301, 0.011749, 0.011323, 0.010959, 0.010553, 0.01026, 0.010106,
        0.009725, 0.009436, 0.009142, 0.008868, 0.008694, 0.008368, 0.008244,
        0.007828, 0.007748, 0.007568, 0.007309, 0.007046, 0.006891, 0.009893,
        0.010626, 0.008202, 0.006667, 0.005902, 0.005514, 0.005007, 0.004736,
        0.004501, 0.004491, 0.004293, 0.004028, 0.003774, 0.003783, 0.003693,
        0.003114, 0.00319, 0.00277, 0.00295, 0.002952, 0.002625, 0.002679, 0.002226,
        0.002287, 0.001733, 0.001869, 0.002191, 0.001235, 0.001618, 0.001842,
        0.002299, 0, 0.009025, 0.027317, 0.025292, 0.021968, 0.019361, 0.016299,
        0.014382, 0.012681, 0.010557, 0.00924, 0.008351, 0.006876, 0.006424, 0.005495,
        0.005214, 0.005675, 0.005828, 0.007238, 0.010296, 0.015663, 0.024331,
        0.033003, 0.041667, 0.04893, 0.054435, 0.058769, 0.06087, 0.061894, 0.061798,
        0.06055, 0.058999, 0.057647, 0.055618, 0.053431, 0.050955, 0.049231, 0.047004,
        0.044747, 0.042626, 0.040888, 0.038751, 0.037294, 0.035676, 0.033739,
        0.031958, 0.030469, 0.029193, 0.02801, 0.026498, 0.025507, 0.024173, 0.022621,
        0.021574, 0.018289, 0.017154, 0.016255, 0.015184, 0.013821, 0.013536,
        0.012059, 0.011156, 0.010834, 0.009768, 0.009009, 0.008427, 0.006421,
        0.005825, 0.006073, 0.004367, 0.004082, 0.004819, 0.002398, 0.002597,
        0.002695, 0.00339, 0.003049, 0.00304, 0.003003, 0.003704, 0.003067, 0.003704,
        0.004132, 0, 0.009479, 0.02103, 0.019751, 0.018519, 0.017224, 0.016178,
        0.015609, 0.014085, 0.013172, 0.012948, 0.011752, 0.01105, 0.010181, 0.010297,
        0.00884, 0.009227, 0.009009, 0.010959, 0.016418, 0.025532, 0.037821, 0.047945,
        0.054475, 0.058683, 0.060109, 0.059701, 0.058011, 0.05524, 0.052321, 0.05,
        0.046961, 0.043593, 0.04107, 0.038228, 0.035838, 0.033466, 0.030976, 0.028852,
        0.027168, 0.025258, 0.0235, 0.021632, 0.019854, 0.018767, 0.017264, 0.016174,
        0.015328, 0.01676, 0.017937, 0.018415, 0.017802, 0.017157, 0.016393, 0.01519,
        0.014337, 0.013345, 0.012585, 0.011944, 0.011561, 0.011111, 0.010376,
        0.010189, 0.00821, 0.008547, 0.007055, 0.00947, 0.006757, 0.007109, 0.005102,
        0.005195, 0.005333, 0.005102, 0.003344, 0.003247, 0.004082, 0.003623,
        0.004367, 0.003774, 0.004098, 0.003953, 0.004049, 0.004878, 0, 0.008397,
        0.029084, 0.02352, 0.019384, 0.016098, 0.013483, 0.011322, 0.009875, 0.008867,
        0.007979, 0.007159, 0.006703, 0.006559, 0.006552, 0.006279, 0.006223,
        0.006538, 0.006897, 0.00777, 0.009808, 0.013418, 0.018786, 0.025847, 0.034037,
        0.041873, 0.049026, 0.05411, 0.05687, 0.057501, 0.05632, 0.053904, 0.050212,
        0.045835, 0.041624, 0.037508, 0.033548, 0.029898, 0.026876, 0.024272,
        0.022078, 0.020156, 0.018432, 0.017277, 0.016332, 0.015412, 0.014675,
        0.013875, 0.01332, 0.012931, 0.012428, 0.012168, 0.011606, 0.011466, 0.010989,
        0.010649, 0.010456, 0.010056, 0.009739, 0.009293, 0.008774, 0.008529,
        0.008093, 0.007784, 0.007479, 0.00695, 0.010222, 0.00775, 0.0061, 0.00562,
        0.005323, 0.004921, 0.004705, 0.004668, 0.004449, 0.004131, 0.003986, 0.00377,
        0.003486, 0.003405, 0.003264, 0.003376, 0.002861, 0.002839, 0.003252,
        0.002698, 0.002885, 0.003009, 0.0025, 0.002674, 0.003185, 0.001912, 0.002364,
        0.002849, 0.004032, 0, 0.0105, 0.027569, 0.023997, 0.020684, 0.017948,
        0.015792, 0.013558, 0.011556, 0.010008, 0.008714, 0.007407, 0.006206,
        0.005215, 0.004693, 0.004177, 0.003845, 0.004918, 0.006964, 0.01094, 0.017642,
        0.026709, 0.037415, 0.048734, 0.059349, 0.067577, 0.073238, 0.075556,
        0.074965, 0.071749, 0.066556, 0.060379, 0.053374, 0.046865, 0.040634,
        0.035275, 0.030344, 0.026246, 0.022824, 0.020224, 0.018012, 0.016415,
        0.014901, 0.01407, 0.012974, 0.012303, 0.011796, 0.011276, 0.010866, 0.010545,
        0.010465, 0.00994, 0.009791, 0.009441, 0.009159, 0.008883, 0.008619, 0.008449,
        0.008126, 0.007998, 0.007583, 0.007502, 0.007316, 0.007061, 0.007066,
        0.009956, 0.010799, 0.008316, 0.006414, 0.005786, 0.005275, 0.005222, 0.00504,
        0.00477, 0.004541, 0.00419, 0.003984, 0.003712, 0.003831, 0.00342, 0.003297,
        0.003183, 0.003273, 0.002851, 0.002442, 0.00246, 0.002062, 0.002123, 0.002373,
        0.001643, 0.001892, 0.00207, 0.001235, 0.001414, 0.00189, 0.002212, 0,
        0.008921, 0.027322, 0.025145, 0.022115, 0.019248, 0.017225, 0.014231,
        0.012322, 0.010762, 0.009479, 0.008073, 0.007194, 0.006829, 0.006383,
        0.005495, 0.005247, 0.005727, 0.007075, 0.009792, 0.015605, 0.024155,
        0.032258, 0.041314, 0.048454, 0.054665, 0.058447, 0.060606, 0.061728,
        0.060429, 0.059366, 0.057562, 0.055276, 0.053254, 0.051324, 0.048868,
        0.046663, 0.044625, 0.042871, 0.040876, 0.039098, 0.036879, 0.035582,
        0.033962, 0.032044, 0.030725, 0.029073, 0.027847, 0.026818, 0.025189,
        0.024136, 0.022857, 0.021883, 0.018413, 0.016949, 0.015924, 0.014984,
        0.013788, 0.013093, 0.012017, 0.011434, 0.010352, 0.009967, 0.008772,
        0.007958, 0.007278, 0.006791, 0.006, 0.004132, 0.004444, 0.004167, 0.002463,
        0.002451, 0.002653, 0.002755, 0.003472, 0.003145, 0.003115, 0.003846,
        0.003205, 0.003891, 0.004405, 0, 0.009363, 0.020173, 0.018927, 0.018634,
        0.01751, 0.016129, 0.01503, 0.014418, 0.013972, 0.013001, 0.011858, 0.011616,
        0.010917, 0.010056, 0.009122, 0.008909, 0.008226, 0.010512, 0.016713,
        0.025564, 0.036827, 0.048035, 0.055058, 0.059172, 0.06041, 0.05923, 0.057526,
        0.055602, 0.05283, 0.049827, 0.046527, 0.043934, 0.041087, 0.038021, 0.035482,
        0.033504, 0.030795, 0.028852, 0.026826, 0.025244, 0.023429, 0.021525,
        0.020308, 0.019054, 0.017333, 0.015873, 0.015374, 0.016655, 0.018118,
        0.018615, 0.018298, 0.016975, 0.01626, 0.015536, 0.01431, 0.013417, 0.012489,
        0.011685, 0.010941, 0.010514, 0.010158, 0.009186, 0.00885, 0.008292, 0.008606,
        0.009107, 0.007752, 0.006834, 0.007194, 0.005141, 0.005236, 0.005391,
        0.005155, 0.00339, 0.003279, 0.004149, 0.003676, 0.004444, 0.003846, 0.004184,
        0.004065, 0.004184, 0
      ),
      rep(
        c(5L, 35L, 5L, 30L, 5L, 95L, 5L, 95L, 5L, 35L, 5L, 30L, 5L, 10L, 5L, 10L, 5L, 90L, 5L, 95L),
        c(94L, 1L, 95L, 1L, 82L, 1L, 82L, 1L, 94L, 1L, 95L, 1L, 27L, 1L, 47L, 1L, 5L, 1L, 82L, 1L)
      )
    ),
    imm_int_n = rep(
      c(
        0.4, 3, 2.8, 2.6, 2.2, 2, 1.8, 1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.8, 1, 1.2, 1.6,
        1.8, 2, 2.4, 2.6, 2.8, 3, 3.2, 3, 2.8, 2.6, 2.4, 2.2, 2, 2.2, 2.4, 2.6, 2.4,
        2.2, 2, 1.8, 1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 0.8, 2.6, 2.4, 2.2, 2,
        1.8, 1.6, 1.4, 1.2, 1, 0.8, 1, 1.2, 1.6, 2.2, 2.6, 2.8, 3.2, 3.4, 3.2, 3, 2.6,
        2.2, 2, 1.6, 1.4, 1.6, 1.8, 1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 4.6,
        10.8, 10.2, 9.6, 9.4, 9, 8.8, 8.6, 8.4, 8.2, 8, 7.6, 7.4, 6.8, 6.6, 6.4, 7, 9,
        12.2, 16.8, 21.2, 25.6, 29, 31.6, 33.2, 33.8, 33.2, 32.2, 31, 29.6, 28, 26.4,
        24.8, 23.4, 22, 20.6, 19.4, 18.2, 17.2, 16.2, 15.2, 14.4, 13.6, 12.8, 12,
        11.4, 10.8, 10.2, 9.8, 9, 8.4, 7.4, 6.6, 5.8, 5, 4.2, 3.6, 3, 2.6, 2.2, 1.8,
        1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 4, 9.2, 8.4, 8, 7.8, 7.6, 7.8, 8,
        7.8, 7.4, 7.2, 7, 7.2, 9.2, 12.8, 17.4, 21.8, 25.6, 28, 29, 29.6, 29, 28.2,
        27, 25.6, 24.2, 22.6, 21.2, 19.8, 18.4, 17, 16, 14.8, 13.8, 12.8, 11.8, 11.2,
        10.4, 9.8, 9.2, 8.8, 8.4, 8, 7.6, 7.2, 7, 6.6, 6, 5.4, 5, 4.2, 3.8, 3.2, 2.8,
        2.4, 2, 1.8, 1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 0.4, 3, 2.8, 2.6, 2.2,
        2, 1.8, 1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.8, 1, 1.2, 1.6, 1.8, 2, 2.4, 2.6, 2.8,
        3, 3.2, 3, 2.8, 2.6, 2.4, 2.2, 2, 2.2, 2.4, 2.6, 2.4, 2.2, 2, 1.8, 1.6, 1.4,
        1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 0.8, 2.6, 2.4, 2.2, 2, 1.8, 1.6, 1.4, 1.2, 1,
        0.8, 1, 1.2, 1.6, 2.2, 2.6, 2.8, 3.2, 3.4, 3.2, 3, 2.6, 2.2, 2, 1.6, 1.4, 1.6,
        1.8, 1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 4.6, 10.8, 10.2, 9.8, 9.4, 9,
        8.8, 8.6, 8.4, 8.2, 8, 7.8, 7.4, 7, 6.6, 6.4, 7, 9, 12.2, 16.8, 21.4, 25.8,
        29.2, 31.8, 33.4, 34, 33.4, 32.4, 31.2, 29.6, 28.2, 26.6, 25, 23.6, 22, 20.8,
        19.4, 18.4, 17.2, 16.2, 15.4, 14.6, 13.8, 12.8, 12.2, 11.6, 11, 10.4, 9.8,
        9.2, 8.4, 7.6, 6.6, 5.8, 5, 4.2, 3.6, 3, 2.6, 2.2, 1.8, 1.6, 1.4, 1.2, 1, 0.8,
        0.6, 0.4, 0.2, 0, 3.6, 9.2, 8.6, 8.2, 7.8, 7.6, 7.8, 8, 7.8, 7.6, 7.2, 9.2,
        13, 17.6, 22, 25.6, 28, 29.4, 29.8, 29, 28.2, 27, 25.6, 24.2, 22.8, 21.2,
        19.8, 18.6, 17.2, 16, 14.8, 13.8, 12.8, 12, 11.2, 10.6, 9.8, 9.4, 8.8, 8.4, 8,
        7.6, 7.4, 7, 6.6, 6, 5.6, 5, 4.4, 3.8, 3.2, 2.8, 2.4, 2, 1.8, 1.6, 1.4, 1.2,
        1, 0.8, 0.6, 0.4, 0.2, 0
      ),
      rep(
        c(
          5L, 10L, 5L, 10L, 5L, 10L, 5L, 25L, 5L, 10L, 15L, 5L, 10L, 5L, 15L, 20L, 10L,
          25L, 20L, 25L, 40L, 45L, 5L, 10L, 5L, 10L, 5L, 10L, 15L, 5L, 10L, 5L, 10L, 5L,
          10L, 5L, 10L, 35L, 30L, 20L, 30L, 20L, 30L, 25L, 50L, 40L, 5L, 10L, 5L, 10L,
          5L, 10L, 5L, 10L, 20L, 30L, 100L, 5L, 10L, 15L, 5L, 10L, 5L, 15L, 10L, 35L,
          70L, 40L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 25L, 5L, 10L, 15L, 5L, 10L, 5L, 15L,
          20L, 10L, 25L, 20L, 25L, 40L, 45L, 5L, 10L, 5L, 10L, 5L, 10L, 15L, 5L, 10L,
          5L, 10L, 5L, 10L, 5L, 10L, 35L, 30L, 20L, 30L, 20L, 30L, 25L, 50L, 40L, 5L,
          10L, 5L, 10L, 5L, 10L, 5L, 10L, 20L, 30L, 100L, 5L, 15L, 5L, 15L, 10L, 5L,
          20L, 5L, 10L, 15L, 30L, 70L, 40L
        ),
        c(
          1L, 1L, 9L, 1L, 1L, 1L, 8L, 1L, 2L, 4L, 1L, 2L, 2L, 1L, 3L, 1L, 1L, 2L, 1L,
          1L, 1L, 1L, 1L, 1L, 3L, 1L, 3L, 1L, 1L, 1L, 1L, 4L, 2L, 2L, 1L, 2L, 2L, 1L,
          1L, 1L, 1L, 3L, 1L, 1L, 1L, 1L, 8L, 1L, 1L, 1L, 14L, 1L, 40L, 1L, 1L, 1L, 1L,
          4L, 1L, 2L, 5L, 1L, 48L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 9L, 1L, 1L, 1L, 8L, 1L,
          2L, 4L, 1L, 2L, 2L, 1L, 3L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 3L, 1L, 3L,
          1L, 1L, 1L, 1L, 4L, 2L, 2L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 3L, 1L, 1L, 1L, 1L,
          8L, 1L, 1L, 1L, 14L, 1L, 40L, 1L, 1L, 1L, 1L, 4L, 1L, 1L, 1L, 1L, 2L, 1L, 47L,
          2L, 1L, 1L, 1L, 1L
        )
      )
    ),
    imm_nat_n = rep(
      c(
        7.6, 21.4, 17.4, 14.4, 11.6, 9.2, 7.4, 6.4, 5, 4.4, 4, 3.6, 3.4, 3.2, 3.4,
        3.6, 4.2, 5, 6.4, 8.6, 12, 16.2, 20.8, 24, 27.2, 29.4, 31.8, 32.6, 31.8, 31.4,
        29, 27.6, 25.2, 24, 21.8, 20.2, 18.4, 16.8, 15.2, 13.8, 12.8, 11.8, 11, 10.8,
        10.4, 10.2, 10, 9.8, 9.6, 9.4, 8.8, 8.2, 7.8, 7.4, 7, 6.8, 6.6, 6.4, 6.8, 7.4,
        5.4, 4.6, 4, 3.6, 3.2, 3, 2.8, 2.6, 2.2, 2, 1.8, 1.6, 1.2, 1, 0.8, 0.6, 0.4,
        0.2, 0, 10.4, 17.6, 16.4, 14.4, 12.2, 10.2, 8.6, 7.2, 6.2, 5.4, 4.8, 4.4, 4.2,
        4, 3.8, 4.2, 5, 6.2, 9, 13.4, 19.6, 26.2, 32.6, 36.2, 39, 41.2, 42.6, 41.4,
        39.4, 36, 33.4, 29.4, 27, 23.8, 21, 18.4, 17.2, 15.4, 14.4, 13, 11.8, 11,
        10.6, 9.8, 9.6, 9.4, 9, 9.2, 9, 9.2, 9, 8.6, 8.4, 7.8, 7.4, 7, 6.6, 6.2, 5.8,
        7.2, 6.6, 6, 5.2, 4.4, 4.2, 3.8, 3.6, 3.4, 3, 2.8, 2.6, 2.4, 2, 1.8, 1.6, 1.4,
        1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 2.4, 7, 7.2, 6.4, 5.6, 4.8, 4, 3.6, 3, 2.8,
        2.4, 2.2, 1.8, 1.4, 1.2, 1, 1.4, 1.8, 3.2, 4.6, 6.6, 8.8, 10.6, 12.8, 14.8,
        17.2, 19.2, 20.6, 22.2, 22.4, 23.2, 23, 23.2, 22.2, 21.2, 20.6, 19.4, 18.8,
        16.8, 16, 15, 14, 13, 12.4, 11.2, 11, 10.4, 9.8, 9.4, 8.8, 8.4, 8, 7.2, 7, 6,
        4.8, 4.2, 3.8, 3.2, 2.8, 2.4, 2, 1.8, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 1.8, 6.2,
        6, 5.4, 4.6, 4.2, 3.8, 3.4, 3.2, 3, 2.8, 2.6, 2.4, 2.2, 2, 2.2, 2.8, 3.4, 5,
        7, 8.6, 10.4, 11.8, 12.8, 14, 15.4, 16.2, 16.6, 16.8, 16.6, 15.6, 15, 14.6,
        13.8, 12.6, 12, 11.2, 10.4, 9.2, 8.6, 8, 7.4, 6.8, 6.6, 6.2, 5.8, 5.6, 5.2, 5,
        4.6, 4.2, 4, 3.4, 2.8, 2.6, 2.2, 2, 1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0,
        7.4, 21.4, 17.6, 14.2, 11.6, 9.4, 7.8, 6.4, 5.2, 4.4, 4, 3.6, 3.4, 3.6, 4, 5,
        6.2, 8.8, 11.8, 16, 20.4, 24.4, 26.6, 29, 30.4, 32.2, 33, 32.6, 31.2, 30,
        27.6, 25.8, 23.6, 22.2, 20.4, 18.8, 17, 15.6, 14.2, 12.8, 12, 11, 10.4, 10.2,
        9.8, 9.6, 9.4, 9.6, 9.4, 9, 8.6, 8, 7.6, 7.4, 7.2, 7, 6.6, 7, 7.8, 5.6, 4.6,
        4.2, 3.6, 3.4, 3, 2.8, 2.6, 2.4, 2.2, 2, 1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2,
        0, 11.6, 17.6, 16.4, 14.2, 12.2, 10.4, 8.8, 7.2, 6.2, 5.4, 5, 4.4, 4.2, 4,
        4.4, 5, 6.2, 8.4, 13.2, 19.4, 25.8, 31.4, 36.6, 39, 40.2, 41, 41.6, 39.2, 37,
        33.6, 30.6, 26.6, 24.4, 21.2, 19, 16.8, 16, 14, 13.2, 12, 11, 10.2, 9.8, 9.2,
        8.8, 9, 8.8, 9, 8.6, 8.4, 8.2, 7.6, 7.2, 6.8, 6.2, 5.8, 6, 7.4, 7, 6.2, 5.2,
        4.6, 4, 3.8, 3.4, 3.2, 2.8, 2.6, 2.4, 2.2, 2, 1.8, 1.6, 1.4, 1.2, 1, 0.8, 0.6,
        0.4, 0.2, 0, 2.6, 7.8, 6.6, 6.4, 5.8, 5, 4.2, 3.6, 3.2, 2.8, 2.4, 2.2, 1.8,
        1.6, 1.2, 1, 1.2, 1.4, 2, 3, 4.6, 6.6, 8.8, 11.2, 12.8, 15, 16.8, 18.8, 20.6,
        21.8, 22.8, 23.2, 23.6, 23.2, 22.8, 21.6, 20.4, 20, 18.6, 18, 16.2, 15.4,
        14.4, 13.4, 12.6, 11.8, 10.8, 10.6, 9.8, 9.4, 9, 8.6, 7.6, 6.8, 6.4, 5.2, 4.4,
        4, 3.6, 3, 2.4, 2, 1.8, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 1.8, 6.8, 5.8, 5.4, 5,
        4.2, 3.8, 3.4, 3.2, 3, 2.8, 2.6, 2.4, 2.2, 2, 2.2, 3, 3.4, 5, 7, 8.8, 10.4,
        11.6, 12.6, 13.4, 14.6, 16, 16.6, 16.8, 16.6, 16.2, 15.2, 14.4, 13.8, 13,
        11.8, 11.2, 10.6, 9.8, 8.8, 8.2, 7.8, 7.2, 6.6, 6.2, 6, 5.8, 5.4, 5, 4.8, 4.4,
        4.2, 4, 3.8, 3, 2.8, 2.4, 2.2, 1.8, 1.6, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0
      ),
      rep(
        c(
          5L, 10L, 5L, 10L, 5L, 15L, 10L, 5L, 10L, 25L, 45L, 5L, 10L, 5L, 10L, 5L, 10L,
          5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 15L, 10L, 30L, 5L, 10L, 5L, 10L, 5L, 10L,
          5L, 10L, 40L, 10L, 100L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 25L, 10L,
          50L, 85L, 5L, 10L, 5L, 25L, 5L, 10L, 30L, 40L, 5L, 15L, 5L, 10L, 5L, 10L, 5L,
          10L, 5L, 10L, 5L, 10L, 15L, 10L, 30L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 15L, 35L,
          10L, 100L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 25L, 15L, 45L, 85L
        ),
        c(
          14L, 1L, 12L, 1L, 17L, 1L, 2L, 25L, 4L, 1L, 1L, 15L, 1L, 33L, 3L, 6L, 1L, 11L,
          1L, 3L, 1L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 14L, 1L, 16L, 1L, 30L, 1L, 3L, 1L, 1L,
          1L, 1L, 13L, 2L, 30L, 1L, 5L, 1L, 7L, 1L, 2L, 1L, 1L, 1L, 1L, 11L, 3L, 30L,
          1L, 29L, 3L, 1L, 1L, 13L, 1L, 29L, 2L, 2L, 3L, 15L, 2L, 7L, 1L, 1L, 1L, 1L,
          2L, 1L, 34L, 1L, 17L, 1L, 9L, 1L, 3L, 1L, 1L, 1L, 1L, 9L, 1L, 4L, 1L, 31L, 1L,
          13L, 1L, 2L, 1L, 1L, 1L, 1L
        )
      )
    ),
    acq = rep(
      c(
        0, 0.023466, 0.012683, 0.015564, 0.015817, 0.016457, 0.017258, 0.016304,
        0.017274, 0.01848, 0.021921, 0.027505, 0.03212, 0.037363, 0.040667, 0.044268,
        0.041958, 0.039807, 0.034749, 0.03253, 0.027981, 0.022002, 0.01864, 0.013252,
        0.011089, 0.007463, 0.007905, 0.007457, 0.008427, 0.008563, 0.010131,
        0.011765, 0.012921, 0.014623, 0.015924, 0.016923, 0.017562, 0.017996,
        0.018128, 0.018173, 0.018299, 0.018114, 0.016757, 0.016593, 0.01627, 0.015235,
        0.014907, 0.014303, 0.01388, 0.013734, 0.012087, 0.011976, 0.011421, 0.011104,
        0.010165, 0.009103, 0.0094, 0.008943, 0.00846, 0.008613, 0.007099, 0.007584,
        0.007326, 0.006435, 0.007022, 0.006421, 0.003883, 0.004049, 0.004367,
        0.004082, 0.004819, 0.004796, 0.002597, 0.002695, 0.00339, 0.003049, 0.00304,
        0.003003, 0.003704, 0.003067, 0.003704, 0.004132, 0, 0.014218, 0.015773,
        0.016632, 0.017544, 0.018237, 0.016178, 0.016649, 0.018109, 0.018661, 0.01992,
        0.020299, 0.022099, 0.024887, 0.033181, 0.040884, 0.051903, 0.059202,
        0.058904, 0.053731, 0.048227, 0.040847, 0.031507, 0.02594, 0.023952, 0.022951,
        0.021322, 0.019337, 0.017872, 0.016212, 0.016429, 0.015884, 0.017173,
        0.018046, 0.018204, 0.019653, 0.02042, 0.019871, 0.020196, 0.020809, 0.021814,
        0.022263, 0.021632, 0.02184, 0.022118, 0.021248, 0.020394, 0.019708, 0.018855,
        0.018685, 0.016813, 0.016254, 0.015523, 0.014754, 0.012658, 0.011649,
        0.012456, 0.010649, 0.009772, 0.009249, 0.007778, 0.006485, 0.007278,
        0.006568, 0.003419, 0.003527, 0.003788, 0.002252, 0.00237, 0.002551, 0.002597,
        0.002667, 0.002551, 0.003344, 0, 0.020517, 0.014572, 0.014507, 0.015385,
        0.016623, 0.016268, 0.017078, 0.016114, 0.016143, 0.018009, 0.0222, 0.027749,
        0.032195, 0.03617, 0.040659, 0.041973, 0.041237, 0.037736, 0.034272, 0.029909,
        0.027778, 0.021505, 0.016949, 0.012371, 0.010368, 0.009132, 0.007576,
        0.007988, 0.00823, 0.009747, 0.009798, 0.011287, 0.012842, 0.014524, 0.015667,
        0.016461, 0.01706, 0.017241, 0.018304, 0.018005, 0.017544, 0.017638, 0.018056,
        0.016173, 0.016575, 0.015652, 0.014537, 0.014233, 0.013111, 0.013224,
        0.011742, 0.011429, 0.011273, 0.010794, 0.01043, 0.009554, 0.008469, 0.008708,
        0.008183, 0.007725, 0.007916, 0.007246, 0.006645, 0.006266, 0.006631,
        0.005822, 0.006791, 0.004, 0.004132, 0.004444, 0.004167, 0.004926, 0.002451,
        0.002653, 0.002755, 0.003472, 0.003145, 0.003115, 0.003846, 0.003205,
        0.003891, 0.004405, 0, 0.014981, 0.01633, 0.015773, 0.017598, 0.016537,
        0.016129, 0.016032, 0.017508, 0.018962, 0.018418, 0.019763, 0.021119,
        0.024017, 0.031285, 0.039909, 0.050111, 0.056404, 0.059133, 0.052925, 0.04812,
        0.03966, 0.030568, 0.025608, 0.023669, 0.022654, 0.020731, 0.019175, 0.017692,
        0.015849, 0.016609, 0.016183, 0.016393, 0.017067, 0.018105, 0.018924,
        0.019307, 0.020157, 0.019619, 0.020548, 0.021228, 0.021143, 0.021525,
        0.020923, 0.021025, 0.020667, 0.020503, 0.019567, 0.018827, 0.017422,
        0.016381, 0.015911, 0.01466, 0.013821, 0.012265, 0.011785, 0.011628, 0.009813,
        0.009737, 0.008753, 0.008178, 0.006772, 0.006562, 0.0059, 0.006633, 0.003442,
        0.003643, 0.001938, 0.002278, 0.002398, 0.002571, 0.002618, 0.002695,
        0.002577, 0
      ),
      rep(
        c(1010L, 5L, 10L, 5L, 95L, 5L, 1150L, 5L, 10L, 5L, 90L, 5L, 140L),
        c(1L, 5L, 1L, 75L, 1L, 73L, 1L, 76L, 1L, 5L, 1L, 73L, 1L)
      )
    ),
    emi_nat_n = rep(
      c(
        4.2, 14.6, 12.2, 9.8, 8.4, 7.2, 6, 5.2, 4.6, 4.2, 3.6, 3.2, 3.4, 3.8, 5.4,
        7.4, 10.6, 15.2, 20.6, 24, 28.6, 33, 35.6, 35.2, 34.6, 32.8, 29.8, 26.8, 25.2,
        21.8, 20.8, 18, 16.4, 14.8, 13.4, 11.8, 10.6, 10, 8.8, 8.6, 9, 8.4, 8.6, 8.8,
        9, 9.4, 9.2, 9, 8.8, 8.2, 7.8, 7.4, 6.6, 6.4, 5.8, 5.6, 5.2, 4.8, 6.8, 5, 3.8,
        3.2, 3, 2.8, 2.4, 2, 1.8, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 5, 13.2, 11.8,
        10.6, 9, 7.6, 6.4, 5.8, 4.8, 4.4, 3.4, 3, 2.4, 2.2, 1.8, 2, 2.2, 3.4, 5.4, 9,
        14, 19.6, 27, 33.6, 38.8, 42.8, 43.2, 46.8, 43, 40.6, 35.6, 32.2, 28.2, 24.2,
        20.6, 18, 16, 14.6, 12.8, 10.8, 9.8, 8.6, 8.2, 7.4, 7.2, 7, 7.2, 7.6, 7.8, 8,
        7.8, 7.6, 7.2, 6.8, 6.4, 6.2, 5.8, 5.6, 5.4, 5, 7, 7.2, 5.4, 4.4, 3.6, 3.4, 3,
        2.8, 2.6, 2.4, 2.2, 2, 1.8, 1.6, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 2, 5.6, 5.2,
        5, 4, 3.4, 3, 2.8, 2.2, 1.8, 1.6, 1.4, 1.2, 1, 1.2, 1.6, 2.6, 4, 6, 7.6, 9.6,
        10.8, 12.6, 15.4, 16.6, 17.6, 19.8, 19.6, 19.8, 19, 19.2, 18.2, 18.4, 17.4,
        16.2, 14.4, 14, 13.2, 12.2, 11, 10, 9.4, 8.4, 7.8, 7.6, 6.8, 5.6, 5.4, 5, 4.2,
        3.4, 3.2, 2.8, 2.2, 2, 1.6, 1.4, 1.2, 0.8, 0.6, 0.4, 0.2, 0, 2, 4, 3.8, 3.4,
        3.2, 3, 2.8, 2.4, 2.6, 2.2, 2, 1.8, 1.6, 1.4, 1.6, 2.2, 3.6, 5, 7, 8.4, 9.8,
        11, 11.2, 12.6, 13.6, 14.2, 14, 13.6, 13.2, 12.6, 12.4, 11.8, 10.6, 10, 9.4,
        8.8, 7.6, 7, 6, 5.6, 5.2, 4.6, 4.2, 4.8, 4.6, 4.2, 4, 3.6, 3.2, 3, 2.6, 2.2,
        2, 1.6, 1.4, 1, 0.8, 1, 0.6, 0.4, 0.2, 0, 4.2, 14.6, 12, 10.2, 8.4, 7.2, 6.2,
        5.2, 4.6, 4.2, 3.8, 3.4, 3.2, 3.4, 3.6, 4, 5, 7.6, 10.4, 14.8, 20, 25.4, 28.2,
        31.6, 34.6, 35.8, 34.4, 33, 30.8, 27.4, 24.6, 23, 19.8, 18.8, 16.4, 15, 13.6,
        12.4, 11, 10, 9.6, 8.6, 8.4, 8.6, 8.2, 8.4, 8.6, 8.8, 8.6, 9.2, 9, 8.8, 8.6,
        8, 7.6, 7, 6.4, 6, 5.6, 5.4, 4.8, 7, 5, 3.8, 3.4, 3, 2.8, 2.6, 2.4, 2.2, 2,
        1.8, 1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 5, 13.2, 11.6, 10.4, 9.2, 8,
        6.6, 5.6, 5, 4.2, 3.8, 3, 2.6, 2.2, 2, 1.8, 2.4, 3.4, 5.4, 8.8, 13.6, 19.8,
        25.8, 33.2, 38.6, 42.2, 44.2, 43, 44.8, 40, 37, 31.8, 28.4, 24.6, 21.2, 18,
        15.8, 14, 13, 11.6, 10, 9, 8.2, 7.8, 7.2, 7, 6.8, 7, 7.6, 7.8, 7.6, 7.4, 7,
        6.6, 6.2, 6, 5.6, 5.4, 7.2, 7.6, 5.6, 4.2, 3.8, 3.2, 3, 2.8, 2.6, 2.4, 2.2, 2,
        1.6, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 2, 6, 5.2, 4.6, 4.4, 3.6, 3, 2.6,
        2.4, 2, 1.6, 1.4, 1.2, 1, 1.2, 1.6, 2.4, 4, 5.4, 7.8, 9.4, 11.6, 12.8, 14.4,
        17, 18, 18.6, 20.6, 20.4, 19.8, 19, 18.6, 17.6, 17.8, 16.8, 15.6, 13.8, 13.4,
        12.6, 11.6, 10.6, 9.6, 9, 8, 7.4, 7.2, 6.6, 5.8, 5.2, 5, 4.6, 3.8, 3.2, 2.8,
        2.6, 2, 1.8, 1.4, 1.2, 1, 0.8, 0.6, 0.4, 0.2, 0, 2, 4.2, 3.6, 3.2, 3, 2.8,
        2.4, 2.2, 2, 1.8, 1.6, 1.4, 1.6, 2.4, 3.4, 5.2, 6.6, 8.6, 10, 11.2, 12, 13.2,
        14, 14.4, 13.8, 13.4, 13, 12.6, 12, 11.8, 11, 10, 9.4, 8.8, 8.2, 7, 6.6, 5.8,
        5.2, 4.8, 4.4, 4.6, 5.2, 5, 4.6, 4.4, 4, 3.8, 3.4, 3, 2.8, 2.4, 2, 1.8, 1.4,
        1.2, 1, 0.8, 0.6, 0.4, 0.2, 0
      ),
      rep(
        c(
          5L, 10L, 25L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 15L, 5L, 15L, 20L, 35L,
          5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 15L, 10L, 15L, 20L, 30L, 5L, 20L,
          5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 15L, 55L, 95L, 5L, 10L, 5L, 10L,
          5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 20L, 50L, 95L, 5L, 10L, 15L, 5L,
          10L, 5L, 10L, 5L, 15L, 20L, 35L, 5L, 10L, 5L, 15L, 5L, 10L, 5L, 10L, 5L, 10L,
          5L, 10L, 5L, 10L, 5L, 10L, 15L, 20L, 30L, 5L, 10L, 5L, 15L, 5L, 10L, 5L, 10L,
          5L, 15L, 60L, 90L, 5L, 15L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 15L, 5L,
          10L, 20L, 45L, 95L
        ),
        c(
          10L, 1L, 1L, 32L, 1L, 1L, 1L, 16L, 2L, 1L, 1L, 2L, 1L, 1L, 1L, 2L, 1L, 42L,
          1L, 5L, 1L, 1L, 2L, 16L, 1L, 5L, 1L, 1L, 2L, 1L, 1L, 1L, 13L, 1L, 12L, 1L, 3L,
          1L, 10L, 1L, 3L, 1L, 13L, 1L, 1L, 1L, 1L, 2L, 1L, 8L, 2L, 15L, 1L, 14L, 2L,
          7L, 1L, 2L, 1L, 2L, 1L, 1L, 1L, 1L, 11L, 1L, 1L, 38L, 1L, 15L, 1L, 8L, 3L, 1L,
          1L, 43L, 1L, 4L, 1L, 1L, 2L, 5L, 1L, 5L, 1L, 5L, 1L, 2L, 1L, 1L, 1L, 2L, 1L,
          1L, 11L, 1L, 1L, 1L, 15L, 2L, 11L, 1L, 19L, 1L, 1L, 1L, 2L, 1L, 2L, 2L, 3L,
          1L, 9L, 1L, 32L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L
        )
      )
    ),
    mig_nat_n = rep(
      c(
        3.4, 6.8, 5.2, 4.6, 3.2, 2, 1.4, 1.2, 0.4, 0.2, 0.4, 0, 0.2, 0, 0.2, 0.4, 0.8,
        1.2, 1, 1.2, 1.4, 1, 0.2, 0, -1.4, -3.6, -3.8, -2.6, -2, -1, 1.6, 2.2, 2.4,
        3.4, 3.2, 3.8, 3.6, 3.4, 3.2, 2.8, 3, 2.4, 1.8, 2, 1.6, 1.4, 1.2, 1, 0.6, 0.4,
        0.8, 0.6, 1, 1.2, 2, 0.6, 0.4, 0.8, 0.6, 0.4, 0.2, 0.4, 0.2, 0, 0.2, 0, -0.2,
        0, -0.2, 0, -0.2, 0, -0.2, 0, 5.4, 4.4, 4.6, 3.8, 3.2, 2.6, 2.2, 1.4, 1, 1.4,
        1.8, 2, 2.2, 2, 1.6, 0.8, 0, -0.6, 0, -0.8, -1, -2.6, -3.8, -2, -4.2, -1.6,
        -1.2, 0.4, 1.2, 2.8, 3.2, 3, 2.4, 2.6, 3.6, 3.2, 2.8, 2.4, 1.8, 1.6, 1.2, 1.4,
        1.2, 1, 1.2, 1, 0.8, 0.6, 0.4, 0.8, 0.2, -0.6, 0.6, 0.8, 0.4, 0.6, 0.4, 0.6,
        0.4, 0.6, 0.4, 0.2, 0.4, 0.2, 0, 0.2, 0, 0.4, 1.4, 2, 1.4, 1.6, 1.4, 1, 0.8,
        1, 0.8, 0.6, 0.4, 0.2, 0, 0.2, 0.6, 1.2, 1, 2, 2.2, 1.8, 2.6, 3, 2.4, 2.6,
        3.6, 3.2, 4, 3, 2.2, 2, 2.6, 2.4, 2, 1.8, 2, 2.4, 1.8, 1.6, 2, 1.8, 2, 1.6,
        2.4, 1.8, 2, 1.8, 1.4, 1, 0.8, 0.6, 1, 0.6, 0.4, 0.2, 0, -0.2, 0, -0.2, 2.2,
        1.6, 1.2, 1, 0.8, 0.6, 0.8, 0.4, 0.6, 0.4, 0.6, 0.4, 0.6, -0.2, 0, 0.2, 0.6,
        0.8, 1.6, 1.4, 1.8, 2, 2.6, 3.2, 3.4, 2.4, 2.2, 2, 1.8, 1.6, 2, 1.8, 1.6, 2,
        1, 0.6, 0.8, 0.6, 0.8, 1, 0.8, 0.6, 0.2, 0.4, 0.2, 0.4, 0.2, 0.4, 0, 0.2, 0,
        0.2, 0, 0.2, 0, 3.2, 6.8, 5.6, 4, 3.2, 2.2, 1.6, 1.2, 0.6, 0.2, 0.4, 0.2, 0.4,
        1, 1.2, 1.4, 1.2, 0.4, -1, -1.6, -2.6, -4.2, -3.6, -1.4, -0.4, 0.4, 2.6, 3,
        2.8, 3.8, 3.4, 4, 3.8, 3.4, 3.2, 2.8, 2.4, 2, 1.6, 1.4, 1.2, 1, 1.2, 0.4, 0.8,
        0.6, 0.4, 0.6, 0.4, 0.6, 1, 1.2, 1.4, 1.2, 2.2, 0.8, 0.6, 0.8, 0.6, 0.4, 0.2,
        0, -0.2, 0, -0.2, 0, -0.2, 0, 6.6, 4.4, 4.8, 3.8, 3, 2.4, 2.2, 1.6, 1.2, 1.4,
        1.6, 1.8, 2, 2.2, 2, 1.6, 0.8, -0.4, 0, -1.8, -2, -3.2, -4, -2, -3.2, -0.8, 0,
        1.8, 2.2, 2, 3.2, 2.8, 3, 2.4, 3.2, 3, 2.8, 2.4, 2, 2.2, 2, 1.8, 1.4, 1.2,
        1.4, 1.2, 1, 1.2, 1, 0.8, 0.6, 0.4, 0.6, 0.2, -0.6, 0.6, 1, 0.8, 0.6, 0.4,
        0.6, 0.4, 0.6, 0.4, 0.6, 0.4, 0.2, 0, 0.6, 1.8, 1.4, 1.8, 1.4, 1.2, 1, 0.8,
        0.4, 0.2, 0, 0.2, 0.4, 0.6, 1.2, 1, 1.8, 1.2, 2.2, 2.4, 1.8, 2.6, 3.2, 2.2,
        2.8, 3.8, 3.4, 3.8, 3, 2.8, 2.2, 1.8, 2.4, 2, 1.8, 2, 2.2, 1.8, 1.6, 1.8, 2,
        1.8, 2, 1.8, 2.4, 1.8, 1.4, 1.2, 1, 0.6, 0.8, 0.4, 0.2, 0.4, 0.2, 0, -0.2, 0,
        -0.2, 2.6, 2.2, 1.8, 1.4, 1, 0.8, 0.6, 0.4, 0.6, 0.4, 0.6, 0, -0.2, 0.4, 0.2,
        0.4, 0.6, 1.4, 2, 2.2, 3, 3.2, 2.6, 2.4, 2, 1.8, 1.6, 1.8, 1.6, 2, 1.8, 1.4,
        0.6, 0.8, 0.6, 0.8, 0.6, 0.8, 1, 0.6, 0.8, 0.6, 0.4, 0.2, 0, 0.2, 0, 0.2, 0,
        0.2, 0
      ),
      rep(
        c(
          5L, 10L, 5L, 10L, 5L, 10L, 5L, 30L, 10L, 5L, 10L, 5L, 10L, 5L, 15L, 5L, 15L,
          5L, 15L, 5L, 15L, 10L, 35L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L,
          20L, 5L, 15L, 10L, 5L, 10L, 5L, 30L, 15L, 10L, 5L, 25L, 5L, 10L, 40L, 5L, 10L,
          5L, 10L, 5L, 10L, 5L, 10L, 15L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 15L, 10L, 5L,
          10L, 50L, 10L, 5L, 95L, 5L, 10L, 5L, 15L, 5L, 15L, 5L, 10L, 5L, 10L, 5L, 15L,
          5L, 15L, 5L, 10L, 15L, 5L, 10L, 5L, 10L, 5L, 30L, 40L, 10L, 85L, 5L, 30L, 5L,
          10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 25L, 30L, 5L, 25L, 15L,
          5L, 35L, 5L, 15L, 5L, 15L, 5L, 15L, 5L, 10L, 5L, 20L, 5L, 10L, 5L, 10L, 5L,
          10L, 5L, 10L, 5L, 15L, 25L, 35L, 40L, 5L, 10L, 5L, 20L, 10L, 5L, 10L, 5L, 10L,
          5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 15L, 5L, 15L, 10L, 5L, 35L, 10L,
          90L, 5L, 30L, 5L, 15L, 5L, 10L, 5L, 10L, 5L, 10L, 5L, 10L, 15L, 5L, 10L, 5L,
          10L, 5L, 10L, 5L, 15L, 10L, 20L, 15L, 5L, 10L, 35L, 10L, 85L
        ),
        c(
          14L, 1L, 20L, 1L, 1L, 1L, 10L, 1L, 1L, 2L, 1L, 4L, 1L, 4L, 1L, 2L, 1L, 1L, 1L,
          2L, 1L, 2L, 1L, 7L, 1L, 1L, 2L, 17L, 1L, 4L, 1L, 1L, 1L, 1L, 1L, 4L, 1L, 1L,
          1L, 2L, 6L, 1L, 1L, 1L, 7L, 1L, 1L, 1L, 1L, 7L, 1L, 1L, 1L, 2L, 1L, 1L, 1L,
          1L, 11L, 2L, 5L, 1L, 4L, 1L, 8L, 1L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 7L,
          1L, 3L, 1L, 1L, 1L, 10L, 1L, 1L, 1L, 1L, 1L, 3L, 1L, 1L, 2L, 1L, 3L, 1L, 9L,
          1L, 1L, 1L, 1L, 9L, 1L, 4L, 1L, 19L, 1L, 1L, 1L, 1L, 1L, 4L, 1L, 13L, 2L, 1L,
          1L, 1L, 2L, 1L, 1L, 1L, 1L, 8L, 1L, 8L, 1L, 12L, 1L, 7L, 1L, 7L, 1L, 1L, 1L,
          8L, 1L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 4L, 1L, 2L, 1L, 1L, 2L, 1L, 1L,
          1L, 13L, 1L, 4L, 1L, 1L, 1L, 10L, 1L, 1L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 1L,
          9L, 1L, 1L, 1L, 4L, 1L, 1L, 1L, 3L, 1L, 2L, 1L, 1L, 3L, 2L, 2L, 1L, 4L, 1L,
          3L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L
        )
      )
    ),
    mig_sub = rep(c(-0.1253, -0.1794, -0.1924, 0.0434, 0.4537), 808),
  )


  ## FSO population with fictitious subregions ----
  # fso_population |>
  #   dplyr::rename(n_tot = n) |>
  #   # duplicating rows 5 times
  #   tidyr::uncount(5) |>
  #   # create 5 subregions
  #   dplyr::mutate(spatial_unit = rep(1:5, times = nrow(fso_population))) |>
  #   dplyr::mutate(
  #     # Create fictitious n
  #     n = dplyr::case_match(
  #       spatial_unit,
  #       1 ~ round(n_tot * 0.3),
  #       2 ~ round(n_tot * 0.25),
  #       3 ~ round(n_tot * 0.2),
  #       4 ~ round(n_tot * 0.15),
  #       # 5 ~ round(n_tot * 0.1),
  #       .default = NA
  #     ),
  #     .keep = "all"
  #   ) |>
  #   # create region 5 by subtracting sum of 1:4 from original n to get exact same n
  #   # (avoid rounding errors)
  #   ## get sum of regions 1-4
  #   dplyr::mutate(sum = sum(n, na.rm = TRUE), .by=c(year,nat,sex,age)) |>
  #   ## compute region 5
  #   dplyr::mutate(
  #     n = dplyr::case_match(
  #       spatial_unit,
  #       5 ~ (n_tot - sum),
  #       .default = n
  #     )) |>
  #   dplyr::mutate(spatial_unit = as.character(spatial_unit)) |>
  #   dplyr::select(-n_tot, -sum) |>
  #   # dplyr::filter(age < 51) |>
  #   constructive::construct()

  population_short_5r <- tibble::tibble(
    year = rep("2018", 2020L),
    spatial_unit = rep(c("1", "2", "3", "4", "5"), 404),
    nat = rep(c("ch", "int"), each = 1010L),
    sex = rep(rep(c("m", "f"), 2), each = 505L),
    age = rep(rep(seq(0, 100, by = 1), 4), each = 5L),
    n = c(
      752, 626, 501, 376, 251, 777, 647, 518, 388, 259, 770, 642, 514, 385, 257,
      790, 659, 527, 395, 264, 813, 678, 542, 406, 271, 782, 652, 522, 391, 261,
      771, 642, 514, 385, 257, 783, 653, 522, 392, 261, 790, 658, 527, 395, 264,
      754, 628, 502, 377, 251, 769, 641, 513, 385, 256, 723, 603, 482, 362, 241,
      754, 628, 503, 377, 252, 759, 633, 506, 380, 253, 768, 640, 512, 384, 255,
      771, 643, 514, 386, 257, 760, 634, 507, 380, 254, 754, 629, 503, 377, 252,
      840, 700, 560, 420, 279, 822, 685, 548, 411, 273, 851, 709, 567, 426, 284,
      875, 729, 583, 437, 292, 906, 755, 604, 453, 302, 860, 716, 573, 430, 286,
      876, 730, 584, 438, 292, 916, 763, 610, 458, 305, 938, 781, 625, 469, 312,
      917, 764, 612, 459, 306, 918, 765, 612, 459, 306, 917, 764, 611, 459, 306,
      889, 741, 593, 444, 296, 877, 731, 585, 438, 292, 909, 758, 606, 455, 303,
      872, 726, 581, 436, 291, 930, 775, 620, 465, 309, 900, 750, 600, 450, 301,
      911, 759, 607, 456, 304, 909, 757, 606, 454, 303, 908, 756, 605, 454, 303,
      881, 734, 587, 440, 294, 854, 712, 569, 427, 285, 869, 724, 579, 435, 290,
      824, 687, 549, 412, 275, 847, 706, 565, 424, 282, 920, 766, 613, 460, 307,
      914, 762, 609, 457, 304, 966, 805, 644, 483, 321, 1030, 859, 687, 515, 344,
      1078, 899, 719, 539, 360, 1107, 922, 738, 553, 369, 1200, 1000, 800, 600, 401,
      1225, 1021, 817, 613, 408, 1237, 1031, 825, 619, 412, 1261, 1051, 841, 630,
      420, 1282, 1069, 855, 641, 428, 1233, 1027, 822, 616, 411, 1229, 1024, 819,
      614, 410, 1199, 1000, 800, 600, 399, 1128, 940, 752, 564, 377, 1116, 930, 744,
      558, 373, 1083, 903, 722, 542, 361, 1088, 907, 725, 544, 363, 1042, 868, 694,
      521, 347, 1032, 860, 688, 516, 345, 977, 814, 651, 488, 326, 944, 786, 629,
      472, 315, 916, 763, 611, 458, 305, 854, 711, 569, 427, 284, 863, 719, 575,
      431, 288, 839, 699, 559, 420, 280, 847, 706, 565, 424, 282, 821, 684, 548,
      411, 274, 813, 677, 542, 406, 271, 767, 639, 511, 384, 256, 732, 610, 488,
      366, 243, 705, 588, 470, 353, 235, 633, 528, 422, 317, 211, 568, 474, 379,
      284, 190, 460, 383, 307, 230, 153, 436, 364, 291, 218, 145, 443, 369, 295,
      221, 148, 389, 324, 259, 195, 130, 354, 295, 236, 177, 119, 334, 278, 223,
      167, 112, 324, 270, 216, 162, 108, 262, 219, 175, 131, 88, 248, 207, 166, 124,
      83, 211, 176, 141, 106, 70, 178, 148, 119, 89, 60, 146, 121, 97, 73, 48, 122,
      102, 81, 61, 41, 88, 73, 59, 44, 29, 69, 57, 46, 34, 23, 51, 42, 34, 26, 17,
      34, 29, 23, 17, 12, 28, 24, 19, 14, 10, 20, 16, 13, 10, 6, 10, 8, 6, 5, 3, 5,
      4, 3, 3, 2, 5, 4, 4, 3, 2, 3, 2, 2, 1, 1, 713, 594, 475, 357, 238, 742, 618,
      494, 371, 247, 757, 631, 505, 379, 252, 749, 624, 499, 375, 250, 721, 601,
      481, 360, 240, 718, 599, 479, 359, 240, 742, 618, 494, 371, 247, 716, 596,
      477, 358, 239, 762, 635, 508, 381, 254, 718, 598, 478, 359, 239, 740, 617,
      493, 370, 247, 694, 578, 463, 347, 231, 707, 589, 471, 354, 236, 688, 574,
      459, 344, 230, 715, 596, 477, 358, 238, 715, 596, 477, 358, 238, 724, 604,
      483, 362, 242, 736, 614, 491, 368, 245, 754, 628, 503, 377, 251, 786, 655,
      524, 393, 262, 786, 655, 524, 393, 262, 833, 694, 555, 417, 278, 851, 710,
      568, 426, 283, 862, 718, 574, 431, 287, 878, 731, 585, 439, 292, 858, 715,
      572, 429, 285, 938, 782, 625, 469, 313, 899, 750, 600, 450, 299, 917, 764,
      611, 458, 306, 888, 740, 592, 444, 297, 902, 752, 601, 451, 300, 900, 750,
      600, 450, 300, 891, 742, 594, 445, 297, 877, 731, 585, 438, 292, 890, 741,
      593, 445, 296, 908, 756, 605, 454, 303, 951, 792, 634, 475, 317, 952, 793,
      635, 476, 317, 898, 748, 598, 449, 299, 891, 742, 594, 445, 297, 859, 716,
      573, 430, 286, 888, 740, 592, 444, 296, 938, 782, 625, 469, 312, 902, 752,
      602, 451, 301, 919, 766, 613, 460, 306, 927, 773, 618, 464, 309, 986, 821,
      657, 493, 328, 1080, 900, 720, 540, 361, 1140, 950, 760, 570, 381, 1158, 965,
      772, 579, 385, 1234, 1028, 823, 617, 411, 1240, 1033, 827, 620, 413, 1280,
      1066, 853, 640, 427, 1286, 1071, 857, 643, 428, 1311, 1093, 874, 656, 437,
      1291, 1076, 860, 645, 430, 1237, 1031, 825, 619, 412, 1226, 1022, 818, 613,
      409, 1200, 1000, 800, 600, 401, 1150, 958, 766, 575, 383, 1149, 958, 766, 575,
      383, 1150, 958, 766, 575, 383, 1088, 907, 726, 544, 363, 1061, 884, 708, 531,
      354, 1016, 847, 678, 508, 339, 988, 823, 658, 494, 329, 990, 825, 660, 495,
      330, 915, 762, 610, 458, 305, 925, 771, 617, 462, 308, 899, 749, 599, 449,
      300, 887, 739, 591, 443, 296, 866, 722, 578, 433, 289, 868, 724, 579, 434,
      290, 838, 699, 559, 419, 280, 819, 683, 546, 410, 273, 795, 662, 530, 398,
      265, 714, 595, 476, 357, 237, 650, 542, 433, 325, 216, 578, 482, 385, 289,
      193, 564, 470, 376, 282, 189, 542, 451, 361, 271, 180, 508, 424, 339, 254,
      170, 508, 424, 339, 254, 169, 457, 381, 305, 229, 152, 448, 373, 299, 224,
      149, 404, 337, 270, 202, 135, 394, 328, 262, 197, 131, 346, 288, 231, 173,
      116, 321, 268, 214, 160, 107, 274, 228, 183, 137, 91, 243, 202, 162, 122, 81,
      185, 154, 124, 93, 62, 163, 136, 109, 81, 54, 130, 109, 87, 65, 44, 96, 80,
      64, 48, 31, 71, 60, 48, 36, 23, 51, 43, 34, 26, 17, 34, 29, 23, 17, 12, 22,
      18, 15, 11, 8, 11, 9, 7, 5, 4, 16, 14, 11, 8, 5, 308, 256, 205, 154, 102, 308,
      257, 206, 154, 103, 341, 284, 228, 171, 114, 310, 258, 207, 155, 103, 313,
      261, 209, 156, 104, 313, 261, 209, 156, 104, 331, 276, 221, 166, 110, 313,
      260, 208, 156, 105, 292, 244, 195, 146, 97, 287, 240, 192, 144, 95, 305, 254,
      204, 153, 102, 280, 234, 187, 140, 93, 273, 228, 182, 136, 91, 288, 240, 192,
      144, 95, 264, 220, 176, 132, 89, 257, 214, 172, 129, 86, 249, 207, 166, 124,
      83, 233, 194, 155, 117, 78, 249, 208, 166, 124, 83, 247, 206, 164, 123, 82,
      273, 227, 182, 136, 91, 274, 228, 182, 137, 91, 294, 245, 196, 147, 99, 298,
      248, 198, 149, 99, 322, 268, 214, 161, 107, 380, 316, 253, 190, 126, 402, 335,
      268, 201, 135, 427, 356, 285, 214, 142, 490, 409, 327, 245, 164, 503, 420,
      336, 252, 167, 510, 425, 340, 255, 170, 534, 445, 356, 267, 178, 533, 444,
      356, 267, 178, 565, 471, 377, 283, 188, 585, 488, 390, 292, 195, 581, 484,
      387, 290, 194, 617, 514, 411, 308, 206, 612, 510, 408, 306, 205, 594, 495,
      396, 297, 199, 557, 464, 372, 279, 186, 563, 469, 375, 282, 188, 555, 462,
      370, 278, 185, 542, 452, 362, 271, 181, 516, 430, 344, 258, 173, 492, 410,
      328, 246, 165, 483, 402, 322, 242, 161, 503, 420, 336, 252, 167, 476, 396,
      317, 238, 158, 459, 382, 306, 229, 153, 472, 393, 314, 236, 157, 451, 376,
      301, 225, 150, 473, 394, 315, 236, 158, 459, 383, 306, 230, 153, 472, 394,
      315, 236, 157, 461, 384, 308, 231, 154, 415, 346, 277, 207, 138, 369, 308,
      246, 184, 123, 355, 296, 236, 177, 118, 348, 290, 232, 174, 117, 296, 246,
      197, 148, 99, 277, 231, 185, 138, 92, 246, 205, 164, 123, 81, 233, 194, 155,
      117, 78, 214, 178, 142, 107, 71, 187, 156, 125, 93, 62, 154, 129, 103, 77, 52,
      148, 124, 99, 74, 49, 137, 114, 92, 69, 46, 147, 122, 98, 74, 49, 124, 104,
      83, 62, 42, 125, 104, 83, 63, 42, 116, 96, 77, 58, 38, 111, 93, 74, 56, 37,
      88, 74, 59, 44, 30, 98, 82, 66, 49, 33, 99, 82, 66, 49, 33, 100, 83, 67, 50,
      33, 81, 68, 54, 40, 27, 98, 82, 65, 49, 32, 81, 68, 54, 40, 27, 73, 60, 48,
      36, 25, 54, 45, 36, 27, 19, 57, 48, 38, 28, 19, 43, 36, 29, 22, 14, 35, 29,
      23, 17, 12, 23, 19, 15, 11, 8, 18, 15, 12, 9, 7, 13, 11, 9, 6, 4, 13, 11, 9,
      7, 4, 12, 10, 8, 6, 3, 7, 6, 5, 3, 2, 7, 6, 5, 3, 2, 3, 2, 2, 2, 1, 3, 2, 2,
      1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0,
      1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 285, 238, 190, 143, 95, 289, 240, 192, 144,
      97, 308, 256, 205, 154, 103, 296, 247, 197, 148, 99, 297, 247, 198, 148, 99,
      288, 240, 192, 144, 97, 298, 248, 199, 149, 100, 273, 228, 182, 137, 91, 301,
      251, 201, 151, 100, 281, 234, 187, 140, 94, 272, 226, 181, 136, 90, 265, 221,
      177, 133, 88, 262, 218, 175, 131, 88, 272, 226, 181, 136, 90, 260, 217, 173,
      130, 87, 233, 194, 155, 117, 78, 219, 182, 146, 110, 73, 201, 168, 134, 100,
      67, 212, 176, 141, 106, 70, 198, 165, 132, 99, 67, 219, 182, 146, 110, 73,
      231, 193, 154, 116, 77, 250, 209, 167, 125, 84, 274, 229, 183, 137, 92, 281,
      234, 188, 141, 94, 326, 272, 217, 163, 108, 369, 308, 246, 185, 123, 407, 339,
      271, 204, 136, 420, 350, 280, 210, 140, 434, 362, 290, 217, 145, 454, 378,
      303, 227, 152, 482, 402, 321, 241, 161, 494, 412, 330, 247, 165, 519, 432,
      346, 260, 173, 529, 441, 353, 264, 176, 513, 428, 342, 257, 171, 520, 433,
      347, 260, 173, 519, 432, 346, 260, 173, 523, 436, 348, 261, 174, 485, 404,
      323, 243, 162, 485, 404, 324, 243, 162, 453, 378, 302, 227, 151, 448, 373,
      298, 224, 149, 452, 376, 301, 226, 151, 427, 356, 284, 213, 142, 411, 342,
      274, 206, 137, 430, 358, 286, 215, 143, 401, 334, 268, 201, 134, 375, 312,
      250, 187, 125, 388, 323, 258, 194, 129, 367, 306, 245, 184, 122, 366, 305,
      244, 183, 122, 356, 296, 237, 178, 118, 335, 279, 223, 167, 112, 337, 281,
      225, 169, 112, 310, 258, 207, 155, 103, 276, 230, 184, 138, 93, 260, 216, 173,
      130, 86, 270, 225, 180, 135, 90, 231, 193, 154, 116, 77, 206, 172, 137, 103,
      69, 183, 152, 122, 91, 61, 176, 146, 117, 88, 58, 170, 142, 113, 85, 57, 158,
      132, 106, 79, 53, 133, 111, 89, 67, 44, 127, 106, 84, 63, 42, 118, 98, 78, 59,
      39, 116, 96, 77, 58, 38, 112, 94, 75, 56, 38, 118, 98, 78, 59, 39, 90, 75, 60,
      45, 29, 92, 77, 62, 46, 31, 74, 61, 49, 37, 24, 83, 69, 55, 41, 28, 69, 57,
      46, 34, 23, 80, 66, 53, 40, 26, 73, 61, 49, 37, 24, 76, 63, 51, 38, 25, 74,
      62, 49, 37, 25, 62, 51, 41, 31, 20, 55, 46, 37, 28, 18, 41, 34, 28, 21, 14,
      42, 35, 28, 21, 13, 31, 26, 20, 15, 10, 29, 24, 19, 15, 10, 20, 17, 13, 10, 7,
      20, 16, 13, 10, 6, 14, 12, 9, 7, 5, 10, 9, 7, 5, 4, 9, 8, 6, 4, 3, 8, 6, 5, 4,
      3, 6, 5, 4, 3, 1, 3, 2, 2, 2, 1, 3, 3, 2, 2, 1, 4, 3, 2, 2, 1, 1, 1, 1, 0, 0,
      2, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1
    ),
  )

  # run propop 5 regions with subregional migration ----
  output_propop_5r <- propop(
    parameters = parameters_short_5r,
    year_first = 2019,
    year_last = 2020,
    age_groups = 101,
    fert_first = 16,
    fert_last = 50,
    share_born_female = 100 / 205,
    population = population_short_5r,
    binational = TRUE,
    subregional = TRUE
  )


  # run snapshot 5 subregions ----
  expect_snapshot(constructive::construct(output_propop_5r))


  # run propop 5 regions without subregional migration ----
  output_propop_5r_F <- propop(
    parameters = parameters_short_5r,
    year_first = 2019,
    year_last = 2020,
    age_groups = 101,
    fert_first = 16,
    fert_last = 50,
    share_born_female = 100 / 205,
    population = population_short_5r,
    binational = TRUE,
    subregional = FALSE
  )

  # Remove additional column to enable fair comparison
  output_propop_5r_T <- output_propop_5r |>
    dplyr::select(-mig_sub)

  # Ensure that results with / without subregional are different ----
  expect_failure(expect_equal(output_propop_5r_T, output_propop_5r_F))

  # prepare comparison 1 vs 5 regions ----

  ## prepare data for comparison ----
  ### n in starting populations should be identical in both versions
  ### simplify to make comparable
  compare_pop1r <- population_short_1r |>
    select(-spatial_unit) |>
    arrange(year, nat, sex, age)
  ### simplify to make comparable
  compare_pop5r <- population_short_5r |>
    summarise(n = sum(n), .by = c(year, nat, sex, age)) |>
    arrange(year, nat, sex, age)



  # run equal starting populations ----
  expect_equal(compare_pop1r, compare_pop5r)


  ### parameters should be identical in both versions
  compare_params_1r <- parameters_short_1r |>
    dplyr::select(-spatial_unit) |>
    arrange(year, nat, sex, age)

  compare_params_5r <- parameters_short_5r |>
    # remove column that includes redundancy
    dplyr::select(-mig_sub, -spatial_unit) |>
    # remove redundant columns
    dplyr::distinct(year, nat, sex, age, .keep_all = TRUE) |>
    # multiply columns with number-of-people parameters
    # by number of regions to get the n right again
    dplyr::mutate_at(vars(imm_int_n, imm_nat_n, emi_nat_n, mig_nat_n), ~ . * 5) |>
    arrange(year, nat, sex, age)

  # run equal parameters ----
  expect_equal(compare_params_1r, compare_params_5r)


  ## equal projection results
  # simplify data for comparison
  output_super <- output_propop_1r |>
    select(year, age, sex, nat, n_dec) |>
    arrange(year, nat, sex, age)

  output_subregions <- output_propop_5r |>
    dplyr::mutate(n_check = sum(n_dec, na.rm = TRUE),
                  .by = c(year, nat, sex, age)) |>
    # remove column that includes redundancy
    dplyr::select(-n_dec, -spatial_unit) |>
    # rename n_check
    rename(n_dec = n_check) |>
    # remove redundant columns
    dplyr::distinct(year, nat, sex, age, .keep_all = TRUE) |>
    select(year, age, sex, nat, n_dec) |>
    arrange(year, nat, sex, age)

  # run equal output ----
  expect_equal(output_super, output_subregions, ignore_attr = TRUE)
})

options(cli.default_handler = NULL)



# Unexpected input regarding nationalities ----

test_that("Error when binational is FALSE but column `nat` is present", {

  expect_error(
    propop(
      parameters = fso_parameters,
      year_first = 2019,
      year_last = 2020,
      fert_first = 16,
      fert_last = 50,
      share_born_female = 100 / 205,
      population = fso_population,
      binational = FALSE,
      subregional = FALSE
    )
  )
})


test_that("Error when only 1 nationality in parameters", {

  expect_error(
    propop(
      # remove non-Swiss nationals
      parameters = fso_parameters |>
        # remove non-Swiss nationals
        dplyr::filter(nat != "int"),
      year_first = 2019,
      year_last = 2020,
      fert_first = 16,
      fert_last = 50,
      share_born_female = 100 / 205,
      population = fso_population,
      binational = TRUE,
      subregional = FALSE
    )
  )
})

test_that("Error when only 1 nationality in population", {

  expect_error(
    propop(
      # remove non-Swiss nationals
      parameters = fso_parameters,
      year_first = 2019,
      year_last = 2020,
      fert_first = 16,
      fert_last = 50,
      share_born_female = 100 / 205,
      population = fso_population |>
        # remove Swiss nationals
        dplyr::filter(nat == "int"),
      binational = TRUE,
      subregional = FALSE
    )
  )
})

test_that("Error if there are unexpected factor levels in pop `nat`", {

  expect_error(
    propop(
      # remove non-Swiss nationals
      parameters = fso_parameters,
      year_first = 2019,
      year_last = 2020,
      fert_first = 16,
      fert_last = 50,
      share_born_female = 100 / 205,
      population = fso_population |>
        # replace factor level
        dplyr::mutate(nat = case_match(
          nat,
          "ch" ~ "swiss",
          .default = nat)),
      binational = TRUE,
      subregional = FALSE
    )
  )
})
