test_that("prepare_evaluation snapshots", {
  # Prepare data ----

  ## Get starting population and later population records
  ### population ----
  # nolint start
  # data_population <- get_population(
  #   number_fso = "px-x-0102010000_101",
  #   year_first = 2018,
  #   year_last = 2020,
  #   spatial_units = "- Aargau"
  # )
  #
  # # Create tibble
  # data_population |>
  #   dplyr::filter(year > 2018) |>
  #   constructive::construct()
  # nolint end

  ### benchmark ----
  data_benchmark <- tibble::tibble(
    year = rep(c("2019", "2020"), each = 404L),
    spatial_unit = rep("Aargau", 808L),
    nat = rep(rep(c("ch", "int"), 2), each = 202L),
    sex = rep(rep(c("m", "f"), 4), each = 101L),
    age = rep(seq(0, 100, by = 1), 8),
    n = c(
      2622, 2593, 2635, 2596, 2683, 2737, 2636, 2609, 2642, 2657, 2533, 2605, 2453,
      2566, 2591, 2598, 2626, 2591, 2581, 2835, 2766, 2872, 2923, 3042, 2866, 2924,
      3057, 3114, 3054, 3089, 3088, 3005, 2935, 3078, 2895, 3124, 3033, 3092, 3085,
      3068, 2988, 2885, 2908, 2789, 2875, 3097, 3080, 3245, 3447, 3628, 3692, 4012,
      4110, 4144, 4230, 4277, 4109, 4100, 4012, 3767, 3713, 3591, 3610, 3446, 3414,
      3228, 3121, 3023, 2810, 2846, 2770, 2784, 2698, 2664, 2500, 2378, 2279, 2037,
      1832, 1473, 1409, 1407, 1230, 1103, 1043, 993, 786, 739, 628, 527, 409, 323,
      234, 170, 118, 89, 64, 49, 21, 12, 17, 2362, 2424, 2532, 2553, 2532, 2450,
      2427, 2495, 2434, 2583, 2424, 2513, 2373, 2403, 2359, 2458, 2441, 2462, 2495,
      2559, 2638, 2655, 2825, 2852, 2912, 2910, 2849, 3096, 3033, 3087, 2983, 3016,
      3025, 3025, 2956, 3016, 3070, 3205, 3226, 3033, 3028, 2916, 3009, 3170, 3040,
      3104, 3133, 3313, 3631, 3813, 3901, 4154, 4163, 4279, 4298, 4394, 4311, 4125,
      4083, 3984, 3824, 3831, 3813, 3610, 3521, 3380, 3268, 3258, 3053, 3056, 2971,
      2930, 2860, 2841, 2763, 2685, 2602, 2327, 2111, 1874, 1839, 1750, 1638, 1630,
      1440, 1428, 1256, 1211, 1041, 958, 793, 699, 529, 443, 330, 252, 188, 132, 84,
      53, 56, 1023, 1068, 1035, 1135, 1031, 1031, 1044, 1108, 1045, 970, 963, 1014,
      932, 903, 925, 885, 828, 805, 734, 844, 833, 914, 982, 1042, 1057, 1188, 1332,
      1446, 1539, 1723, 1774, 1797, 1869, 1842, 1939, 2003, 1968, 2078, 2081, 2020,
      1883, 1905, 1872, 1827, 1739, 1659, 1623, 1664, 1582, 1513, 1548, 1499, 1564,
      1516, 1554, 1494, 1368, 1224, 1144, 1129, 936, 891, 791, 741, 677, 566, 487,
      472, 445, 474, 400, 414, 365, 366, 289, 314, 316, 327, 255, 312, 248, 233,
      173, 178, 132, 103, 66, 56, 35, 33, 36, 19, 21, 7, 7, 2, 2, 1, 1, 0, 3, 978,
      994, 963, 1028, 979, 982, 974, 995, 883, 1018, 936, 897, 872, 860, 878, 810,
      752, 692, 643, 684, 678, 760, 825, 914, 977, 1018, 1194, 1325, 1440, 1493,
      1521, 1604, 1656, 1711, 1753, 1759, 1758, 1775, 1744, 1758, 1615, 1635, 1519,
      1490, 1494, 1425, 1377, 1421, 1329, 1231, 1280, 1207, 1220, 1173, 1095, 1117,
      1020, 920, 864, 883, 759, 675, 594, 569, 540, 514, 432, 418, 388, 376, 372,
      388, 294, 303, 246, 270, 222, 261, 239, 244, 243, 195, 185, 131, 127, 93, 89,
      53, 55, 42, 33, 27, 24, 14, 8, 9, 8, 3, 2, 2, 1, 2605, 2679, 2650, 2688, 2637,
      2721, 2764, 2672, 2651, 2666, 2700, 2581, 2636, 2521, 2615, 2631, 2652, 2677,
      2647, 2612, 2870, 2783, 2870, 2912, 3036, 2851, 2945, 3026, 3135, 3070, 3094,
      3107, 3060, 3012, 3132, 2970, 3155, 3101, 3161, 3129, 3141, 3022, 2952, 2963,
      2823, 2926, 3132, 3119, 3318, 3475, 3665, 3713, 4022, 4113, 4149, 4247, 4271,
      4109, 4103, 3997, 3778, 3696, 3583, 3578, 3409, 3345, 3178, 3102, 2989, 2774,
      2810, 2717, 2735, 2650, 2604, 2443, 2322, 2216, 1956, 1765, 1402, 1335, 1319,
      1141, 1030, 956, 883, 692, 629, 525, 439, 329, 258, 174, 108, 82, 61, 39, 32,
      10, 11, 2367, 2452, 2499, 2580, 2575, 2560, 2504, 2481, 2538, 2478, 2619,
      2475, 2564, 2426, 2453, 2427, 2506, 2482, 2503, 2531, 2610, 2668, 2690, 2850,
      2864, 2928, 2900, 2858, 3130, 3065, 3134, 3007, 3081, 3074, 3078, 3028, 3104,
      3122, 3251, 3275, 3102, 3069, 2952, 3041, 3223, 3089, 3135, 3171, 3347, 3646,
      3840, 3908, 4182, 4192, 4291, 4295, 4417, 4323, 4135, 4080, 3986, 3816, 3822,
      3797, 3600, 3495, 3351, 3241, 3241, 3029, 3049, 2954, 2895, 2837, 2805, 2707,
      2639, 2557, 2278, 2059, 1826, 1769, 1700, 1562, 1562, 1346, 1317, 1145, 1105,
      909, 828, 679, 560, 440, 354, 255, 189, 134, 97, 61, 55, 995, 1065, 1081,
      1054, 1156, 1056, 1048, 1036, 1098, 1040, 978, 954, 1027, 905, 887, 918, 837,
      812, 801, 753, 847, 855, 973, 1052, 1138, 1142, 1292, 1462, 1536, 1644, 1834,
      1842, 1867, 1954, 1899, 1987, 2075, 2027, 2098, 2077, 1987, 1907, 1931, 1869,
      1847, 1729, 1665, 1641, 1656, 1580, 1494, 1568, 1500, 1540, 1518, 1536, 1481,
      1365, 1207, 1132, 1093, 901, 865, 757, 712, 632, 537, 468, 454, 427, 471, 393,
      401, 354, 349, 272, 304, 302, 314, 249, 299, 233, 218, 161, 162, 120, 83, 59,
      45, 31, 28, 29, 16, 15, 4, 6, 2, 2, 1, 0, 1, 1002, 1008, 981, 956, 1035, 977,
      1005, 979, 984, 870, 1008, 908, 881, 845, 827, 856, 782, 721, 662, 630, 685,
      697, 832, 887, 995, 1063, 1134, 1291, 1409, 1546, 1604, 1590, 1668, 1717,
      1789, 1809, 1786, 1818, 1819, 1752, 1758, 1621, 1647, 1541, 1474, 1503, 1444,
      1364, 1422, 1324, 1222, 1270, 1214, 1206, 1191, 1095, 1116, 1010, 910, 859,
      850, 744, 665, 593, 546, 523, 501, 434, 410, 384, 370, 362, 373, 288, 298,
      243, 262, 219, 249, 235, 242, 231, 179, 178, 122, 117, 84, 90, 49, 48, 36, 28,
      21, 23, 12, 6, 5, 7, 1, 2, 3
    ),
  )

  ### Parameters for projection ----
  # nolint start
  # fso_parameters |>
  #   filter(year %in% c(2019, 2020) &
  #            scen == "reference") |>
  #   constructive::construct()
  # nolint end

  ag_parameters <- tibble::tibble(
    nat = rep(rep(c("ch", "int"), 2), each = 202L),
    sex = rep(rep(c("m", "f"), 4), each = 101L),
    age = rep(seq(0, 100, by = 1), 8),
    year = rep(c("2019", "2020"), each = 404L),
    scen = rep("reference", 808L),
    birth_rate = rep(
      c(
        0, 0.00041, 0.000808, 0.001581, 0.003418, 0.006455, 0.010405, 0.016157,
        0.02364, 0.032479, 0.042954, 0.055049, 0.068632, 0.083007, 0.09798, 0.111332,
        0.121122, 0.125879, 0.122941, 0.112803, 0.097161, 0.078333, 0.05944, 0.042398,
        0.028719, 0.018692, 0.011733, 0.006989, 0.00429, 0.00227, 0.001286, 0.000606,
        0.000277, 0.000262, 0, 0.001381, 0.005993, 0.017009, 0.032641, 0.048974,
        0.065594, 0.081725, 0.094398, 0.106007, 0.114386, 0.122848, 0.130621,
        0.134582, 0.136562, 0.134367, 0.129289, 0.120395, 0.109997, 0.096929,
        0.083624, 0.06944, 0.055859, 0.043528, 0.032069, 0.022818, 0.015167, 0.009358,
        0.005302, 0.002804, 0.001454, 0.000698, 0, 0.000402, 0.001594, 0.003124,
        0.005644, 0.009778, 0.014979, 0.022016, 0.030871, 0.041047, 0.053292,
        0.066976, 0.082033, 0.097347, 0.111297, 0.121859, 0.127219, 0.124628,
        0.114793, 0.099225, 0.080272, 0.060831, 0.04378, 0.029622, 0.019051, 0.011915,
        0.007267, 0.004389, 0.002279, 0.001281, 0.000636, 3e-04, 0.000274, 0,
        0.001327, 0.005602, 0.014993, 0.030641, 0.047519, 0.063492, 0.078652,
        0.093285, 0.104471, 0.114964, 0.123887, 0.130657, 0.136027, 0.137455,
        0.134702, 0.130354, 0.122096, 0.111176, 0.098619, 0.085166, 0.071162,
        0.057419, 0.044622, 0.033077, 0.023306, 0.015352, 0.009823, 0.005317,
        0.002639, 0.001394, 0.000722, 0
      ),
      rep(
        c(118L, 1L, 169L, 1L, 172L, 1L, 169L, 1L, 53L),
        c(1L, 33L, 1L, 31L, 1L, 32L, 1L, 31L, 1L)
      )
    ),
    births_int_ch = rep(c(0.23487796250442164, 0.23488290807409998), each = 404L),
    mor = c(
      0.004386, 0.000791, 0.000383, 0.000386, 0, 0, 0, 0, 0, 0, 0, 0.000388,
      0.000412, 0.000395, 0.000392, 0.000388, 0.000386, 0.000391, 0.00079, 0.00071,
      0.000726, 0.000702, 0.000683, 0.000661, 0.000348, 0.000342, 0.000328,
      0.000321, 0.000327, 0.000327, 0.000327, 0.000336, 0.00034, 0.000328, 0.000341,
      0.000641, 0.000661, 0.000653, 0.000655, 0.000655, 0.000675, 0.001045,
      0.001028, 0.001083, 0.001406, 0.001297, 0.001632, 0.001545, 0.001739, 0.00194,
      0.002162, 0.002244, 0.002442, 0.002661, 0.002849, 0.003036, 0.003402,
      0.003659, 0.003999, 0.004515, 0.004835, 0.005534, 0.006061, 0.006621,
      0.007257, 0.00799, 0.008904, 0.009823, 0.010539, 0.011816, 0.012866, 0.014162,
      0.015699, 0.017346, 0.019547, 0.021726, 0.02424, 0.027456, 0.031118, 0.035202,
      0.039863, 0.046055, 0.052408, 0.059247, 0.067295, 0.076852, 0.086808,
      0.096618, 0.107955, 0.119529, 0.129763, 0.139877, 0.150427, 0.166302,
      0.188235, 0.217391, 0.252632, 0.292308, 0.3125, 0.352941, 0.481481, 0.003348,
      0.000417, 0.000401, 0.000393, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0.000404, 0.000395, 0.00038, 0.00038, 0.000359, 0.000351, 0.000348, 0.000342,
      0.000349, 0.00032, 0.000333, 0.000327, 0.000337, 0.000331, 0.000332, 0.000669,
      0.000679, 0.000669, 0.000656, 0.000626, 0.000625, 0.000662, 0.000668,
      0.000692, 0.00067, 0.000635, 0.00066, 0.000972, 0.000964, 0.000908, 0.001106,
      0.001311, 0.001291, 0.001455, 0.001689, 0.001871, 0.001863, 0.002055, 0.00232,
      0.002663, 0.002931, 0.003245, 0.003389, 0.003651, 0.004173, 0.004683,
      0.005088, 0.005315, 0.006073, 0.006359, 0.007207, 0.007778, 0.008338,
      0.009125, 0.010379, 0.011395, 0.012876, 0.014275, 0.016217, 0.018063,
      0.020766, 0.023334, 0.027092, 0.030437, 0.035367, 0.04072, 0.046557, 0.054235,
      0.063033, 0.073143, 0.084885, 0.098085, 0.112815, 0.12947, 0.147011, 0.167587,
      0.193103, 0.222571, 0.260504, 0.304094, 0.347826, 0.391892, 0.555556,
      0.003623, 0.000971, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.001172,
      0.001214, 0.001293, 0.001206, 0.001205, 0.001079, 0.001062, 0, 0, 0, 0, 0, 0,
      0.000593, 0.00058, 0.000573, 0.000549, 0.000551, 0.000522, 0.000507, 0.000512,
      0.000484, 0.000488, 0.000503, 0.000536, 0.001063, 0.001079, 0.001105, 0.00116,
      0.001214, 0.001239, 0.001191, 0.001889, 0.001958, 0.001905, 0.001991,
      0.001902, 0.002607, 0.002541, 0.0026, 0.002893, 0.003257, 0.003403, 0.004342,
      0.00409, 0.004372, 0.004935, 0.00651, 0.007123, 0.008217, 0.007851, 0.010173,
      0.010953, 0.012295, 0.01451, 0.01444, 0.018205, 0.018893, 0.020374, 0.024465,
      0.027439, 0.03012, 0.033395, 0.036923, 0.040892, 0.045833, 0.055402, 0.058047,
      0.069686, 0.077922, 0.092715, 0.098361, 0.116279, 0.136364, 0.153846,
      0.173913, 0.173913, 0.2, 0.222222, 0.333333, 0.333333, 0.5, 0, 0, 0.5,
      0.004766, 0.001051, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0.001037, 0, 0, 0.000782, 0.000714, 0.000693, 0.000672, 0.000646,
      0.000613, 0.000599, 0.000573, 0.000563, 0.000581, 0.000574, 0.000576,
      0.000573, 0.000617, 0.000617, 0.000659, 0.000668, 0.000662, 0.000701,
      0.000727, 0.000697, 0.000746, 0.000798, 0.000772, 0.000815, 0.001636,
      0.001684, 0.001789, 0.00178, 0.00194, 0.002177, 0.002322, 0.003354, 0.002606,
      0.002926, 0.003295, 0.003425, 0.005362, 0.005731, 0.00452, 0.007126, 0.007653,
      0.007792, 0.008011, 0.007663, 0.01005, 0.00974, 0.01227, 0.014493, 0.017467,
      0.018868, 0.020492, 0.023762, 0.028398, 0.03423, 0.038043, 0.050725, 0.057762,
      0.068627, 0.082474, 0.089552, 0.107692, 0.12766, 0.142857, 0.133333, 0.150943,
      0.157895, 0.2, 0.181818, 0.25, 0.333333, 0.2, 0.5, 0.5, 0.004356, 0.000789,
      0.000389, 0.000377, 0, 0, 0, 0, 0, 0, 0, 0.000392, 0.000383, 0.000406,
      0.000389, 0.000386, 0.000382, 0.00038, 0.000772, 0.00078, 0.000702, 0.000719,
      0.000696, 0.000679, 0.000659, 0.000348, 0.000343, 0.000329, 0.000322,
      0.000327, 0.000326, 0.000325, 0.000333, 0.000336, 0.000324, 0.000672,
      0.000631, 0.00065, 0.000642, 0.000644, 0.000968, 0.000997, 0.001028, 0.001013,
      0.001422, 0.001388, 0.001604, 0.001616, 0.001839, 0.002015, 0.00193, 0.002153,
      0.002238, 0.002437, 0.002656, 0.003083, 0.00327, 0.003647, 0.00391, 0.004259,
      0.004792, 0.00539, 0.005832, 0.006368, 0.00723, 0.007597, 0.008678, 0.009308,
      0.010573, 0.011348, 0.012647, 0.013746, 0.015078, 0.017053, 0.018769, 0.02112,
      0.023451, 0.026574, 0.030141, 0.034258, 0.039136, 0.044317, 0.050355,
      0.057724, 0.065618, 0.075, 0.084253, 0.095, 0.105615, 0.116242, 0.127985,
      0.136954, 0.148148, 0.165657, 0.184211, 0.210145, 0.244444, 0.28169, 0.326087,
      0.363636, 0.48, 0.003316, 0.000414, 0.00041, 0.000395, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0.000402, 0.000398, 0.00039, 0.000376, 0.000376, 0.000357,
      0.000349, 0.000347, 0.000342, 0.000348, 0.00032, 0.000332, 0.000651, 0.000334,
      0.000657, 0.000657, 0.000661, 0.000669, 0.000659, 0.000647, 0.000617,
      0.000616, 0.000651, 0.000657, 0.000681, 0.00066, 0.00094, 0.000976, 0.00096,
      0.000953, 0.001199, 0.001371, 0.001303, 0.001541, 0.00169, 0.001683, 0.001866,
      0.002093, 0.00228, 0.00255, 0.002904, 0.003176, 0.003497, 0.003655, 0.004181,
      0.004446, 0.004979, 0.005402, 0.005938, 0.006408, 0.006998, 0.007577,
      0.008479, 0.009066, 0.010216, 0.011171, 0.012565, 0.014118, 0.015953,
      0.018001, 0.020508, 0.023064, 0.026497, 0.029981, 0.034748, 0.039658,
      0.046097, 0.053571, 0.062257, 0.071965, 0.082957, 0.096454, 0.110709,
      0.127082, 0.144068, 0.164461, 0.190265, 0.219373, 0.254032, 0.295455,
      0.344538, 0.4, 0.529412, 0.003566, 0.000907, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0.001151, 0.001186, 0.001229, 0.001295, 0.001195, 0.001164, 0.001027,
      0.000987, 0, 0, 0, 0, 0, 0, 0.000561, 0.000551, 0.000546, 0.000528, 0.000531,
      0.000508, 0.000497, 0.000503, 0.00048, 0.000486, 0.001, 0.001066, 0.001061,
      0.001077, 0.001104, 0.001157, 0.001208, 0.001235, 0.001786, 0.001886,
      0.001951, 0.001901, 0.001984, 0.002537, 0.002603, 0.002549, 0.003262,
      0.003639, 0.003289, 0.00432, 0.00444, 0.005214, 0.00559, 0.006329, 0.00672,
      0.007452, 0.008613, 0.01005, 0.010363, 0.011148, 0.012552, 0.014815, 0.017199,
      0.018592, 0.022069, 0.024348, 0.025197, 0.028346, 0.031201, 0.034749,
      0.041801, 0.043137, 0.053333, 0.058997, 0.067606, 0.075472, 0.085308,
      0.103704, 0.109091, 0.131579, 0.131579, 0.151515, 0.157895, 0.157895, 0.25,
      0.285714, 0, 0.5, 0, 0, 0.333333, 0.004714, 0.000961, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.000941, 0, 0, 0.00073,
      0.000673, 0.000657, 0.000641, 0.000621, 0.000595, 0.000585, 0.000563,
      0.000556, 0.000574, 0.000568, 0.000572, 0.00057, 0.000613, 0.000614, 0.000655,
      0.000664, 0.00066, 0.000697, 0.000722, 0.000696, 0.000743, 0.000793, 0.00154,
      0.001621, 0.001633, 0.001681, 0.001788, 0.001787, 0.001955, 0.002198,
      0.002347, 0.003405, 0.003955, 0.004441, 0.004996, 0.005236, 0.00551, 0.005837,
      0.006849, 0.007212, 0.007712, 0.007864, 0.008097, 0.010336, 0.010169,
      0.013115, 0.012448, 0.014733, 0.017778, 0.023077, 0.025157, 0.028513,
      0.033543, 0.040609, 0.045198, 0.053435, 0.061538, 0.073684, 0.089888,
      0.098361, 0.12069, 0.121951, 0.133333, 0.153846, 0.130435, 0.1875, 0.25,
      0.222222, 0.222222, 0, 0.25, 0.5
    ),
    emi = c(
      0.002417, 0.005986, 0.005407, 0.005062, 0.004175, 0.004059, 0.003834,
      0.003114, 0.002681, 0.002278, 0.00199, 0.00156, 0.001244, 0.001193, 0.00079,
      0.000782, 0.000778, 0.000789, 0.001193, 0.001786, 0.002556, 0.003172,
      0.003429, 0.003974, 0.004538, 0.005137, 0.005242, 0.00544, 0.005559, 0.005556,
      0.005561, 0.0054, 0.005132, 0.005279, 0.004818, 0.00484, 0.004332, 0.004281,
      0.004292, 0.003966, 0.003747, 0.003512, 0.003452, 0.00364, 0.003541, 0.003262,
      0.003283, 0.003107, 0.002911, 0.002782, 0.002711, 0.002749, 0.002449,
      0.002425, 0.002617, 0.002807, 0.00292, 0.003174, 0.003252, 0.003457, 0.003494,
      0.0036, 0.003584, 0.003744, 0.003778, 0.004914, 0.003814, 0.002948, 0.002812,
      0.002434, 0.002145, 0.002125, 0.001826, 0.001846, 0.001564, 0.00164, 0.001276,
      0.000947, 0.001055, 0.000652, 0.000688, 0.000678, 0.000771, 0.000847, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.003384, 0.003786, 0.003641,
      0.003566, 0.003604, 0.003329, 0.00334, 0.003236, 0.003353, 0.002756, 0.002926,
      0.002432, 0.002162, 0.002121, 0.002179, 0.001678, 0.001678, 0.001656,
      0.002037, 0.003183, 0.003053, 0.003053, 0.003241, 0.004228, 0.004875,
      0.005812, 0.006296, 0.006716, 0.007005, 0.006872, 0.006417, 0.005988,
      0.005667, 0.004715, 0.004447, 0.00371, 0.003305, 0.00284, 0.002521, 0.002674,
      0.002358, 0.002444, 0.002365, 0.002239, 0.002327, 0.002285, 0.002265,
      0.002435, 0.002222, 0.002368, 0.002332, 0.002188, 0.002178, 0.00211, 0.0021,
      0.002059, 0.002092, 0.00194, 0.001957, 0.00175, 0.001827, 0.001827, 0.001827,
      0.001929, 0.002544, 0.002066, 0.002126, 0.001515, 0.001311, 0.001297,
      0.001335, 0.001015, 0.001039, 0.001036, 0.001073, 0.001098, 0.001132,
      0.001261, 0.000923, 0.001038, 0.000532, 0.000554, 0.00059, 0.00059, 0.000656,
      0.00067, 0.000742, 0.000762, 0.000867, 0.000935, 0.001095, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0.004513, 0.037073, 0.032101, 0.02812, 0.025169, 0.022052,
      0.018217, 0.016304, 0.014395, 0.01232, 0.009395, 0.008841, 0.007495, 0.006593,
      0.005214, 0.00454, 0.006993, 0.013269, 0.020592, 0.026506, 0.030414, 0.034103,
      0.039474, 0.040775, 0.041331, 0.041978, 0.041897, 0.041014, 0.040028,
      0.038532, 0.036949, 0.035882, 0.03427, 0.033746, 0.032378, 0.031795, 0.031508,
      0.030642, 0.029887, 0.029783, 0.029602, 0.028769, 0.028108, 0.028208,
      0.027891, 0.026204, 0.025466, 0.02503, 0.024606, 0.023545, 0.022265, 0.021956,
      0.020939, 0.019595, 0.01906, 0.018205, 0.0188, 0.020325, 0.024535, 0.027562,
      0.029412, 0.028169, 0.031746, 0.032175, 0.036517, 0.05939, 0.034951, 0.020243,
      0.015284, 0.012245, 0.012048, 0.009592, 0.007792, 0.008086, 0.010169,
      0.009146, 0.009119, 0.009009, 0.007407, 0.006135, 0.007407, 0.008264,
      0.005525, 0.005263, 0.006944, 0.008621, 0.013158, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0.012322, 0.043113, 0.034304, 0.02729, 0.02229, 0.019211,
      0.016649, 0.015091, 0.01427, 0.012948, 0.012821, 0.012155, 0.011312, 0.010297,
      0.01105, 0.010381, 0.010296, 0.010959, 0.01194, 0.014184, 0.016641, 0.017808,
      0.020752, 0.022754, 0.02623, 0.029851, 0.030387, 0.030057, 0.029477, 0.029286,
      0.029696, 0.028402, 0.028002, 0.026699, 0.025434, 0.023823, 0.022209,
      0.020196, 0.019075, 0.017222, 0.016079, 0.014833, 0.013898, 0.012735,
      0.011952, 0.011955, 0.010949, 0.011173, 0.010463, 0.010408, 0.010062,
      0.010621, 0.010656, 0.01097, 0.012545, 0.015125, 0.017425, 0.019544, 0.020809,
      0.021111, 0.020752, 0.018923, 0.018062, 0.015385, 0.038801, 0.024621,
      0.018018, 0.011848, 0.010204, 0.01039, 0.010667, 0.010204, 0.010033, 0.00974,
      0.012245, 0.007246, 0.008734, 0.007547, 0.008197, 0.007905, 0.008097,
      0.009756, 0.01087, 0.014493, 0.014388, 0.009804, 0.010309, 0.014925, 0.015385,
      0.021277, 0.028571, 0.033333, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.001999, 0.005976,
      0.005488, 0.004941, 0.004599, 0.00412, 0.003652, 0.003038, 0.002699, 0.00228,
      0.001884, 0.001577, 0.001157, 0.000819, 0.000785, 0.000778, 0.000769,
      0.000766, 0.001166, 0.001962, 0.002472, 0.003251, 0.003842, 0.004084,
      0.004616, 0.005216, 0.005479, 0.005588, 0.005782, 0.005566, 0.005554,
      0.005543, 0.005353, 0.005076, 0.004892, 0.004744, 0.004453, 0.004261,
      0.004207, 0.003896, 0.003901, 0.003686, 0.003801, 0.003403, 0.003584,
      0.003145, 0.003227, 0.002924, 0.003079, 0.00289, 0.003042, 0.002969, 0.002493,
      0.002442, 0.00242, 0.002614, 0.002806, 0.002922, 0.003179, 0.003259, 0.003465,
      0.003507, 0.003336, 0.003601, 0.003475, 0.004673, 0.00341, 0.00321, 0.002645,
      0.002129, 0.002109, 0.00181, 0.001795, 0.001854, 0.001502, 0.001594, 0.001257,
      0.001307, 0.000973, 0.000544, 0.000675, 0.000715, 0.00071, 0.000813, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.00252, 0.003759, 0.003724,
      0.00358, 0.003512, 0.003553, 0.003287, 0.003302, 0.003203, 0.002905, 0.002729,
      0.002482, 0.002407, 0.002133, 0.002089, 0.001709, 0.001639, 0.001639,
      0.002431, 0.002807, 0.002749, 0.003023, 0.0034, 0.00429, 0.005252, 0.005901,
      0.006496, 0.006974, 0.007047, 0.006656, 0.006527, 0.006042, 0.005611,
      0.005286, 0.004659, 0.003709, 0.003322, 0.002934, 0.002489, 0.002484,
      0.002298, 0.002318, 0.002402, 0.002329, 0.002208, 0.002294, 0.002255,
      0.002237, 0.002109, 0.002203, 0.002093, 0.002061, 0.002179, 0.002169,
      0.002104, 0.002096, 0.002055, 0.001857, 0.001939, 0.001957, 0.00175, 0.001829,
      0.001831, 0.001832, 0.002489, 0.001989, 0.002079, 0.001527, 0.001218,
      0.001319, 0.000979, 0.001008, 0.001022, 0.001048, 0.001047, 0.001087,
      0.001114, 0.001149, 0.000855, 0.000942, 0.000531, 0.000546, 0.00057, 0.000611,
      0.000615, 0.000687, 0.000708, 0.000791, 0.000822, 0.000946, 0.001035,
      0.001235, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.001784, 0.035519, 0.032882, 0.027885,
      0.024497, 0.02201, 0.018027, 0.015166, 0.01435, 0.012322, 0.010091, 0.008222,
      0.007805, 0.006383, 0.005495, 0.005247, 0.008018, 0.012972, 0.019584,
      0.024707, 0.028986, 0.033453, 0.038136, 0.040206, 0.04147, 0.041096, 0.041246,
      0.039942, 0.039095, 0.037687, 0.036311, 0.034989, 0.034059, 0.032813,
      0.032415, 0.031379, 0.031109, 0.030426, 0.029865, 0.029684, 0.028571,
      0.028862, 0.028147, 0.027493, 0.026519, 0.026667, 0.025439, 0.025371,
      0.024434, 0.023929, 0.022179, 0.021587, 0.020557, 0.019683, 0.018905,
      0.018471, 0.018893, 0.020319, 0.023732, 0.025751, 0.029024, 0.02588, 0.027685,
      0.028822, 0.034483, 0.056769, 0.035654, 0.02, 0.014463, 0.011111, 0.0125,
      0.009852, 0.009804, 0.007958, 0.008264, 0.006944, 0.006289, 0.006289,
      0.006231, 0.007692, 0.00641, 0.007782, 0.008811, 0.005882, 0.005618, 0.007519,
      0.009434, 0.014706, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.011236, 0.040346,
      0.032597, 0.026915, 0.021401, 0.019153, 0.016032, 0.014418, 0.012974,
      0.013001, 0.011858, 0.011616, 0.010917, 0.010056, 0.010262, 0.010022,
      0.010576, 0.011827, 0.012535, 0.015038, 0.016997, 0.017467, 0.019206,
      0.023669, 0.02589, 0.028628, 0.028763, 0.029486, 0.029434, 0.028374, 0.028995,
      0.028197, 0.027813, 0.026554, 0.024837, 0.023282, 0.021277, 0.020196,
      0.018265, 0.017212, 0.015429, 0.01476, 0.013538, 0.013141, 0.012, 0.011243,
      0.011181, 0.010862, 0.010453, 0.010424, 0.009547, 0.010031, 0.009756,
      0.011447, 0.012626, 0.014311, 0.016949, 0.019474, 0.021882, 0.021028,
      0.020316, 0.018373, 0.017699, 0.016584, 0.037866, 0.023679, 0.015504,
      0.013667, 0.01199, 0.010283, 0.010471, 0.010782, 0.010309, 0.010169, 0.009836,
      0.008299, 0.011029, 0.008889, 0.007692, 0.008368, 0.00813, 0.008368, 0.010152,
      0.011299, 0.007634, 0.007692, 0.010526, 0.011236, 0.016393, 0.017241, 0.02439,
      0.033333, 0.038462, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    acq = rep(
      c(
        0, 0.023466, 0.012683, 0.015564, 0.015817, 0.016457, 0.017258, 0.016304,
        0.017274, 0.01848, 0.021921, 0.027505, 0.03212, 0.037363, 0.040667, 0.044268,
        0.041958, 0.039807, 0.034749, 0.03253, 0.027981, 0.022002, 0.01864, 0.013252,
        0.011089, 0.007463, 0.007905, 0.007457, 0.008427, 0.008563, 0.010131,
        0.011765, 0.012921, 0.014623, 0.015924, 0.016923, 0.017562, 0.017996,
        0.018128, 0.018173, 0.018299, 0.018114, 0.016757, 0.016593, 0.01627, 0.015235,
        0.014907, 0.014303, 0.01388, 0.013734, 0.012087, 0.011976, 0.011421, 0.011104,
        0.010165, 0.009103, 0.0094, 0.008943, 0.00846, 0.008613, 0.007099, 0.007584,
        0.007326, 0.006435, 0.007022, 0.006421, 0.003883, 0.004049, 0.004367,
        0.004082, 0.004819, 0.004796, 0.002597, 0.002695, 0.00339, 0.003049, 0.00304,
        0.003003, 0.003704, 0.003067, 0.003704, 0.004132, 0, 0.014218, 0.015773,
        0.016632, 0.017544, 0.018237, 0.016178, 0.016649, 0.018109, 0.018661, 0.01992,
        0.020299, 0.022099, 0.024887, 0.033181, 0.040884, 0.051903, 0.059202,
        0.058904, 0.053731, 0.048227, 0.040847, 0.031507, 0.02594, 0.023952, 0.022951,
        0.021322, 0.019337, 0.017872, 0.016212, 0.016429, 0.015884, 0.017173,
        0.018046, 0.018204, 0.019653, 0.02042, 0.019871, 0.020196, 0.020809, 0.021814,
        0.022263, 0.021632, 0.02184, 0.022118, 0.021248, 0.020394, 0.019708, 0.018855,
        0.018685, 0.016813, 0.016254, 0.015523, 0.014754, 0.012658, 0.011649,
        0.012456, 0.010649, 0.009772, 0.009249, 0.007778, 0.006485, 0.007278,
        0.006568, 0.003419, 0.003527, 0.003788, 0.002252, 0.00237, 0.002551, 0.002597,
        0.002667, 0.002551, 0.003344, 0, 0.020517, 0.014572, 0.014507, 0.015385,
        0.016623, 0.016268, 0.017078, 0.016114, 0.016143, 0.018009, 0.0222, 0.027749,
        0.032195, 0.03617, 0.040659, 0.041973, 0.041237, 0.037736, 0.034272, 0.029909,
        0.027778, 0.021505, 0.016949, 0.012371, 0.010368, 0.009132, 0.007576,
        0.007988, 0.00823, 0.009747, 0.009798, 0.011287, 0.012842, 0.014524, 0.015667,
        0.016461, 0.01706, 0.017241, 0.018304, 0.018005, 0.017544, 0.017638, 0.018056,
        0.016173, 0.016575, 0.015652, 0.014537, 0.014233, 0.013111, 0.013224,
        0.011742, 0.011429, 0.011273, 0.010794, 0.01043, 0.009554, 0.008469, 0.008708,
        0.008183, 0.007725, 0.007916, 0.007246, 0.006645, 0.006266, 0.006631,
        0.005822, 0.006791, 0.004, 0.004132, 0.004444, 0.004167, 0.004926, 0.002451,
        0.002653, 0.002755, 0.003472, 0.003145, 0.003115, 0.003846, 0.003205,
        0.003891, 0.004405, 0, 0.014981, 0.01633, 0.015773, 0.017598, 0.016537,
        0.016129, 0.016032, 0.017508, 0.018962, 0.018418, 0.019763, 0.021119,
        0.024017, 0.031285, 0.039909, 0.050111, 0.056404, 0.059133, 0.052925, 0.04812,
        0.03966, 0.030568, 0.025608, 0.023669, 0.022654, 0.020731, 0.019175, 0.017692,
        0.015849, 0.016609, 0.016183, 0.016393, 0.017067, 0.018105, 0.018924,
        0.019307, 0.020157, 0.019619, 0.020548, 0.021228, 0.021143, 0.021525,
        0.020923, 0.021025, 0.020667, 0.020503, 0.019567, 0.018827, 0.017422,
        0.016381, 0.015911, 0.01466, 0.013821, 0.012265, 0.011785, 0.011628, 0.009813,
        0.009737, 0.008753, 0.008178, 0.006772, 0.006562, 0.0059, 0.006633, 0.003442,
        0.003643, 0.001938, 0.002278, 0.002398, 0.002571, 0.002618, 0.002695,
        0.002577, 0
      ),
      rep(
        c(202L, 1L, 2L, 1L, 19L, 1L, 230L, 1L, 2L, 1L, 18L, 1L, 28L),
        c(1L, 5L, 1L, 75L, 1L, 73L, 1L, 76L, 1L, 5L, 1L, 73L, 1L)
      )
    ),
    imm_int = c(
      2, 15, 15, 14, 13, 11, 10, 9, 8, 7, 6, 5, 4, 4, 3, 4, 4, 5, 6, 8, 9, 10, 12,
      13, 14, 15, 15, 15, 15, 15, 16, 15, 14, 14, 13, 13, 12, 12, 11, 11, 10, 10,
      10, 11, 12, 13, 13, 12, 12, 11, 10, 10, 10, 9, 9, 9, 8, 8, 8, 7, 7, 7, 7, 6,
      6, 5, 5, 5, 5, 5, 4, 4, 4, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1,
      1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 13, 13, 12, 11, 10, 9, 9, 8, 7, 6, 5, 5,
      4, 4, 4, 5, 6, 6, 8, 11, 13, 14, 16, 16, 17, 17, 16, 15, 13, 13, 11, 10, 8, 8,
      7, 7, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 8, 8, 8, 8, 7, 7, 7, 7, 7, 7, 6,
      6, 6, 6, 5, 5, 5, 5, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 2, 2, 2, 2, 2, 1, 1, 1, 1,
      1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 23, 54, 51, 48, 47, 45, 44, 43, 42,
      42, 41, 40, 40, 38, 37, 34, 33, 32, 35, 45, 61, 84, 106, 128, 145, 158, 166,
      169, 169, 166, 161, 155, 148, 140, 132, 124, 117, 110, 103, 97, 91, 86, 81,
      76, 72, 68, 64, 60, 57, 54, 51, 49, 45, 42, 37, 33, 29, 25, 21, 18, 15, 13,
      11, 9, 8, 7, 6, 5, 4, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 46, 42, 40, 39, 39, 38, 38, 38, 39,
      39, 39, 40, 39, 37, 36, 35, 36, 36, 46, 64, 87, 109, 128, 140, 145, 148, 145,
      141, 135, 128, 121, 113, 106, 99, 92, 85, 80, 74, 69, 64, 59, 56, 52, 49, 46,
      44, 42, 40, 38, 36, 35, 33, 30, 27, 25, 21, 19, 16, 14, 12, 10, 9, 8, 7, 6, 5,
      4, 4, 4, 3, 3, 2, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
      0, 0, 0, 0, 0, 0, 0, 0, 2, 15, 15, 14, 13, 11, 10, 9, 8, 7, 6, 5, 4, 4, 3, 4,
      4, 5, 6, 8, 9, 10, 12, 13, 14, 15, 15, 15, 15, 15, 16, 15, 14, 14, 13, 13, 12,
      12, 11, 11, 10, 10, 10, 11, 12, 13, 13, 12, 12, 11, 10, 10, 10, 9, 9, 9, 8, 8,
      8, 7, 7, 7, 7, 6, 6, 5, 5, 5, 5, 5, 4, 4, 4, 4, 4, 3, 3, 3, 3, 2, 2, 2, 2, 2,
      1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 13, 13, 12, 11, 10, 9,
      9, 8, 7, 6, 5, 5, 4, 4, 4, 5, 6, 6, 8, 11, 13, 14, 16, 16, 17, 17, 16, 15, 13,
      13, 11, 10, 8, 8, 7, 7, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 8, 8, 8, 8, 7,
      7, 7, 7, 7, 7, 6, 6, 6, 6, 5, 5, 5, 5, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 2, 2, 2,
      2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 23, 54, 51, 49,
      47, 45, 44, 43, 42, 42, 41, 40, 40, 39, 37, 35, 33, 32, 35, 45, 61, 84, 107,
      129, 146, 159, 167, 170, 170, 167, 162, 156, 148, 141, 133, 125, 118, 110,
      104, 97, 92, 86, 81, 77, 73, 69, 64, 61, 58, 55, 52, 49, 46, 42, 38, 33, 29,
      25, 21, 18, 15, 13, 11, 9, 8, 7, 6, 5, 4, 3, 3, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1,
      0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 18, 46, 43, 41,
      39, 39, 39, 38, 39, 39, 39, 40, 40, 39, 38, 36, 36, 36, 36, 46, 65, 88, 110,
      128, 140, 147, 149, 145, 141, 135, 128, 121, 114, 106, 99, 93, 86, 80, 74, 69,
      64, 60, 56, 53, 49, 47, 44, 42, 40, 38, 37, 35, 33, 30, 28, 25, 22, 19, 16,
      14, 12, 10, 9, 8, 7, 6, 5, 5, 4, 4, 3, 3, 3, 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1,
      1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0
    ),
    imm_ch = c(
      17, 34, 26, 23, 16, 10, 7, 6, 2, 1, 2, 0, 1, 0, 1, 1, 2, 4, 6, 5, 6, 7, 5, 1,
      0, -7, -18, -19, -13, -10, -5, 8, 11, 12, 17, 16, 19, 19, 18, 17, 17, 16, 14,
      15, 12, 9, 10, 8, 7, 6, 5, 3, 3, 3, 3, 3, 3, 2, 2, 4, 3, 5, 5, 6, 10, 3, 2, 4,
      4, 3, 2, 1, 2, 1, 1, 1, 0, 1, 0, 0, 0, -1, 0, 0, 0, -1, 0, -1, -1, -1, 0, 0,
      -1, -1, 0, 0, 0, 0, 0, 0, 0, 27, 22, 23, 19, 16, 13, 11, 7, 7, 5, 7, 7, 9, 9,
      10, 11, 10, 8, 4, 0, -3, 0, -4, -5, -13, -19, -10, -21, -8, -6, 2, 6, 6, 14,
      16, 15, 12, 13, 13, 18, 16, 16, 14, 12, 12, 12, 12, 9, 8, 6, 7, 6, 6, 6, 5, 5,
      6, 5, 5, 4, 4, 3, 2, 4, 1, -3, 3, 4, 4, 4, 4, 4, 4, 2, 2, 2, 3, 3, 2, 3, 2, 3,
      2, 1, 2, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 2, 7, 10, 7, 8, 7, 5,
      4, 4, 5, 4, 4, 3, 2, 1, 1, 0, 1, 1, 3, 3, 3, 6, 5, 10, 11, 9, 13, 15, 12, 13,
      18, 16, 20, 20, 15, 15, 11, 10, 13, 12, 10, 9, 9, 10, 12, 9, 8, 10, 10, 9, 10,
      8, 12, 9, 10, 9, 7, 5, 5, 5, 4, 4, 3, 3, 5, 3, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1,
      1, 1, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1,
      11, 11, 8, 6, 5, 4, 3, 4, 2, 3, 3, 3, 2, 3, 2, 3, 3, 3, -1, 0, 0, 1, 3, 4, 8,
      7, 9, 10, 13, 16, 17, 12, 12, 11, 10, 10, 10, 9, 8, 8, 8, 10, 9, 8, 10, 10, 5,
      5, 5, 3, 4, 3, 3, 4, 5, 4, 3, 3, 1, 2, 1, 2, 1, 2, 0, 1, 0, 1, 1, 1, 1, 1, 1,
      0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 16, 34, 28, 20, 16, 11, 8, 6, 3, 1, 1, 1, 1, 1, 1, 2, 1, 2, 5, 6, 6, 7, 6,
      2, -5, -8, -13, -21, -18, -7, -2, 2, 13, 15, 14, 19, 17, 20, 19, 17, 16, 16,
      14, 12, 12, 10, 8, 8, 7, 6, 5, 6, 2, 2, 4, 3, 2, 3, 2, 3, 5, 6, 7, 6, 11, 4,
      3, 4, 4, 3, 3, 2, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, -1, 0, -1, -1, -1, -1, -1,
      0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 33, 22, 24, 19, 15, 12, 11, 8, 6, 6, 6, 7,
      8, 9, 10, 11, 10, 8, 4, -2, -2, -2, 0, -9, -10, -16, -20, -10, -16, -4, 0, 9,
      11, 10, 16, 16, 16, 14, 15, 12, 16, 15, 14, 12, 10, 10, 11, 10, 9, 7, 6, 7, 6,
      5, 5, 5, 5, 6, 5, 5, 4, 3, 2, 3, 1, -3, 3, 5, 4, 4, 3, 2, 2, 3, 2, 3, 3, 2, 3,
      3, 3, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 3, 9, 7, 9,
      7, 7, 6, 5, 4, 4, 4, 4, 2, 2, 1, 0, 1, 1, 2, 3, 3, 6, 5, 9, 6, 11, 12, 9, 13,
      16, 11, 14, 19, 17, 19, 19, 15, 14, 11, 9, 12, 12, 10, 9, 9, 10, 11, 9, 8, 9,
      10, 9, 10, 9, 12, 9, 9, 7, 6, 6, 5, 5, 3, 3, 3, 4, 2, 2, 2, 1, 1, 2, 1, 1, 1,
      1, 1, 1, 1, 0, 0, -1, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, -1, 13, 11, 9, 7, 5, 4, 3, 2, 3, 3, 3, 3, 3, 3, 2, 3, 3, 3, 0, -1, 2, 1, 2,
      2, 3, 7, 7, 10, 11, 15, 16, 16, 13, 12, 10, 10, 9, 9, 9, 8, 9, 8, 10, 10, 9,
      9, 7, 3, 4, 4, 3, 4, 3, 4, 5, 5, 3, 4, 3, 2, 2, 2, 1, 1, 0, 0, 0, 0, 1, 1, 1,
      0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0
    ),
    spatial_unit = rep("Aargau", 808L),
  )


  ### Projection ----
  # nolint start
  # propop(
  #   parameters = ag_parameters,
  #   year_first = 2019,
  #   year_last = 2020,
  #   age_groups = 101,
  #   fert_first = 16,
  #   fert_last = 50,
  #   share_born_female = 100 / 205,
  #   population = data_benchmark |> filter(year == 2018), # only use start year
  #   subregional = FALSE
  # ) |>
  #   constructive::construct()
  # nolint end

  data_projected <- tibble::tibble(
    age = rep(0:100, 12),
    sex = factor(rep(rep(c("m", "f"), 6), each = 101L), levels = c("m", "f")),
    nat = factor(rep(rep(c("ch", "int"), 3), each = 202L)),
    year = rep(2018:2020, each = 404L),
    spatial_unit = factor(rep("Aargau", 1212L)),
    n = c(
      2506, 2589, 2568, 2635, 2710, 2608, 2569, 2611, 2634, 2512, 2564, 2411, 2514,
      2531, 2559, 2571, 2535, 2515, 2799, 2739, 2837, 2916, 3020, 2865, 2920, 3052,
      3125, 3058, 3060, 3057, 2963, 2923, 3031, 2906, 3099, 3001, 3037, 3029, 3026,
      2936, 2847, 2897, 2747, 2824, 3066, 3046, 3219, 3435, 3595, 3689, 4001, 4084,
      4124, 4203, 4275, 4109, 4096, 3998, 3761, 3721, 3611, 3627, 3472, 3441, 3256,
      3146, 3053, 2845, 2876, 2797, 2824, 2738, 2709, 2557, 2439, 2351, 2111, 1895,
      1533, 1454, 1476, 1297, 1181, 1114, 1080, 875, 828, 704, 594, 485, 407, 293,
      229, 170, 115, 95, 65, 32, 17, 18, 9, 2377, 2472, 2524, 2497, 2403, 2395,
      2472, 2386, 2540, 2392, 2467, 2313, 2357, 2295, 2384, 2384, 2415, 2454, 2513,
      2620, 2620, 2777, 2838, 2872, 2925, 2859, 3127, 2998, 3056, 2961, 3006, 3000,
      2969, 2923, 2965, 3026, 3169, 3173, 2992, 2969, 2864, 2960, 3126, 3008, 3064,
      3091, 3285, 3601, 3801, 3859, 4113, 4133, 4266, 4285, 4371, 4302, 4124, 4088,
      4001, 3832, 3831, 3832, 3628, 3538, 3388, 3292, 3300, 3050, 3083, 2996, 2956,
      2888, 2895, 2795, 2731, 2650, 2379, 2166, 1927, 1881, 1805, 1695, 1694, 1524,
      1493, 1348, 1312, 1154, 1070, 913, 810, 618, 543, 435, 319, 238, 171, 115, 74,
      36, 54, 1025, 1028, 1138, 1033, 1043, 1043, 1104, 1042, 974, 958, 1018, 934,
      910, 959, 881, 858, 829, 777, 830, 822, 909, 912, 981, 992, 1072, 1265, 1341,
      1424, 1635, 1678, 1700, 1780, 1778, 1884, 1950, 1936, 2056, 2041, 1981, 1858,
      1877, 1850, 1808, 1721, 1641, 1610, 1678, 1585, 1529, 1572, 1503, 1576, 1531,
      1574, 1538, 1383, 1230, 1182, 1161, 986, 923, 819, 777, 712, 623, 515, 494,
      458, 490, 415, 417, 385, 371, 295, 328, 329, 333, 270, 326, 270, 242, 181,
      190, 144, 116, 76, 61, 43, 44, 39, 23, 23, 10, 9, 3, 3, 2, 1, 1, 3, 1, 951,
      962, 1026, 987, 989, 961, 994, 911, 1004, 936, 905, 884, 874, 905, 867, 777,
      730, 670, 705, 661, 730, 771, 835, 915, 938, 1086, 1231, 1357, 1400, 1448,
      1514, 1607, 1648, 1730, 1763, 1711, 1733, 1730, 1742, 1617, 1618, 1511, 1492,
      1506, 1422, 1370, 1432, 1338, 1249, 1292, 1224, 1220, 1185, 1116, 1124, 1033,
      921, 865, 900, 771, 687, 609, 585, 567, 528, 444, 422, 392, 385, 375, 392,
      299, 308, 245, 276, 229, 265, 244, 253, 247, 205, 184, 138, 139, 102, 97, 67,
      65, 47, 35, 30, 26, 19, 10, 11, 12, 3, 5, 2, 0, 2, 2510.0944359407813,
      2551.0083208326155, 2631.0011857952863, 2609.00831689771, 2669.998956,
      2738.000204, 2633.001022, 2593.9997500000004, 2631.9994169999995, 2653.999268,
      2535.999886, 2591.9997319515, 2442.000914336024, 2548.00119127722,
      2570.999982968052, 2599.99793519982, 2609.9995850528817, 2573.999087521896,
      2548.99898816669, 2832.00106668547, 2767.9999111822262, 2862.999613200246,
      2938.0010787554857, 3032.999745919074, 2875.9998521882676, 2920.0015409493835,
      3042.001650296476, 3112.9984895261614, 3054.0011503976493, 3060.9981981397927,
      3066.998354025997, 2989.0001499495997, 2954.9992642475195, 3065.99880415662,
      2950.996419049786, 3143.998877278855, 3050.99897709915, 3089.9972300292566,
      3079.9974278995505, 3076.0002571319824, 2983.9946805568757,
      2894.0002943134346, 2938.9980999969157, 2789.9969544238443,
      2862.0021233771417, 3098.9950619260644, 3077.9999882943675, 3247.997441771727,
      3459.9981855522074, 3615.994650943879, 3704.9977081243146, 4011.999206677162,
      4094.99759021062, 4131.999153133318, 4208.000772846153, 4275.998140257697,
      4107.00127323408, 4088.995587489213, 3988.9936490511122, 3751.99718570463,
      3706.9942437713, 3596.9973928046556, 3609.999063996807, 3452.9956542622162,
      3423.9933385747695, 3225.9971818054946, 3114.9990524887485,
      3024.9972981866367, 2817.994936284553, 2844.9952560236316, 2762.99736194144,
      2784.994528062508, 2696.995752982678, 2662.994549904137, 2508.994219684303,
      2386.9945057833443, 2294.99509655792, 2055.992745891904, 1837.994987697055,
      1480.9957912620741, 1397.992876421368, 1408.9958500535602, 1229.993793659348,
      1111.9913235944143, 1039.994944, 996.99984, 799.994691, 748.000296, 627.99968,
      522.999774, 422.99500650000004, 350.9948475, 248.00804, 190.0109595,
      138.00005, 90.000035, 70.99996, 45.99998, 22, 11.000003000000001,
      14.000012999999997, 2393.904757291623, 2417.001323332992, 2513.9996826138845,
      2563.00585958646, 2533.0007309999996, 2434.000455, 2423.0003890000003,
      2498.0009539999996, 2409.999913, 2564.99944, 2417.000872, 2492.9998509999996,
      2343.9994020000004, 2394.000997, 2340.999215, 2439.999549, 2440.999602,
      2467.997852, 2494.001318803656, 2546.00186577169, 2646.0002768086697,
      2647.0004662624997, 2796.9988105928014, 2856.001399849772, 2880.99797814529,
      2924.999422010944, 2868.000283549209, 3121.99953258, 3004.9990492174493,
      3063.9989495379323, 2978.9982816187926, 3030.000862000993, 3026.995578178948,
      3005.0022745460838, 2966.001234123494, 3010.0011463963046, 3066.999476540872,
      3214.0012135913958, 3220.0016108634372, 3046.00006220522, 3019.997087544754,
      2914.00134366784, 3006.0009450536004, 3170.001076700915, 3051.99613604224,
      3104.0000064723918, 3128.99994755671, 3319.0000243712097, 3630.995857993276,
      3822.9980103724706, 3881.00035186741, 4130.99739433943, 4148.996873015033,
      4277.9981314313145, 4293.002771338203, 4378.999191826987, 4307.000362765721,
      4125.998323229661, 4087.9987707523305, 3998.9965680148744, 3826.997358913091,
      3823.998639132701, 3820.995441903648, 3615.998042512426, 3518.999658195472,
      3367.00044928818, 3274.001559671996, 3283.99622446512, 3032.9997853037535,
      3063.9999303565337, 2975.9958220614153, 2934.9937625877496,
      2862.9951725270516, 2863.9971530559496, 2760.9961652873294,
      2693.9971972787253, 2609.9952848782996, 2338.9929997684485, 2122.995715880494,
      1884.9907626367421, 1832.9919373738323, 1753.988045543445, 1637.989129384175,
      1625.9946520055998, 1454.989308040704, 1412.990927906425, 1263.989680307564,
      1216.9883171376957, 1056.9865714852149, 965.9848495691251, 809.9918275520125,
      706.982289, 528.9796150000001, 452.00025899999997, 351.00019499999996,
      247.999851, 176.000048, 118.999926, 75.00001, 44.999992, 39.999959999999994,
      1097.8794968075522, 1034.02958545145, 1040.00038, 1142.999694, 1045.000342,
      1053.9996700000002, 1054.9995749999998, 1115.000768, 1055.0009020000002,
      991.0007999999999, 972.999272, 1024.9997720000001, 939.99959, 910.00004,
      953.0001209999999, 872.9796420000001, 847.9990469753881, 816.998963502428,
      769.0014734722006, 827.9997669276398, 837.003192415725, 944.0010612005776,
      970.059630983008, 1060.999513, 1094.99936, 1187.999248, 1377.00047,
      1458.000389, 1538.945524, 1735.0013305963623, 1771.9995790696,
      1791.00171797135, 1859.00067599451, 1851.002173022591, 1944.000803252648,
      1992.99974852535, 1972.0016238771202, 2075.9998439341757, 2055.0008691620596,
      1994.9971337102538, 1870.973161515544, 1883.0003376763166, 1854.9986536348752,
      1809.99740461492, 1724.99686562698, 1650.9981438491927, 1616.001476328335,
      1677.975805460917, 1587.9976467927947, 1533.001469599589, 1574.99570228016,
      1508.0023922969178, 1574.9825028913601, 1534.0011717202915, 1569.998959190575,
      1534.9938961152, 1377.9929123678999, 1221.99842741374, 1164.9874766531348,
      1137.003908208925, 965.9973136850699, 902.994815541534, 797.98840192104,
      753.9966719023499, 686.993868173732, 589.0018995394505, 499.98995457650494,
      483.996993761452, 449.99577236528705, 479.99538141392503, 406.00044858527497,
      407.99473502712, 376.9993783609125, 362.9981686478215, 287.993814532235,
      317.9970105107, 317.9970202667645, 320.9968889397599, 259.996548999075,
      311.998185767698, 256.99761088661995, 227.005028650028, 169.999914692525,
      178.00012262929502, 133.000120770048, 105.999974402596, 68.00000987086,
      54.999978999999996, 38.000003, 37.999984, 33.000006, 19.000001, 19.000001, 8,
      7.000001999999999, 2.000001, 2.000001, 1, 1, 1, 2, 1041.1171220711153,
      951.029341307943, 965.9995680000001, 1028.000316, 991.999851, 998.000279,
      971.0006219999999, 1001.9992, 922.999859, 1012.000528, 946.99968, 916.00013,
      895.000084, 877.000228, 897.99973, 850.999772, 761.000054, 718.00001,
      665.0004299999999, 706.000245, 687.000432, 781.00005, 845.0004680000001,
      926.9325665, 1013.0738628188775, 1042.999726, 1186.9391309999999,
      1325.004850234209, 1445.0009414903611, 1483.0012483464998, 1525.00276794624,
      1582.0013961776501, 1657.001016235184, 1691.001060043128, 1760.9995821461148,
      1785.9993481151334, 1733.00067967464, 1752.000091809432, 1743.00029230416,
      1749.996849703988, 1626.0002116958192, 1624.9974491141452, 1521.999882038881,
      1499.999845225784, 1512.0003992352, 1430.998667097439, 1381.0003680327152,
      1434.999254533456, 1342.998420008952, 1257.0012366125711, 1295.999535604992,
      1229.98332210432, 1222.9989261636, 1187.99933680956, 1117.999533950828,
      1120.99672692916, 1026.99645592874, 913.9987945391861, 855.9896231973698,
      886.0053571677, 761.997927644281, 677.997962627281, 602.999549456325,
      580.99074408225, 548.9983244356561, 516.003502362456, 438.99220172880007,
      416.99890398574803, 388.99971634694003, 381.99953748051996,
      371.00032750137495, 387.99520134674, 295.000815608075, 304.9963646104,
      240.997737153375, 271.99706124636396, 224.99857075108102, 259.99840057547,
      238.99661469672802, 245.99781158416502, 238.997017417841, 196.9980781577,
      176.98732752172, 130.99287986232497, 129.994596536092, 94.993114774508,
      88.99650888660099, 60.990969880600005, 57.990012346149996, 40.99236371277,
      30.0047809285725, 25.991214333334998, 22.996534499999996, 15.999995, 8,
      9.000002, 9, 2.000001, 4, 1, 1, 2525.5477797822496, 2558.102022907716,
      2594.0084119845546, 2667.0093617169628, 2645.009571561659, 2697.9986258649355,
      2764.001233619252, 2657.0022280467138, 2615.9980020725743, 2652.9979695733578,
      2677.997979139088, 2564.000601928139, 2626.0011598468946, 2478.001779929619,
      2586.0019501001916, 2613.9991330596445, 2637.99695513791, 2646.000215406927,
      2607.996926189895, 2578.9977644288856, 2861.0014645112446, 2792.0015533332867,
      2883.9993438619754, 2951.0030441973317, 3037.000537671872, 2876.9969929587187,
      2914.002445507477, 3029.0035591586206, 3102.997546449828, 3059.0030463903645,
      3073.9967969741897, 3085.9984489030826, 3021.9990376714522, 2995.000219955231,
      3105.9948653117312, 2998.9978754413632, 3190.9996275865938, 3101.997704453541,
      3142.9952497702384, 3130.9929280262936, 3121.999348229507, 3028.996526482354,
      2938.0006433187637, 2978.993894874583, 2830.000059686026, 2898.9973816266083,
      3128.9961807164677, 3106.9967149746385, 3272.993555230041, 3480.9990875449907,
      3630.9935256705603, 3719.9958957196677, 4021.9956968639526, 4102.995320144792,
      4139.996749895065, 4211.001776412976, 4272.997166554213, 4103.000441148639,
      4079.9928795400383, 3977.9884823367465, 3741.9947122326053, 3693.990996708518,
      3583.993438873604, 3590.9932687798487, 3437.9918160745256, 3394.987152051769,
      3198.9943839759108, 3086.995103884951, 2995.9934190447175, 2789.9887062086973,
      2811.9918294907393, 2727.991525522407, 2743.9908269754114, 2651.991017564761,
      2614.9883985652855, 2456.9896114015373, 2332.987053253968, 2234.989794197475,
      1995.9861850803438, 1776.9898955359604, 1424.9914994828348,
      1337.9880747673512, 1339.9877209456445, 1158.9896995256602,
      1039.9871769227962, 961.9953232, 912.99961248048, 723.995195355,
      669.0002447379601, 554.99974119744, 456.99517092461, 365.990074379799,
      298.99566283257, 206.01587761772, 155.0088506395455, 109.00002949274999,
      68.00006644446, 50.9999812676, 30.99998452174, 14.000007999999998,
      13.00000832, 2420.461055481396, 2435.9076037726595, 2459.001488229845,
      2552.0046143637055, 2597.004624233284, 2562.0009449995355, 2461.9998359773426,
      2448.999920605498, 2522.9997657747376, 2432.998674655797, 2589.999722963104,
      2443.0015620776157, 2521.9987754808526, 2379.999728903474, 2438.000131016519,
      2396.9981118115948, 2499.0001808790776, 2495.996205845504, 2508.9977425245365,
      2524.0017204358514, 2575.0041484346684, 2669.0022388155435,
      2671.0006747733255, 2810.9988234844427, 2867.001578543283, 2884.9986718084274,
      2921.9981469275644, 2873.99897894531, 3119.0000900114587, 3016.996543206735,
      3079.0015010561774, 3004.9958199062535, 3058.998651359172, 3056.9955990851504,
      3045.0021894401625, 3010.0004280810376, 3057.002712808573, 3112.0014168734037,
      3263.0029015700056, 3267.0045734815235, 3097.999942260374, 3068.995221495581,
      2961.0008455201955, 3048.9984060551674, 3210.001857579562, 3091.9958212215565,
      3142.0013869718446, 3163.9980874046782, 3350.998198831888, 3655.9983145220162,
      3843.9966517093744, 3900.9991908208167, 4145.995625473568, 4160.99784012582,
      4286.997828347214, 4300.001613253714, 4382.998989504576, 4310.997848408248,
      4125.997288914005, 4085.9959620901313, 3993.9973316814185, 3819.9951751060603,
      3812.9974380413882, 3809.9911928481806, 3596.994760889827, 3496.998297698403,
      3348.9994034119013, 3259.000205532709, 3265.995063660832, 3014.9957885318167,
      3042.9974400286, 2952.993903841773, 2907.992453285215, 2833.9912983539375,
      2829.9959675445853, 2724.988545084924, 2653.9886824896384, 2564.9895966335635,
      2293.987938663653, 2076.98790063324, 1838.9815406265595, 1780.9816991978591,
      1695.9787498102746, 1574.9796447214226, 1552.9838815148223,
      1378.9778868522992, 1325.981130006771, 1173.979866000466, 1116.9752925308446,
      955.9735930482033, 859.9700996535208, 707.9756008140532, 606.964303588348,
      441.9830985374851, 366.000429721365, 274.000229222265, 184.99995285076798,
      123.99995381816, 77.999929495812, 45.000006, 39.999957411775995,
      1118.1886773640804, 1104.914777954791, 1043.0279574264912, 1052.9995635574,
      1149.99954658272, 1056.999818908924, 1066.9990115846504, 1069.9991882939999,
      1127.001049581376, 1069.0016696414382, 1004.0003931672, 981.9995151868881,
      1025.99978112, 940.99978744673, 905.99989815384, 942.9793127863799,
      862.9808138667075, 836.998205130702, 808.9976562798983, 774.004346949344,
      844.0005632820959, 880.0094562634529, 1003.0027038077482, 1056.1245268032794,
      1157.999420245106, 1209.99973214592, 1308.998748714144, 1490.0008374729,
      1572.0005205905752, 1648.895850514584, 1827.0035967663969, 1858.9983360704775,
      1873.002903396403, 1928.0008915099925, 1913.004425855305, 1994.0000906705898,
      2028.9988294636298, 2001.0041865044127, 2090.0005822473777,
      2061.9720165177346, 2004.9934114019059, 1879.9728342492172,
      1884.9993598567544, 1857.9965955751863, 1811.9947583412911,
      1728.9954164793348, 1657.9969879751936, 1619.9826021121864,
      1677.9733597005768, 1589.9970106002575, 1540.0014368018628,
      1577.9934673988737, 1512.9873791222076, 1573.9805429818027,
      1535.0030846994594, 1563.985386019232, 1525.9856048609372, 1364.9995500734763,
      1205.9850104063157, 1144.9865680864127, 1109.9957885393392, 946.9940897060076,
      880.989603979705, 776.9864016997202, 728.9931684909795, 649.9876017985531,
      566.9961038521634, 489.9893249116969, 475.99459792282687, 441.99344749576574,
      469.9909748854378, 397.9957233816067, 398.9927673907522, 368.99394917903237,
      353.9948998843763, 279.9933194420839, 308.9939053355724, 307.9944106127477,
      309.99348115995275, 248.99330895880306, 296.997617175621, 242.0029423912479,
      211.00757162394459, 158.99998694247697, 165.00004480838746,
      122.00004480035989, 95.99997898806092, 59.999981124394345, 48.99997629091099,
      33.000000605263, 32.999984105264, 28.000010090909996, 15.999995842105001,
      15.999995842105001, 6, 5.000003428572, 2.000001, 1.0000005, 1, 1, 2.000001,
      1051.8091473455493, 1040.1386070594044, 959.0280520688777, 973.0000292296161,
      1035.000040011592, 1001.000112257018, 1009.000398054144, 981.0004561420279,
      1010.9993535488001, 936.000126430079, 1022.000059304112, 958.9996454752,
      927.00058145858, 899.999885527356, 874.000249561012, 882.00031223591,
      832.99980727144, 745.9994901681599, 709.9997293454, 669.00033284206,
      730.0003891190349, 744.00036624888, 857.0003137593, 934.999835845816,
      1023.868740991824, 1112.139774548258, 1149.000405135012, 1282.8862366776818,
      1415.0084906314235, 1525.0018901663059, 1558.0040638100236,
      1593.0046232086959, 1640.002121219307, 1701.0022997489712, 1727.0023255044416,
      1788.0014064552995, 1806.9982557927422, 1752.0010420573926,
      1766.0001503016806, 1752.9992971671236, 1756.994638964447, 1635.0009562061862,
      1631.9968952908544, 1531.9984383586152, 1509.0001485488845,
      1518.9988382859265, 1438.9971151314953, 1388.0005150281659, 1436.997836542449,
      1347.998220190034, 1264.984815442666, 1299.998012420428, 1235.98349580019,
      1224.997960176297, 1188.9978248251718, 1116.999881685154, 1115.9938039742813,
      1016.9942309858858, 903.9967745061057, 845.9809776552726, 873.0015710041636,
      751.994734841877, 669.9949499193515, 594.998532769182, 561.9899017525746,
      536.9974247100513, 509.00060121937827, 433.9917540602272, 411.99793886716725,
      385.9991689608255, 377.9989671400226, 366.99593682012875, 381.99576176252435,
      291.9966693251559, 300.9973931805957, 237.99547235098717, 266.9941933907277,
      220.9932349741558, 253.9964287231278, 231.99515272892572, 237.99545473550737,
      229.9936506972226, 188.99366817913315, 168.9798325027345, 123.98922417252442,
      121.98899510827272, 87.98563880400387, 80.99258783874826, 54.98083901482196,
      50.99074973440677, 35.987797248295855, 25.993757567818946, 22.004576317013445,
      19.996981522492497, 12.9999959375, 6, 7.000003555556, 7.000001999999999,
      2.000001, 3, 1
    ),
    ) |>
    structure(
      out.attrs = list(
        dim = c(age = 101L, sex = 2L, nat = 2L, year = 3L, spatial_levels = 1L),
        dimnames = list(
          age = c(
            "age=  0", "age=  1", "age=  2", "age=  3", "age=  4", "age=  5", "age=  6",
            "age=  7", "age=  8", "age=  9", "age= 10", "age= 11", "age= 12", "age= 13",
            "age= 14", "age= 15", "age= 16", "age= 17", "age= 18", "age= 19", "age= 20",
            "age= 21", "age= 22", "age= 23", "age= 24", "age= 25", "age= 26", "age= 27",
            "age= 28", "age= 29", "age= 30", "age= 31", "age= 32", "age= 33", "age= 34",
            "age= 35", "age= 36", "age= 37", "age= 38", "age= 39", "age= 40", "age= 41",
            "age= 42", "age= 43", "age= 44", "age= 45", "age= 46", "age= 47", "age= 48",
            "age= 49", "age= 50", "age= 51", "age= 52", "age= 53", "age= 54", "age= 55",
            "age= 56", "age= 57", "age= 58", "age= 59", "age= 60", "age= 61", "age= 62",
            "age= 63", "age= 64", "age= 65", "age= 66", "age= 67", "age= 68", "age= 69",
            "age= 70", "age= 71", "age= 72", "age= 73", "age= 74", "age= 75", "age= 76",
            "age= 77", "age= 78", "age= 79", "age= 80", "age= 81", "age= 82", "age= 83",
            "age= 84", "age= 85", "age= 86", "age= 87", "age= 88", "age= 89", "age= 90",
            "age= 91", "age= 92", "age= 93", "age= 94", "age= 95", "age= 96", "age= 97",
            "age= 98", "age= 99", "age=100"
          ),
          sex = c("sex=m", "sex=f"),
          nat = c("nat=ch", "nat=int"),
          year = c("year=2018", "year=2019", "year=2020"),
          spatial_levels = "spatial_levels=Aargau"
        )
      )
    )

  # Test combined data frames ----
  combined_snapshot <- prepare_evaluation(
    data_benchmark = data_benchmark,
    data_projected = data_projected,
    drop_start_year = TRUE
  )

  expect_snapshot(constructive::construct(combined_snapshot))

  # Should fail when start population is included in projeciton output
  expect_error(
    prepare_evaluation(
      data_benchmark = data_benchmark,
      data_projected = data_projected,
      drop_start_year = FALSE
    ),
    "The ranges of years in `data_benchmark` and `data_projected` are not
    identical"
  )

  combined_grouped_snapshot <- prepare_evaluation(
    data_benchmark = data_benchmark,
    data_projected = data_projected,
    drop_start_year = TRUE,
    age_groups = "age_groups_3"
  )

  expect_snapshot(constructive::construct(combined_grouped_snapshot))


  # Check if cli warning occurs with NA ----

  ## NAs in projected data ----
  # add NA
  data_projected_NA <- data_projected |>
    dplyr::mutate(n = ifelse(year == 2020, NA, n))

  # run function
  snapshot_NA <- prepare_evaluation(
    data_benchmark = data_benchmark,
    data_projected = data_projected_NA,
    drop_start_year = TRUE
  )

  expect_snapshot(constructive::construct(
    prepare_evaluation(
      data_benchmark = data_benchmark,
      data_projected = data_projected_NA,
      drop_start_year = TRUE
    )
  ))

  ## NAs in benchmark ----
  # add NA
  data_benchmark_NA <- data_benchmark |>
    dplyr::mutate(n = ifelse(year == 2020, NA, n))

  # run function
  snapshot_NA2 <- prepare_evaluation(
    data_benchmark = data_benchmark_NA,
    data_projected = data_projected,
    drop_start_year = TRUE
  )

  expect_snapshot(constructive::construct(
    prepare_evaluation(
      data_benchmark = data_benchmark_NA,
      data_projected = data_projected,
      drop_start_year = TRUE
    )
  ))
})
